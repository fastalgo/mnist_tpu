warmup 10, weight decay 0.01
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.02
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.04
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.08
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.1
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.001
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.002
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.004
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.008
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.0001
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.0002
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.0004
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.0008
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.00001
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.00002
CommandException: 1 files/objects could not be removed.
Traceback (most recent call last):
  File "mnist_tpu.py", line 401, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 349, in main
    file.write("weight_decay: " + str(FLAGS.weight_decay) + "; ")
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/flags.py", line 85, in __getattr__
    return wrapped.__getattr__(name)
  File "/usr/local/lib/python2.7/dist-packages/absl/flags/_flagvalues.py", line 473, in __getattr__
    raise AttributeError(name)
AttributeError: weight_decay
warmup 10, weight decay 0.00004
Traceback (most recent call last):
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gsutil", line 22, in <module>
    gsutil.RunMain()
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gsutil.py", line 117, in RunMain
    sys.exit(gslib.__main__.main())
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gslib/__main__.py", line 407, in main
    perf_trace_token=perf_trace_token, user_project=user_project)
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gslib/__main__.py", line 590, in _RunNamedCommandAndHandleExceptions
    user_project=user_project)
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gslib/command_runner.py", line 372, in RunNamedCommand
    return_code = command_inst.RunCommand()
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gslib/commands/rm.py", line 308, in RunCommand
    seek_ahead_iterator=seek_ahead_iterator)
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gslib/command.py", line 1414, in Apply
    caller_id = self._SetUpPerCallerState()
  File "/usr/lib/google-cloud-sdk/platform/gsutil/gslib/command.py", line 1275, in _SetUpPerCallerState
    with caller_id_lock:
  File "/usr/lib/python2.7/multiprocessing/managers.py", line 991, in __enter__
    return self._callmethod('acquire')
  File "/usr/lib/python2.7/multiprocessing/managers.py", line 755, in _callmethod
    self._connect()
  File "/usr/lib/python2.7/multiprocessing/managers.py", line 742, in _connect
    conn = self._Client(self._token.address, authkey=self._authkey)
  File "/usr/lib/python2.7/multiprocessing/connection.py", line 169, in Client
    c = SocketClient(address)
  File "/usr/lib/python2.7/multiprocessing/connection.py", line 308, in SocketClient
    s.connect(address)
  File "/usr/lib/python2.7/socket.py", line 228, in meth
    return getattr(self._sock,name)(*args)
socket.error: [Errno 2] No such file or directory
warmup 10, weight decay 0.01
CommandException: 1 files/objects could not be removed.
W0405 01:43:03.361901 139948444927424 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:43:03.500272 139948444927424 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f482ca2f650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f482f354b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:43:03.626302 139948444927424 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f482ca2f650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f482f354b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:43:03.626862 139948444927424 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:43:03.958487 139948444927424 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:43:03.961468: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:43:03.975899 139948444927424 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:43:03.976190 139948444927424 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:43:03.976563 139948444927424 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:43:03.976632 139948444927424 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:43:03.976696 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:43:03.976939 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:43:03.977009 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:43:03.977078 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:43:03.977139 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:43:03.977200 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:43:03.977260 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:43:03.977318 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:43:03.977394 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:43:03.977471 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:43:03.977583 139948444927424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:43:03.982135 139948444927424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:43:03.994805 139948444927424 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:43:06.675096 139948444927424 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:43:06.742016 139948444927424 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:43:06.927086 139948444927424 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:43:07.011924 139948444927424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:43:07.040189 139948444927424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:43:07.045469 139948444927424 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.216515 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.265568 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.318861 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.366398 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.421853 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.471508 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.525724 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:43:07.575397 139948444927424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:43:07.602252 139948444927424 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:43:07.620654 139948444927424 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:43:10.979978 139948444927424 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:43:11.099847 139948444927424 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:43:11.812490 139948444927424 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:43:11.881516 139948444927424 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:43:14.572233 139948444927424 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:43:25.937117 139948444927424 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:43:25.937933 139948444927424 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:43:25.938363: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:43:25.945151 139948444927424 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:43:25.963915 139948444927424 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:43:25.976598 139948444927424 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 7 seconds
I0405 01:43:33.176124 139948444927424 tpu_estimator.py:510] Initialized TPU in 7 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:43:33.177167 139947627910912 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:43:33.177752 139947214370560 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:43:33.270416 139948444927424 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:43:33.271111 139948444927424 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.066063814, step = 35
I0405 01:43:46.586978 139948444927424 basic_session_run_hooks.py:249] loss = 0.066063814, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:43:46.589204 139948444927424 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:43:58.642968 139948444927424 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:43:58.643407 139948444927424 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:43:58.643685 139947627910912 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:43:58.643815 139947627910912 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:43:58.644010 139948444927424 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:43:58.644139 139948444927424 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:43:58.644215 139948444927424 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:43:58.644393 139947214370560 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:43:58.644490 139947214370560 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:43:58.644650 139948444927424 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:43:58.644748 139948444927424 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.066063814.
I0405 01:43:58.838409 139948444927424 estimator.py:359] Loss for final step: 0.066063814.
INFO:tensorflow:training_loop marked as finished
I0405 01:43:58.839153 139948444927424 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:43:59.746654 139948444927424 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:44:02.141463 139948444927424 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:44:02.406786 139948444927424 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:44:02Z
I0405 01:44:02.425292 139948444927424 evaluation.py:257] Starting evaluation at 2019-04-05T01:44:02Z
INFO:tensorflow:TPU job name worker
I0405 01:44:02.425839 139948444927424 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:44:02.524319 139948444927424 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:44:02.525218 139948444927424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:44:02.716808 139948444927424 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:44:05.278676 139948444927424 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:44:05.309770 139948444927424 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:44:05.365153 139948444927424 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 10 seconds
I0405 01:44:15.517366 139948444927424 tpu_estimator.py:510] Initialized TPU in 10 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:44:15.518255 139947205977856 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:44:15.518781 139947197585152 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:44:15.570430 139948444927424 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:44:15.595783 139948444927424 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:44:15.596184 139948444927424 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:44:16.736063 139948444927424 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:44:16.736567 139948444927424 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:44:16.736674 139948444927424 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:44:16.736917 139947205977856 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:44:16.737109 139947205977856 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:44:16.737284 139948444927424 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:44:16.737430 139948444927424 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:44:16.737519 139948444927424 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:44:16.737669 139947197585152 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:44:16.737835 139947197585152 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:44:16.738019 139948444927424 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:44:16.738125 139948444927424 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:44:16
I0405 01:44:16.844677 139948444927424 evaluation.py:277] Finished evaluation at 2019-04-05-01:44:16
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9824, global_step = 35, loss = 0.048578024
I0405 01:44:16.845055 139948444927424 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9824, global_step = 35, loss = 0.048578024
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:44:20.580267 139948444927424 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:44:21.496077 139948444927424 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.048578024, 'global_step': 35, 'accuracy': 0.9824}

warmup 10, weight decay 0.02
Removing gs://bert-pretrain-data/mnist_log3/#1554428631470024...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554428635567332...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554428594134344...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554428589.yangyouucb#1554428638410960...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554428600781719...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554428601472451...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554428605449251...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554428633105153...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554428633784411...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554428637491893...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554428658236228...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554428658.yangyouucb#1554428661256138...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:44:24.876256 140543453459904 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:44:25.050632 140543453459904 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd2b5e8a650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd2b87afb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:44:25.189311 140543453459904 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd2b5e8a650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd2b87afb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:44:25.189872 140543453459904 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:44:25.510628 140543453459904 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:44:25.513394: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:44:25.527956 140543453459904 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:44:25.528242 140543453459904 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:44:25.528614 140543453459904 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:44:25.528681 140543453459904 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:44:25.528743 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:44:25.528951 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:44:25.529037 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:44:25.529103 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:44:25.529164 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:44:25.529223 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:44:25.529283 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:44:25.529340 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:44:25.529414 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:44:25.529474 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:44:25.529597 140543453459904 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:44:25.533974 140543453459904 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:44:25.546224 140543453459904 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:44:27.113528 140543453459904 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:44:27.178611 140543453459904 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:44:27.358134 140543453459904 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:44:27.442567 140543453459904 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:44:27.469189 140543453459904 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:44:27.474363 140543453459904 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.642574 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.689086 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.740751 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.787945 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.839406 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.887929 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.940448 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:44:27.986138 140543453459904 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:44:28.012200 140543453459904 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:44:28.030139 140543453459904 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:44:31.165000 140543453459904 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:44:31.278925 140543453459904 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:44:31.985999 140543453459904 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:44:32.051564 140543453459904 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:44:34.788582 140543453459904 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:44:45.735732 140543453459904 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:44:45.736522 140543453459904 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:44:45.736926: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:44:45.743225 140543453459904 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:44:45.761254 140543453459904 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:44:45.772948 140543453459904 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 13 seconds
I0405 01:44:59.397116 140543453459904 tpu_estimator.py:510] Initialized TPU in 13 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:44:59.398231 140542569330432 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:44:59.398598 140542560937728 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:44:59.466702 140543453459904 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:44:59.467772 140543453459904 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.056107964, step = 35
I0405 01:45:12.753443 140543453459904 basic_session_run_hooks.py:249] loss = 0.056107964, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:45:12.756416 140543453459904 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:45:24.576562 140543453459904 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:45:24.576965 140543453459904 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:45:24.577429 140542569330432 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:45:24.577831 140542569330432 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:45:24.578253 140543453459904 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:45:24.578572 140543453459904 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:45:24.578685 140543453459904 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:45:24.579013 140542560937728 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:45:24.579272 140542560937728 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:45:24.579493 140543453459904 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:45:24.579838 140543453459904 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.056107964.
I0405 01:45:24.763509 140543453459904 estimator.py:359] Loss for final step: 0.056107964.
INFO:tensorflow:training_loop marked as finished
I0405 01:45:24.764214 140543453459904 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:45:25.654824 140543453459904 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:45:26.968838 140543453459904 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:45:27.196595 140543453459904 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:45:27Z
I0405 01:45:27.212116 140543453459904 evaluation.py:257] Starting evaluation at 2019-04-05T01:45:27Z
INFO:tensorflow:TPU job name worker
I0405 01:45:27.212424 140543453459904 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:45:27.298434 140543453459904 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:45:27.299185 140543453459904 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:45:27.461399 140543453459904 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:45:29.840653 140543453459904 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:45:29.870817 140543453459904 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:45:29.928049 140543453459904 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 13 seconds
I0405 01:45:43.742960 140543453459904 tpu_estimator.py:510] Initialized TPU in 13 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:45:43.743927 140542552045312 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:45:43.744419 140542201558784 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:45:43.801774 140543453459904 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:45:43.828447 140543453459904 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:45:43.828846 140543453459904 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:45:44.999247 140543453459904 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:45:44.999667 140543453459904 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:45:44.999749 140543453459904 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:45:44.999944 140542552045312 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:45:45.000052 140542552045312 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:45:45.000201 140543453459904 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:45:45.000315 140543453459904 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:45:45.000387 140543453459904 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:45:45.000507 140542201558784 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:45:45.000593 140542201558784 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:45:45.000720 140543453459904 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:45:45.000814 140543453459904 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:45:45
I0405 01:45:45.091092 140543453459904 evaluation.py:277] Finished evaluation at 2019-04-05-01:45:45
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9846, global_step = 35, loss = 0.043543197
I0405 01:45:45.091490 140543453459904 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9846, global_step = 35, loss = 0.043543197
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:45:49.004478 140543453459904 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:45:49.878490 140543453459904 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.043543197, 'global_step': 35, 'accuracy': 0.9846}

warmup 10, weight decay 0.04
Removing gs://bert-pretrain-data/mnist_log3/#1554428717381821...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554428721568805...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554428669.yangyouucb#1554428724280293...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554428674366586...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554428680624872...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554428685249291...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554428681328187...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554428719011230...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554428719769440...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554428723532271...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554428746472809...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554428746.yangyouucb#1554428749647513...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:45:53.340092 140090474276288 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:45:53.463397 140090474276288 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f693e3ed650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f6940d12b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:45:53.558028 140090474276288 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f693e3ed650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f6940d12b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:45:53.558604 140090474276288 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:45:53.872256 140090474276288 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:45:53.875252: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:45:53.890010 140090474276288 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:45:53.890301 140090474276288 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:45:53.890642 140090474276288 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:45:53.890708 140090474276288 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:45:53.890769 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:45:53.890981 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:45:53.891050 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:45:53.891114 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:45:53.891175 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:45:53.891235 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:45:53.891294 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:45:53.891383 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:45:53.891446 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:45:53.891504 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:45:53.891561 140090474276288 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:45:53.896018 140090474276288 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:45:53.908595 140090474276288 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:45:55.420523 140090474276288 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:45:55.487411 140090474276288 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:45:55.662116 140090474276288 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:45:55.738501 140090474276288 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:45:55.763895 140090474276288 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:45:55.768815 140090474276288 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:55.925659 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:55.970140 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:56.018476 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:56.062787 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:56.110538 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:56.155692 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:56.205446 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:45:56.248785 140090474276288 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:45:56.275429 140090474276288 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:45:56.294446 140090474276288 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:45:59.598556 140090474276288 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:45:59.719093 140090474276288 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:46:00.462732 140090474276288 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:46:00.518032 140090474276288 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:46:03.152637 140090474276288 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:46:13.872615 140090474276288 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:46:13.873380 140090474276288 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:46:13.873807: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:46:13.879976 140090474276288 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:46:13.899668 140090474276288 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:46:13.911931 140090474276288 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:46:28.027419 140090474276288 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:46:28.028417 140089585809152 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:46:28.029016 140089577416448 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:46:28.096678 140090474276288 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:46:28.097382 140090474276288 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.056638952, step = 35
I0405 01:46:41.031424 140090474276288 basic_session_run_hooks.py:249] loss = 0.056638952, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:46:41.033636 140090474276288 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:46:52.880105 140090474276288 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:46:52.880475 140090474276288 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:46:52.880883 140089585809152 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:46:52.881232 140089585809152 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:46:52.881522 140090474276288 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:46:52.881756 140090474276288 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:46:52.881830 140090474276288 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:46:52.882014 140089577416448 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:46:52.882203 140089577416448 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:46:52.882425 140090474276288 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:46:52.882618 140090474276288 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.056638952.
I0405 01:46:53.061809 140090474276288 estimator.py:359] Loss for final step: 0.056638952.
INFO:tensorflow:training_loop marked as finished
I0405 01:46:53.062515 140090474276288 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:46:53.911380 140090474276288 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:46:55.187624 140090474276288 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:46:55.432306 140090474276288 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:46:55Z
I0405 01:46:55.448435 140090474276288 evaluation.py:257] Starting evaluation at 2019-04-05T01:46:55Z
INFO:tensorflow:TPU job name worker
I0405 01:46:55.448749 140090474276288 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:46:55.535027 140090474276288 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:46:55.535789 140090474276288 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:46:55.739269 140090474276288 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:46:58.217053 140090474276288 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:46:58.256822 140090474276288 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:46:58.310254 140090474276288 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:47:12.994178 140090474276288 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:47:12.995312 140089561179904 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:47:12.996174 140089082509056 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:47:13.051321 140090474276288 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:47:13.077107 140090474276288 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:47:13.077545 140090474276288 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:47:14.264219 140090474276288 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:47:14.264635 140090474276288 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:47:14.264719 140090474276288 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:47:14.265074 140089561179904 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:47:14.265480 140089561179904 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:47:14.265784 140090474276288 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:47:14.266064 140090474276288 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:47:14.266144 140090474276288 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:47:14.266323 140089082509056 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:47:14.266532 140089082509056 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:47:14.266717 140090474276288 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:47:14.266937 140090474276288 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:47:14
I0405 01:47:14.364377 140090474276288 evaluation.py:277] Finished evaluation at 2019-04-05-01:47:14
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9864, global_step = 35, loss = 0.034926295
I0405 01:47:14.364789 140090474276288 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9864, global_step = 35, loss = 0.034926295
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:47:18.707031 140090474276288 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:47:19.420617 140090474276288 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.034926295, 'global_step': 35, 'accuracy': 0.9864}

warmup 10, weight decay 0.08
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554428773419063...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554428769747447...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554428807133737...
Removing gs://bert-pretrain-data/mnist_log3/#1554428805585579...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554428757.yangyouucb#1554428812649479...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554428809635887...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554428762755202...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554428807798848...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554428768980028...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554428811522846...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554428835730425...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554428835.yangyouucb#1554428839206501...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:47:22.862338 139851206833600 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:47:23.002088 139851206833600 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f3188cb6650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f318b5dbb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:47:23.136898 139851206833600 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f3188cb6650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f318b5dbb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:47:23.137454 139851206833600 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:47:23.460885 139851206833600 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:47:23.464106: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:47:23.479805 139851206833600 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:47:23.480129 139851206833600 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:47:23.480499 139851206833600 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:47:23.480596 139851206833600 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:47:23.480673 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:47:23.480887 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:47:23.480964 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:47:23.481038 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:47:23.481115 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:47:23.481185 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:47:23.481254 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:47:23.481321 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:47:23.481404 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:47:23.481472 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:47:23.481611 139851206833600 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:47:23.486376 139851206833600 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:47:23.499624 139851206833600 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:47:24.985671 139851206833600 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:47:25.054017 139851206833600 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:47:25.254944 139851206833600 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:47:25.343391 139851206833600 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:47:25.371635 139851206833600 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:47:25.377253 139851206833600 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.556917 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.606256 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.659620 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.708707 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.762722 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.813561 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.867860 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:47:25.914089 139851206833600 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:47:25.940824 139851206833600 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:47:25.959029 139851206833600 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:47:29.163311 139851206833600 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:47:29.285305 139851206833600 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:47:29.990144 139851206833600 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:47:30.043709 139851206833600 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:47:32.540050 139851206833600 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:47:43.858984 139851206833600 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:47:43.859721 139851206833600 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:47:43.860149: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:47:43.866040 139851206833600 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:47:43.884509 139851206833600 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:47:43.896871 139851206833600 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:47:58.223905 139851206833600 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:47:58.225415 139849973626624 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:47:58.226010 139849965233920 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:47:58.294712 139851206833600 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:47:58.295393 139851206833600 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.051544607, step = 35
I0405 01:48:11.280827 139851206833600 basic_session_run_hooks.py:249] loss = 0.051544607, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:48:11.283030 139851206833600 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:48:22.685693 139851206833600 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:48:22.686019 139851206833600 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:48:22.686235 139849973626624 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:48:22.686368 139849973626624 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:48:22.686557 139851206833600 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:48:22.686678 139851206833600 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:48:22.686742 139851206833600 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:48:22.686868 139849965233920 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:48:22.686956 139849965233920 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:48:22.687083 139851206833600 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:48:22.687186 139851206833600 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.051544607.
I0405 01:48:22.870066 139851206833600 estimator.py:359] Loss for final step: 0.051544607.
INFO:tensorflow:training_loop marked as finished
I0405 01:48:22.870794 139851206833600 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:48:23.650626 139851206833600 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:48:24.914597 139851206833600 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:48:25.156831 139851206833600 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:48:25Z
I0405 01:48:25.173444 139851206833600 evaluation.py:257] Starting evaluation at 2019-04-05T01:48:25Z
INFO:tensorflow:TPU job name worker
I0405 01:48:25.173784 139851206833600 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:48:25.261761 139851206833600 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:48:25.262605 139851206833600 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:48:25.439922 139851206833600 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:48:28.007210 139851206833600 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:48:28.032627 139851206833600 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:48:28.079865 139851206833600 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:48:42.312966 139851206833600 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:48:42.314013 139849965233920 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:48:42.314393 139849956841216 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:48:42.368129 139851206833600 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:48:42.389832 139851206833600 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:48:42.390232 139851206833600 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:48:43.574286 139851206833600 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:48:43.574691 139851206833600 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:48:43.574775 139851206833600 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:48:43.575011 139849965233920 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:48:43.575160 139849965233920 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:48:43.575320 139851206833600 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:48:43.575470 139851206833600 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:48:43.575531 139851206833600 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:48:43.575664 139849956841216 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:48:43.575756 139849956841216 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:48:43.575891 139851206833600 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:48:43.575985 139851206833600 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:48:43
I0405 01:48:43.666512 139851206833600 evaluation.py:277] Finished evaluation at 2019-04-05-01:48:43
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9863, global_step = 35, loss = 0.034910433
I0405 01:48:43.666898 139851206833600 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9863, global_step = 35, loss = 0.034910433
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:48:47.390171 139851206833600 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:48:48.101732 139851206833600 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.034910433, 'global_step': 35, 'accuracy': 0.9863}

warmup 10, weight decay 0.1
Removing gs://bert-pretrain-data/mnist_log3/#1554428895947659...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554428899773604...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554428847.yangyouucb#1554428902458791...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554428863376278...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554428852118416...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554428859878022...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554428897389286...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554428898089188...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554428859143900...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554428901639243...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554428925004782...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554428925.yangyouucb#1554428927877051...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:48:51.580317 140117892548032 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:48:51.694263 140117892548032 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f6fa0807650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f6fa312cb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:48:51.804668 140117892548032 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f6fa0807650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f6fa312cb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:48:51.805167 140117892548032 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:48:52.124260 140117892548032 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:48:52.127262: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:48:52.142412 140117892548032 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:48:52.142724 140117892548032 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:48:52.143079 140117892548032 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:48:52.143158 140117892548032 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:48:52.143219 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:48:52.143428 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:48:52.143500 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:48:52.143563 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:48:52.143640 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:48:52.143718 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:48:52.143779 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:48:52.143837 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:48:52.143896 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:48:52.143954 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:48:52.144012 140117892548032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:48:52.148722 140117892548032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:48:52.161586 140117892548032 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:48:53.981806 140117892548032 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:48:54.051687 140117892548032 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:48:54.239423 140117892548032 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:48:54.323252 140117892548032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:48:54.350672 140117892548032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:48:54.355842 140117892548032 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.529956 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.578330 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.631222 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.680376 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.732872 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.783776 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.839448 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:48:54.886853 140117892548032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:48:54.914030 140117892548032 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:48:54.932843 140117892548032 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:48:58.126070 140117892548032 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:48:58.248181 140117892548032 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:48:58.988204 140117892548032 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:48:59.043158 140117892548032 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:49:01.659869 140117892548032 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:49:12.180743 140117892548032 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:49:12.181704 140117892548032 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:49:12.182206: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:49:12.189116 140117892548032 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:49:12.208805 140117892548032 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:49:12.222569 140117892548032 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:49:26.649763 140117892548032 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:49:26.650957 140116798469888 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:49:26.651488 140116790077184 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:49:26.719258 140117892548032 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:49:26.719995 140117892548032 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.07113444, step = 35
I0405 01:49:39.342890 140117892548032 basic_session_run_hooks.py:249] loss = 0.07113444, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:49:39.345088 140117892548032 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:49:52.023646 140117892548032 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:49:52.023998 140117892548032 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:49:52.024328 140116798469888 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:49:52.024728 140116798469888 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:49:52.024987 140117892548032 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:49:52.025271 140117892548032 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:49:52.025372 140117892548032 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:49:52.025619 140116790077184 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:49:52.025851 140116790077184 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:49:52.026058 140117892548032 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:49:52.026300 140117892548032 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.07113444.
I0405 01:49:52.205868 140117892548032 estimator.py:359] Loss for final step: 0.07113444.
INFO:tensorflow:training_loop marked as finished
I0405 01:49:52.206605 140117892548032 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:49:53.166940 140117892548032 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:49:54.442985 140117892548032 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:49:54.703329 140117892548032 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:49:54Z
I0405 01:49:54.719587 140117892548032 evaluation.py:257] Starting evaluation at 2019-04-05T01:49:54Z
INFO:tensorflow:TPU job name worker
I0405 01:49:54.719907 140117892548032 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:49:54.807297 140117892548032 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:49:54.808088 140117892548032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:49:54.992495 140117892548032 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:49:58.371651 140117892548032 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:49:58.396379 140117892548032 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:49:58.450674 140117892548032 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:50:12.873174 140117892548032 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:50:12.874445 140116773291776 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:50:12.875272 140116764899072 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:50:12.929034 140117892548032 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:50:12.950843 140117892548032 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:50:12.951231 140117892548032 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:50:14.282179 140117892548032 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:50:14.282578 140117892548032 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:50:14.282701 140117892548032 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:50:14.282991 140116773291776 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:50:14.283297 140116773291776 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:50:14.283551 140117892548032 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:50:14.283761 140117892548032 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:50:14.283890 140117892548032 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:50:14.284064 140116764899072 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:50:14.284224 140116764899072 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:50:14.284387 140117892548032 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:50:14.284538 140117892548032 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:50:14
I0405 01:50:14.384939 140117892548032 evaluation.py:277] Finished evaluation at 2019-04-05-01:50:14
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9817, global_step = 35, loss = 0.04977657
I0405 01:50:14.385310 140117892548032 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9817, global_step = 35, loss = 0.04977657
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:50:18.173018 140117892548032 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:50:19.053178 140117892548032 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.04977657, 'global_step': 35, 'accuracy': 0.9817}

warmup 10, weight decay 0.001
Removing gs://bert-pretrain-data/mnist_log3/#1554428984824650...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554428947905910...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554428988875413...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554428951686856...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554428936.yangyouucb#1554428991801133...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554428941235014...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554428986358251...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554428947178858...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554428987083223...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554428990745734...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429015719626...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429015.yangyouucb#1554429018834213...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:50:22.559521 140187306526144 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:50:22.677405 140187306526144 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7fc9e5b650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7fcc780b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:50:22.798116 140187306526144 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7fc9e5b650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7fcc780b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:50:22.798625 140187306526144 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:50:23.118801 140187306526144 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:50:23.122039: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:50:23.134414 140187306526144 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:50:23.134721 140187306526144 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:50:23.135066 140187306526144 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:50:23.135188 140187306526144 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:50:23.135256 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:50:23.135474 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:50:23.135543 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:50:23.135612 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:50:23.135673 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:50:23.135732 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:50:23.135792 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:50:23.135849 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:50:23.135907 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:50:23.135966 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:50:23.136023 140187306526144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:50:23.140644 140187306526144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:50:23.154043 140187306526144 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:50:24.687194 140187306526144 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:50:24.755134 140187306526144 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:50:24.946309 140187306526144 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:50:25.031920 140187306526144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:50:25.060276 140187306526144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:50:25.065731 140187306526144 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.235613 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.282757 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.336200 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.383961 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.436296 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.485244 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.540407 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:50:25.587122 140187306526144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:50:25.613842 140187306526144 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:50:25.631812 140187306526144 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:50:28.900747 140187306526144 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:50:29.017158 140187306526144 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:50:29.721798 140187306526144 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:50:29.779711 140187306526144 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:50:32.377721 140187306526144 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:50:43.539452 140187306526144 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:50:43.540168 140187306526144 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:50:43.540616: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:50:43.547770 140187306526144 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:50:43.565973 140187306526144 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:50:43.578156 140187306526144 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:50:58.165988 140187306526144 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:50:58.166901 140186422327040 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:50:58.167443 140186413934336 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:50:58.239346 140187306526144 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:50:58.240005 140187306526144 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.04278733, step = 35
I0405 01:51:11.617803 140187306526144 basic_session_run_hooks.py:249] loss = 0.04278733, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:51:11.620482 140187306526144 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:51:23.550698 140187306526144 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:51:23.552685 140187306526144 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:51:23.553374 140186422327040 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:51:23.553752 140186422327040 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:51:23.554022 140187306526144 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:51:23.554316 140187306526144 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:51:23.554408 140187306526144 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:51:23.554596 140186413934336 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:51:23.554786 140186413934336 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:51:23.554939 140187306526144 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:51:23.555073 140187306526144 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.04278733.
I0405 01:51:23.746134 140187306526144 estimator.py:359] Loss for final step: 0.04278733.
INFO:tensorflow:training_loop marked as finished
I0405 01:51:23.746864 140187306526144 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:51:24.676084 140187306526144 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:51:25.911828 140187306526144 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:51:26.138725 140187306526144 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:51:26Z
I0405 01:51:26.154124 140187306526144 evaluation.py:257] Starting evaluation at 2019-04-05T01:51:26Z
INFO:tensorflow:TPU job name worker
I0405 01:51:26.154427 140187306526144 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:51:26.235270 140187306526144 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:51:26.236017 140187306526144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:51:26.400454 140187306526144 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:51:29.047278 140187306526144 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:51:29.072972 140187306526144 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:51:29.120980 140187306526144 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:51:43.655898 140187306526144 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:51:43.657047 140186405041920 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:51:43.658112 140186054817536 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:51:43.711852 140187306526144 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:51:43.738884 140187306526144 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:51:43.739308 140187306526144 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:51:45.220174 140187306526144 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:51:45.220587 140187306526144 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:51:45.220670 140187306526144 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:51:45.220870 140186405041920 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:51:45.220979 140186405041920 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:51:45.221134 140187306526144 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:51:45.221235 140187306526144 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:51:45.221292 140187306526144 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:51:45.221450 140186054817536 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:51:45.221652 140186054817536 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:51:45.221786 140187306526144 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:51:45.221894 140187306526144 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:51:45
I0405 01:51:45.330346 140187306526144 evaluation.py:277] Finished evaluation at 2019-04-05-01:51:45
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9862, global_step = 35, loss = 0.04117349
I0405 01:51:45.330756 140187306526144 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9862, global_step = 35, loss = 0.04117349
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:51:49.239907 140187306526144 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:51:49.994806 140187306526144 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.04117349, 'global_step': 35, 'accuracy': 0.9862}

warmup 10, weight decay 0.002
Removing gs://bert-pretrain-data/mnist_log3/#1554429076384154...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429080606863...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429027.yangyouucb#1554429083333367...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429039416004...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429031965853...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429038696217...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429043071812...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429077967856...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429078670664...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429082541285...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429106744574...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429106.yangyouucb#1554429109770596...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:51:53.457607 140438754039232 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:51:53.583725 140438754039232 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fba555646d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fba57e89b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:51:53.695264 140438754039232 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fba555646d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fba57e89b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:51:53.695811 140438754039232 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:51:54.013086 140438754039232 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:51:54.016343: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:51:54.031400 140438754039232 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:51:54.031702 140438754039232 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:51:54.032067 140438754039232 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:51:54.032135 140438754039232 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:51:54.032196 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:51:54.032433 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:51:54.032510 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:51:54.032603 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:51:54.032666 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:51:54.032727 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:51:54.032788 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:51:54.032847 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:51:54.032952 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:51:54.033015 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:51:54.033075 140438754039232 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:51:54.037725 140438754039232 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:51:54.050786 140438754039232 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:51:55.438322 140438754039232 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:51:55.507817 140438754039232 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:51:55.696727 140438754039232 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:51:55.780494 140438754039232 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:51:55.807791 140438754039232 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:51:55.813239 140438754039232 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:55.982301 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:56.029886 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:56.082329 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:56.130544 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:56.183712 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:56.233726 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:56.287957 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:51:56.334587 140438754039232 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:51:56.361339 140438754039232 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:51:56.379498 140438754039232 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:51:59.511802 140438754039232 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:51:59.631597 140438754039232 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:52:00.328646 140438754039232 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:52:00.382021 140438754039232 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:52:02.959506 140438754039232 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:52:13.473769 140438754039232 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:52:13.474561 140438754039232 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:52:13.474968: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:52:13.481688 140438754039232 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:52:13.500480 140438754039232 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:52:13.515069 140438754039232 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:52:28.024446 140438754039232 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:52:28.025621 140437733119744 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:52:28.026608 140437724727040 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:52:28.094664 140438754039232 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:52:28.095350 140438754039232 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.057069927, step = 35
I0405 01:52:40.447396 140438754039232 basic_session_run_hooks.py:249] loss = 0.057069927, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:52:40.449987 140438754039232 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:52:53.304068 140438754039232 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:52:53.304449 140438754039232 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:52:53.304687 140437733119744 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:52:53.304816 140437733119744 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:52:53.305006 140438754039232 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:52:53.305135 140438754039232 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:52:53.305231 140438754039232 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:52:53.305385 140437724727040 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:52:53.305478 140437724727040 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:52:53.305713 140438754039232 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:52:53.305833 140438754039232 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.057069927.
I0405 01:52:53.497991 140438754039232 estimator.py:359] Loss for final step: 0.057069927.
INFO:tensorflow:training_loop marked as finished
I0405 01:52:53.498722 140438754039232 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:52:54.458575 140438754039232 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:52:55.752134 140438754039232 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:52:55.988869 140438754039232 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:52:56Z
I0405 01:52:56.004904 140438754039232 evaluation.py:257] Starting evaluation at 2019-04-05T01:52:56Z
INFO:tensorflow:TPU job name worker
I0405 01:52:56.005207 140438754039232 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:52:56.090672 140438754039232 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:52:56.091481 140438754039232 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:52:56.261991 140438754039232 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:52:58.893157 140438754039232 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:52:58.920588 140438754039232 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:52:58.968674 140438754039232 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:53:13.608238 140438754039232 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:53:13.609177 140437511730944 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:53:13.609766 140437503338240 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:53:13.662978 140438754039232 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:53:13.684104 140438754039232 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:53:13.684570 140438754039232 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:53:14.867342 140438754039232 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:53:14.867748 140438754039232 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:53:14.867871 140438754039232 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:53:14.868091 140437511730944 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:53:14.868201 140437511730944 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:53:14.868400 140438754039232 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:53:14.868514 140438754039232 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:53:14.868578 140438754039232 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:53:14.868701 140437503338240 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:53:14.868789 140437503338240 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:53:14.868910 140438754039232 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:53:14.868999 140438754039232 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:53:14
I0405 01:53:14.962778 140438754039232 evaluation.py:277] Finished evaluation at 2019-04-05-01:53:14
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.041427013
I0405 01:53:14.963176 140438754039232 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.041427013
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:53:18.682293 140438754039232 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:53:19.474212 140438754039232 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.041427013, 'global_step': 35, 'accuracy': 0.9853}

warmup 10, weight decay 0.004
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429129315310...
Removing gs://bert-pretrain-data/mnist_log3/#1554429166056185...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429170368581...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429118.yangyouucb#1554429173078856...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429132972870...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429122531585...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429167586650...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429128554946...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429168269747...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429172339072...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429196272452...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429196.yangyouucb#1554429199254131...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:53:23.011339 139992549569984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:53:23.134912 139992549569984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f527186cf50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f52740cbb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:53:23.264600 139992549569984 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f527186cf50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f52740cbb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:53:23.265141 139992549569984 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:53:23.589867 139992549569984 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:53:23.592762: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:53:23.606736 139992549569984 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:53:23.607072 139992549569984 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:53:23.607449 139992549569984 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:53:23.607517 139992549569984 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:53:23.607579 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:53:23.607773 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:53:23.607853 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:53:23.607919 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:53:23.607980 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:53:23.608040 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:53:23.608098 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:53:23.608155 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:53:23.608211 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:53:23.608285 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:53:23.608347 139992549569984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:53:23.612777 139992549569984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:53:23.625425 139992549569984 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:53:25.046717 139992549569984 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:53:25.115287 139992549569984 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:53:25.308753 139992549569984 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:53:25.396260 139992549569984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:53:25.423897 139992549569984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:53:25.429060 139992549569984 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.597194 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.644056 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.695532 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.742247 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.793548 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.842590 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.895637 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:53:25.950639 139992549569984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:53:25.977536 139992549569984 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:53:25.995935 139992549569984 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:53:29.018986 139992549569984 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:53:29.142436 139992549569984 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:53:29.843147 139992549569984 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:53:29.910881 139992549569984 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:53:32.142141 139992549569984 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:53:43.444230 139992549569984 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:53:43.445029 139992549569984 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:53:43.445456: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:53:43.451850 139992549569984 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:53:43.469652 139992549569984 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:53:43.482053 139992549569984 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:53:58.112255 139992549569984 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:53:58.113569 139991656933120 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:53:58.115242 139991304894208 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:53:58.180335 139992549569984 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:53:58.181073 139992549569984 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.04180731, step = 35
I0405 01:54:11.117094 139992549569984 basic_session_run_hooks.py:249] loss = 0.04180731, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:54:11.119668 139992549569984 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:54:23.051285 139992549569984 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:54:23.051738 139992549569984 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:54:23.052023 139991656933120 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:54:23.052149 139991656933120 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:54:23.052345 139992549569984 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:54:23.052517 139992549569984 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:54:23.052584 139992549569984 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:54:23.052745 139991304894208 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:54:23.052839 139991304894208 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:54:23.052999 139992549569984 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:54:23.053098 139992549569984 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.04180731.
I0405 01:54:23.234637 139992549569984 estimator.py:359] Loss for final step: 0.04180731.
INFO:tensorflow:training_loop marked as finished
I0405 01:54:23.235317 139992549569984 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:54:24.078876 139992549569984 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:54:25.384438 139992549569984 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:54:25.670243 139992549569984 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:54:25Z
I0405 01:54:25.689033 139992549569984 evaluation.py:257] Starting evaluation at 2019-04-05T01:54:25Z
INFO:tensorflow:TPU job name worker
I0405 01:54:25.689428 139992549569984 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:54:25.793828 139992549569984 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:54:25.794730 139992549569984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:54:25.963691 139992549569984 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:54:29.163861 139992549569984 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:54:29.196583 139992549569984 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:54:29.245024 139992549569984 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:54:44.027430 139992549569984 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:54:44.028331 139991296501504 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:54:44.029180 139991288108800 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:54:44.081618 139992549569984 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:54:44.103431 139992549569984 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:54:44.103811 139992549569984 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:54:45.287818 139992549569984 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:54:45.288225 139992549569984 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:54:45.288309 139992549569984 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:54:45.288578 139991296501504 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:54:45.288708 139991296501504 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:54:45.288865 139992549569984 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:54:45.288995 139992549569984 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:54:45.289058 139992549569984 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:54:45.289186 139991288108800 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:54:45.289273 139991288108800 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:54:45.289413 139992549569984 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:54:45.289567 139992549569984 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:54:45
I0405 01:54:45.381162 139992549569984 evaluation.py:277] Finished evaluation at 2019-04-05-01:54:45
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9883, global_step = 35, loss = 0.034019362
I0405 01:54:45.381644 139992549569984 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9883, global_step = 35, loss = 0.034019362
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:54:48.986756 139992549569984 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:54:49.692893 139992549569984 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.034019362, 'global_step': 35, 'accuracy': 0.9883}

warmup 10, weight decay 0.008
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429219260694...
Removing gs://bert-pretrain-data/mnist_log3/#1554429255813481...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429259851519...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429257357942...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429207.yangyouucb#1554429262814396...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429222930696...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429258036223...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429218504496...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429211724364...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429261924456...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429286765281...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429286.yangyouucb#1554429289463562...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:54:53.240473 139780689421760 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:54:53.420084 139780689421760 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f211da11650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2120336b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:54:53.518460 139780689421760 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f211da11650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2120336b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:54:53.518966 139780689421760 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:54:53.832676 139780689421760 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:54:53.835753: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:54:53.850836 139780689421760 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:54:53.851144 139780689421760 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:54:53.851509 139780689421760 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:54:53.851583 139780689421760 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:54:53.851660 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:54:53.851860 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:54:53.851948 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:54:53.852011 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:54:53.852072 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:54:53.852135 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:54:53.852195 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:54:53.852252 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:54:53.852310 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:54:53.852384 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:54:53.852443 139780689421760 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:54:53.856982 139780689421760 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:54:53.869908 139780689421760 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:54:55.281590 139780689421760 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:54:55.350796 139780689421760 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:54:55.536091 139780689421760 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:54:55.619218 139780689421760 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:54:55.646199 139780689421760 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:54:55.651350 139780689421760 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:55.818126 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:55.864326 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:55.915236 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:55.961285 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:56.011918 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:56.059638 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:56.111589 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:54:56.156857 139780689421760 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:54:56.182971 139780689421760 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:54:56.201173 139780689421760 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:54:59.307862 139780689421760 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:54:59.420645 139780689421760 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:55:00.099565 139780689421760 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:55:00.153049 139780689421760 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:55:02.517085 139780689421760 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:55:12.942733 139780689421760 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:55:12.943469 139780689421760 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:55:12.943861: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:55:12.950591 139780689421760 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:55:12.970072 139780689421760 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:55:12.982635 139780689421760 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:55:27.745609 139780689421760 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:55:27.746632 139779805263616 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:55:27.747456 139779796870912 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:55:27.827131 139780689421760 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:55:27.827883 139780689421760 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.048940256, step = 35
I0405 01:55:40.276462 139780689421760 basic_session_run_hooks.py:249] loss = 0.048940256, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:55:40.278871 139780689421760 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:55:51.985466 139780689421760 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:55:51.985878 139780689421760 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:55:51.986103 139779805263616 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:55:51.986218 139779805263616 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:55:51.986417 139780689421760 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:55:51.986574 139780689421760 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:55:51.986635 139780689421760 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:55:51.986764 139779796870912 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:55:51.986860 139779796870912 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:55:51.986989 139780689421760 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:55:51.987077 139780689421760 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.048940256.
I0405 01:55:52.168334 139780689421760 estimator.py:359] Loss for final step: 0.048940256.
INFO:tensorflow:training_loop marked as finished
I0405 01:55:52.169109 139780689421760 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:55:52.968153 139780689421760 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:55:54.255002 139780689421760 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:55:54.500747 139780689421760 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:55:54Z
I0405 01:55:54.517167 139780689421760 evaluation.py:257] Starting evaluation at 2019-04-05T01:55:54Z
INFO:tensorflow:TPU job name worker
I0405 01:55:54.517519 139780689421760 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:55:54.603573 139780689421760 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:55:54.604439 139780689421760 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:55:54.780421 139780689421760 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:55:58.082634 139780689421760 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:55:58.109417 139780689421760 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:55:58.161103 139780689421760 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:56:12.914817 139780689421760 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:56:12.915685 139779787978496 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:56:12.916210 139779442210560 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:56:12.969007 139780689421760 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:56:12.990302 139780689421760 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:56:12.990747 139780689421760 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:56:14.127538 139780689421760 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:56:14.127974 139780689421760 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:56:14.128063 139780689421760 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:56:14.128279 139779787978496 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:56:14.128432 139779787978496 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:56:14.128623 139780689421760 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:56:14.128737 139780689421760 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:56:14.128803 139780689421760 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:56:14.128935 139779442210560 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:56:14.129028 139779442210560 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:56:14.129210 139780689421760 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:56:14.129317 139780689421760 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:56:14
I0405 01:56:14.218477 139780689421760 evaluation.py:277] Finished evaluation at 2019-04-05-01:56:14
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.986, global_step = 35, loss = 0.053166796
I0405 01:56:14.218861 139780689421760 estimator.py:1979] Saving dict for global step 35: accuracy = 0.986, global_step = 35, loss = 0.053166796
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:56:18.111416 139780689421760 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:56:18.990511 139780689421760 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.053166796, 'global_step': 35, 'accuracy': 0.986}

warmup 10, weight decay 0.0001
Removing gs://bert-pretrain-data/mnist_log3/#1554429344807467...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429348641916...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429297.yangyouucb#1554429351728465...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429308720520...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429346320706...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429312451178...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429346975766...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429302106251...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429308040775...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429350654520...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429375602910...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429375.yangyouucb#1554429378768709...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:56:22.479662 139812432709056 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:56:22.595060 139812432709056 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2881b99650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f28843f8b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:56:22.716444 139812432709056 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2881b99650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f28843f8b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:56:22.716988 139812432709056 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:56:23.045943 139812432709056 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:56:23.048816: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:56:23.063957 139812432709056 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:56:23.064239 139812432709056 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:56:23.064590 139812432709056 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:56:23.064659 139812432709056 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:56:23.064732 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:56:23.064946 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:56:23.065016 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:56:23.065080 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:56:23.065140 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:56:23.065200 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:56:23.065258 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:56:23.065340 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:56:23.065416 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:56:23.065474 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:56:23.065588 139812432709056 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:56:23.070151 139812432709056 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:56:23.082720 139812432709056 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:56:24.471221 139812432709056 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:56:24.537667 139812432709056 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:56:24.721689 139812432709056 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:56:24.804979 139812432709056 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:56:24.832184 139812432709056 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:56:24.837346 139812432709056 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.003336 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.050143 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.101238 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.148190 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.199382 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.247335 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.300024 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:56:25.345105 139812432709056 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:56:25.371248 139812432709056 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:56:25.389163 139812432709056 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:56:28.635015 139812432709056 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:56:28.756458 139812432709056 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:56:29.508325 139812432709056 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:56:29.576478 139812432709056 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:56:31.879012 139812432709056 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:56:42.490322 139812432709056 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:56:42.491586 139812432709056 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:56:42.492173: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:56:42.498719 139812432709056 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:56:42.518287 139812432709056 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:56:42.530913 139812432709056 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:56:57.171308 139812432709056 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:56:57.172527 139811548542720 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:56:57.173367 139811540150016 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:56:57.240597 139812432709056 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:56:57.241307 139812432709056 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.045329176, step = 35
I0405 01:57:10.626172 139812432709056 basic_session_run_hooks.py:249] loss = 0.045329176, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:57:10.629348 139812432709056 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:57:22.124172 139812432709056 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:57:22.124536 139812432709056 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:57:22.124788 139811548542720 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:57:22.124929 139811548542720 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:57:22.125118 139812432709056 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:57:22.125248 139812432709056 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:57:22.125309 139812432709056 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:57:22.125466 139811540150016 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:57:22.125613 139811540150016 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:57:22.125746 139812432709056 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:57:22.125849 139812432709056 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.045329176.
I0405 01:57:22.315841 139812432709056 estimator.py:359] Loss for final step: 0.045329176.
INFO:tensorflow:training_loop marked as finished
I0405 01:57:22.316530 139812432709056 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:57:23.132076 139812432709056 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:57:24.379792 139812432709056 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:57:24.614731 139812432709056 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:57:24Z
I0405 01:57:24.630283 139812432709056 evaluation.py:257] Starting evaluation at 2019-04-05T01:57:24Z
INFO:tensorflow:TPU job name worker
I0405 01:57:24.630599 139812432709056 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:57:24.715332 139812432709056 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:57:24.716134 139812432709056 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:57:24.902677 139812432709056 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:57:27.320410 139812432709056 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:57:27.345635 139812432709056 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:57:27.394534 139812432709056 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:57:42.195223 139812432709056 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:57:42.196204 139811531257600 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:57:42.197177 139811184703232 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:57:42.252439 139812432709056 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:57:42.286294 139812432709056 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:57:42.286700 139812432709056 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:57:43.510169 139812432709056 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:57:43.510576 139812432709056 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:57:43.510663 139812432709056 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:57:43.510860 139811531257600 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:57:43.510987 139811531257600 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:57:43.511147 139812432709056 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:57:43.511257 139812432709056 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:57:43.511332 139812432709056 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:57:43.511467 139811184703232 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:57:43.511553 139811184703232 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:57:43.511673 139812432709056 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:57:43.511790 139812432709056 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:57:43
I0405 01:57:43.604991 139812432709056 evaluation.py:277] Finished evaluation at 2019-04-05-01:57:43
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9849, global_step = 35, loss = 0.048600286
I0405 01:57:43.605375 139812432709056 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9849, global_step = 35, loss = 0.048600286
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:57:47.441658 139812432709056 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:57:48.207588 139812432709056 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.048600286, 'global_step': 35, 'accuracy': 0.9849}

warmup 10, weight decay 0.0002
Removing gs://bert-pretrain-data/mnist_log3/#1554429435196129...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429439216004...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429387.yangyouucb#1554429441897476...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429391470782...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429397449843...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429398163157...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429401995596...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429437408199...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429436651323...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429441138365...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429464968804...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429465.yangyouucb#1554429467985165...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:57:51.705856 139710341891520 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:57:51.910275 139710341891520 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f10bca35ed0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f10bf294b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:57:52.005464 139710341891520 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f10bca35ed0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f10bf294b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:57:52.006047 139710341891520 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:57:52.323179 139710341891520 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:57:52.326170: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:57:52.340634 139710341891520 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:57:52.340980 139710341891520 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:57:52.341341 139710341891520 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:57:52.341453 139710341891520 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:57:52.341566 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:57:52.341824 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:57:52.341896 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:57:52.341959 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:57:52.342020 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:57:52.342078 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:57:52.342138 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:57:52.342195 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:57:52.342252 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:57:52.342313 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:57:52.342381 139710341891520 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:57:52.346837 139710341891520 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:57:52.359508 139710341891520 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:57:53.828399 139710341891520 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:57:53.896328 139710341891520 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:57:54.089155 139710341891520 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:57:54.174393 139710341891520 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:57:54.202423 139710341891520 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:57:54.207804 139710341891520 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.387151 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.436152 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.492204 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.543129 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.595818 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.645306 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.699476 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:57:54.746458 139710341891520 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:57:54.773690 139710341891520 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:57:54.792201 139710341891520 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:57:57.922343 139710341891520 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:57:58.039957 139710341891520 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:57:58.750283 139710341891520 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:57:58.809721 139710341891520 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:58:01.452869 139710341891520 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:58:12.565205 139710341891520 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:58:12.566040 139710341891520 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:58:12.566495: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:58:12.573308 139710341891520 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:58:12.591434 139710341891520 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:58:12.604382 139710341891520 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0405 01:58:27.607068 139710341891520 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:58:27.609452 139709524875008 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:58:27.609877 139709112121088 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:58:27.678845 139710341891520 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:58:27.679563 139710341891520 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.05936328, step = 35
I0405 01:58:40.025540 139710341891520 basic_session_run_hooks.py:249] loss = 0.05936328, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:58:40.028121 139710341891520 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 01:58:52.748800 139710341891520 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:58:52.749172 139710341891520 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:58:52.749602 139709524875008 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:58:52.749984 139709524875008 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:58:52.750298 139710341891520 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:58:52.750601 139710341891520 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:58:52.750674 139710341891520 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:58:52.750901 139709112121088 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:58:52.751146 139709112121088 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:58:52.751311 139710341891520 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:58:52.751492 139710341891520 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.05936328.
I0405 01:58:52.938416 139710341891520 estimator.py:359] Loss for final step: 0.05936328.
INFO:tensorflow:training_loop marked as finished
I0405 01:58:52.939106 139710341891520 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 01:58:53.848234 139710341891520 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:58:55.066873 139710341891520 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 01:58:55.308186 139710341891520 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T01:58:55Z
I0405 01:58:55.324846 139710341891520 evaluation.py:257] Starting evaluation at 2019-04-05T01:58:55Z
INFO:tensorflow:TPU job name worker
I0405 01:58:55.325155 139710341891520 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:58:55.413009 139710341891520 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 01:58:55.413806 139710341891520 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:58:55.590621 139710341891520 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 01:58:58.540028 139710341891520 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:58:58.565563 139710341891520 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 01:58:58.614186 139710341891520 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:59:13.362458 139710341891520 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:59:13.363498 139709103728384 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:59:13.364245 139709095335680 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:59:13.417654 139710341891520 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 01:59:13.439066 139710341891520 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 01:59:13.439492 139710341891520 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 01:59:14.560256 139710341891520 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 01:59:14.560780 139710341891520 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 01:59:14.560869 139710341891520 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 01:59:14.561137 139709103728384 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 01:59:14.561592 139709103728384 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 01:59:14.561811 139710341891520 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 01:59:14.562032 139710341891520 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 01:59:14.562098 139710341891520 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 01:59:14.562290 139709095335680 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 01:59:14.562536 139709095335680 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 01:59:14.562742 139710341891520 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 01:59:14.562954 139710341891520 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-01:59:14
I0405 01:59:14.658891 139710341891520 evaluation.py:277] Finished evaluation at 2019-04-05-01:59:14
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9871, global_step = 35, loss = 0.03779604
I0405 01:59:14.659267 139710341891520 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9871, global_step = 35, loss = 0.03779604
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 01:59:18.970995 139710341891520 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 01:59:19.823628 139710341891520 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.03779604, 'global_step': 35, 'accuracy': 0.9871}

warmup 10, weight decay 0.0004
Removing gs://bert-pretrain-data/mnist_log3/#1554429525742733...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429529947879...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429488221966...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429481021767...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429476.yangyouucb#1554429532521215...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429492089921...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429487420611...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429527328431...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429528148863...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429531805631...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429556100876...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429556.yangyouucb#1554429559596987...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 01:59:23.312254 140219076298176 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 01:59:23.433859 140219076298176 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f872f85f6d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f8732184b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 01:59:23.543086 140219076298176 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f872f85f6d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f8732184b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 01:59:23.543648 140219076298176 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 01:59:23.871685 140219076298176 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 01:59:23.874695: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 01:59:23.889185 140219076298176 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 01:59:23.889548 140219076298176 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 01:59:23.889952 140219076298176 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 01:59:23.890023 140219076298176 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 01:59:23.890086 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 01:59:23.890301 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 01:59:23.890383 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 01:59:23.890456 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 01:59:23.890520 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 01:59:23.890605 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 01:59:23.890669 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 01:59:23.890734 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 01:59:23.890794 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 01:59:23.890855 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 01:59:23.890913 140219076298176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 01:59:23.895378 140219076298176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 01:59:23.907867 140219076298176 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:59:25.328092 140219076298176 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 01:59:25.398509 140219076298176 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 01:59:25.582921 140219076298176 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 01:59:25.667747 140219076298176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 01:59:25.695897 140219076298176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 01:59:25.701152 140219076298176 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:25.874304 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:25.921793 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:25.972767 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:26.017255 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:26.065123 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:26.109981 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:26.158545 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 01:59:26.201272 140219076298176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 01:59:26.226500 140219076298176 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 01:59:26.243438 140219076298176 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 01:59:29.427793 140219076298176 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 01:59:29.551482 140219076298176 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 01:59:30.252548 140219076298176 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 01:59:30.313472 140219076298176 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 01:59:32.734221 140219076298176 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 01:59:43.022258 140219076298176 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 01:59:43.023015 140219076298176 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 01:59:43.023442: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 01:59:43.029064 140219076298176 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 01:59:43.045706 140219076298176 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 01:59:43.057172 140219076298176 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 01:59:57.904251 140219076298176 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 01:59:57.905261 140218116069120 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 01:59:57.905656 140218107676416 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 01:59:57.974627 140219076298176 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 01:59:57.975336 140219076298176 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.040865008, step = 35
I0405 02:00:10.498369 140219076298176 basic_session_run_hooks.py:249] loss = 0.040865008, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:00:10.501028 140219076298176 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:00:23.121325 140219076298176 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:00:23.121764 140219076298176 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:00:23.122067 140218116069120 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:00:23.122190 140218116069120 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:00:23.122379 140219076298176 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:00:23.122509 140219076298176 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:00:23.122587 140219076298176 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:00:23.122721 140218107676416 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:00:23.122808 140218107676416 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:00:23.122956 140219076298176 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:00:23.123045 140219076298176 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.040865008.
I0405 02:00:23.314728 140219076298176 estimator.py:359] Loss for final step: 0.040865008.
INFO:tensorflow:training_loop marked as finished
I0405 02:00:23.315447 140219076298176 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:00:24.261113 140219076298176 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:00:25.675978 140219076298176 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:00:25.918323 140219076298176 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:00:25Z
I0405 02:00:25.934746 140219076298176 evaluation.py:257] Starting evaluation at 2019-04-05T02:00:25Z
INFO:tensorflow:TPU job name worker
I0405 02:00:25.935080 140219076298176 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:00:26.022388 140219076298176 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:00:26.023225 140219076298176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:00:26.205337 140219076298176 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:00:28.927723 140219076298176 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:00:28.952893 140219076298176 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:00:29.010621 140219076298176 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 02:00:43.905960 140219076298176 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:00:43.906930 140218091439872 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:00:43.907428 140218083047168 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:00:43.960231 140219076298176 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:00:43.986082 140219076298176 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:00:43.986494 140219076298176 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:00:45.200731 140219076298176 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:00:45.201241 140219076298176 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:00:45.201349 140219076298176 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:00:45.201615 140218091439872 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:00:45.201816 140218091439872 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:00:45.201997 140219076298176 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:00:45.202121 140219076298176 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:00:45.202202 140219076298176 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:00:45.202331 140218083047168 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:00:45.202488 140218083047168 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:00:45.202630 140219076298176 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:00:45.202733 140219076298176 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:00:45
I0405 02:00:45.307575 140219076298176 evaluation.py:277] Finished evaluation at 2019-04-05-02:00:45
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.987, global_step = 35, loss = 0.03947433
I0405 02:00:45.307960 140219076298176 estimator.py:1979] Saving dict for global step 35: accuracy = 0.987, global_step = 35, loss = 0.03947433
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:00:49.047096 140219076298176 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:00:49.882817 140219076298176 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.03947433, 'global_step': 35, 'accuracy': 0.987}

warmup 10, weight decay 0.0008
Removing gs://bert-pretrain-data/mnist_log3/#1554429616034784...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429578881101...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429620080181...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429567.yangyouucb#1554429622897501...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429617612697...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429618334934...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429582559314...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429572309642...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429578220379...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429622172215...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429646725523...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429646.yangyouucb#1554429649656233...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:00:53.400686 140221759194560 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:00:53.529011 140221759194560 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f87cf7c15d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f87d2020b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:00:53.652723 140221759194560 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f87cf7c15d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f87d2020b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:00:53.653247 140221759194560 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:00:53.962582 140221759194560 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:00:53.968286: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:00:53.983802 140221759194560 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:00:53.984097 140221759194560 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:00:53.984462 140221759194560 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:00:53.984529 140221759194560 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:00:53.984591 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:00:53.984786 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:00:53.984853 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:00:53.984920 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:00:53.984982 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:00:53.985040 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:00:53.985100 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:00:53.985160 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:00:53.985218 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:00:53.985275 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:00:53.985352 140221759194560 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:00:53.990078 140221759194560 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:00:54.003334 140221759194560 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:00:55.382611 140221759194560 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:00:55.454790 140221759194560 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:00:55.645840 140221759194560 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:00:55.729245 140221759194560 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:00:55.756088 140221759194560 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 02:00:55.761233 140221759194560 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:55.928078 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:55.974531 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:56.025679 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:56.072065 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:56.123009 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:56.171845 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:56.225820 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:00:56.272278 140221759194560 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:00:56.298454 140221759194560 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:00:56.316762 140221759194560 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:00:59.615489 140221759194560 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:00:59.733901 140221759194560 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:01:00.434665 140221759194560 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:01:00.483694 140221759194560 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:01:02.872632 140221759194560 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:01:13.859477 140221759194560 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:01:13.860188 140221759194560 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:01:13.860630: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:01:13.867738 140221759194560 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:01:13.885673 140221759194560 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:01:13.898652 140221759194560 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 02:01:28.787842 140221759194560 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:01:28.788991 140220792030976 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:01:28.789391 140220783638272 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:01:28.857573 140221759194560 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:01:28.858251 140221759194560 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.05502257, step = 35
I0405 02:01:40.798269 140221759194560 basic_session_run_hooks.py:249] loss = 0.05502257, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:01:40.800615 140221759194560 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:01:53.698824 140221759194560 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:01:53.699201 140221759194560 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:01:53.699438 140220792030976 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:01:53.699573 140220792030976 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:01:53.699753 140221759194560 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:01:53.699886 140221759194560 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:01:53.699965 140221759194560 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:01:53.700092 140220783638272 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:01:53.700179 140220783638272 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:01:53.700304 140221759194560 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:01:53.700407 140221759194560 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.05502257.
I0405 02:01:53.889430 140221759194560 estimator.py:359] Loss for final step: 0.05502257.
INFO:tensorflow:training_loop marked as finished
I0405 02:01:53.890129 140221759194560 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:01:54.765583 140221759194560 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:01:55.994555 140221759194560 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:01:56.235213 140221759194560 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:01:56Z
I0405 02:01:56.251528 140221759194560 evaluation.py:257] Starting evaluation at 2019-04-05T02:01:56Z
INFO:tensorflow:TPU job name worker
I0405 02:01:56.251827 140221759194560 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:01:56.335815 140221759194560 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:01:56.336678 140221759194560 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:01:56.498536 140221759194560 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:01:59.629312 140221759194560 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:01:59.660260 140221759194560 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:01:59.714010 140221759194560 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 02:02:14.496539 140221759194560 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:02:14.497533 140220784187136 tpu_estimator.py:463] Starting infeed thread controller.
I0405 02:02:14.498436 140220775794432 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:02:14.553795 140221759194560 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:02:14.581860 140221759194560 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:02:14.582282 140221759194560 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:02:15.728704 140221759194560 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:02:15.729099 140221759194560 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:02:15.729202 140221759194560 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:02:15.729479 140220784187136 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:02:15.729681 140220784187136 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:02:15.729854 140221759194560 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:02:15.729974 140221759194560 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:02:15.730032 140221759194560 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:02:15.730185 140220775794432 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:02:15.730273 140220775794432 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:02:15.730424 140221759194560 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:02:15.730526 140221759194560 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:02:15
I0405 02:02:15.831873 140221759194560 evaluation.py:277] Finished evaluation at 2019-04-05-02:02:15
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9856, global_step = 35, loss = 0.045691703
I0405 02:02:15.832284 140221759194560 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9856, global_step = 35, loss = 0.045691703
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:02:19.620414 140221759194560 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:02:20.312685 140221759194560 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.045691703, 'global_step': 35, 'accuracy': 0.9856}

warmup 10, weight decay 0.00001
Removing gs://bert-pretrain-data/mnist_log3/#1554429706326935...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429710450357...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429658.yangyouucb#1554429713472090...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429662461923...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429669452445...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429708610090...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429673354037...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429707901111...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429668720570...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429712343123...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429737164579...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429737.yangyouucb#1554429740079896...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:02:23.919044 140271809541568 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:02:24.053991 140271809541568 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9376ab29d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f93793dcb10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:02:24.171462 140271809541568 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9376ab29d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f93793dcb10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:02:24.172023 140271809541568 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:02:24.503707 140271809541568 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:02:24.506825: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:02:24.519248 140271809541568 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:02:24.519537 140271809541568 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:02:24.519881 140271809541568 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:02:24.519951 140271809541568 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:02:24.520021 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:02:24.520215 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:02:24.520289 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:02:24.520397 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:02:24.520466 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:02:24.520526 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:02:24.520587 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:02:24.520647 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:02:24.520705 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:02:24.520768 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:02:24.520843 140271809541568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:02:24.525043 140271809541568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:02:24.537360 140271809541568 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:02:25.977005 140271809541568 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:02:26.042720 140271809541568 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:02:26.238945 140271809541568 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:02:26.323506 140271809541568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:02:26.349309 140271809541568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 02:02:26.354484 140271809541568 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.515933 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.560839 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.610554 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.655879 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.705590 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.752377 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.804193 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:02:26.849440 140271809541568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:02:26.875668 140271809541568 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:02:26.894208 140271809541568 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:02:30.245106 140271809541568 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:02:30.365326 140271809541568 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:02:31.093791 140271809541568 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:02:31.155893 140271809541568 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:02:33.693413 140271809541568 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:02:44.390676 140271809541568 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:02:44.391442 140271809541568 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:02:44.391850: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:02:44.398441 140271809541568 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:02:44.416393 140271809541568 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:02:44.429749 140271809541568 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0405 02:02:59.249897 140271809541568 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:02:59.250808 140270846850816 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:02:59.251348 140270838458112 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:02:59.322141 140271809541568 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:02:59.322913 140271809541568 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.03202649, step = 35
I0405 02:03:12.342008 140271809541568 basic_session_run_hooks.py:249] loss = 0.03202649, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:03:12.344593 140271809541568 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:03:24.555732 140271809541568 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:03:24.556140 140271809541568 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:03:24.556459 140270846850816 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:03:24.556591 140270846850816 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:03:24.556772 140271809541568 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:03:24.556901 140271809541568 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:03:24.556983 140271809541568 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:03:24.557138 140270838458112 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:03:24.557226 140270838458112 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:03:24.557410 140271809541568 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:03:24.557548 140271809541568 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.03202649.
I0405 02:03:24.740845 140271809541568 estimator.py:359] Loss for final step: 0.03202649.
INFO:tensorflow:training_loop marked as finished
I0405 02:03:24.743346 140271809541568 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:03:25.665329 140271809541568 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:03:26.908518 140271809541568 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:03:27.145847 140271809541568 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:03:27Z
I0405 02:03:27.162574 140271809541568 evaluation.py:257] Starting evaluation at 2019-04-05T02:03:27Z
INFO:tensorflow:TPU job name worker
I0405 02:03:27.162885 140271809541568 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:03:27.249954 140271809541568 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:03:27.250864 140271809541568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:03:27.432440 140271809541568 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:03:30.046299 140271809541568 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:03:30.078912 140271809541568 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:03:30.126797 140271809541568 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 41 seconds
I0405 02:04:11.619963 140271809541568 tpu_estimator.py:510] Initialized TPU in 41 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:04:11.620867 140270838458112 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:04:11.621726 140270830065408 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:04:11.674710 140271809541568 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:04:11.696351 140271809541568 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:04:11.696753 140271809541568 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:04:12.961339 140271809541568 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:04:12.961783 140271809541568 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:04:12.961879 140271809541568 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:04:12.962194 140270838458112 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:04:12.962572 140270838458112 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:04:12.962809 140271809541568 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:04:12.963114 140271809541568 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:04:12.963196 140271809541568 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:04:12.963390 140270830065408 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:04:12.963620 140270830065408 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:04:12.963820 140271809541568 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:04:12.964036 140271809541568 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:04:13
I0405 02:04:13.055316 140271809541568 evaluation.py:277] Finished evaluation at 2019-04-05-02:04:13
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9883, global_step = 35, loss = 0.036826182
I0405 02:04:13.055735 140271809541568 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9883, global_step = 35, loss = 0.036826182
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:04:17.215289 140271809541568 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:04:17.935306 140271809541568 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.036826182, 'global_step': 35, 'accuracy': 0.9883}

warmup 10, weight decay 0.00002
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429760158175...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429763922281...
Removing gs://bert-pretrain-data/mnist_log3/#1554429796877169...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429799098559...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429748.yangyouucb#1554429804334955...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429759501259...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429798419344...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429800973620...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429753283139...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429803161473...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554429854805473...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554429854.yangyouucb#1554429857700772...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:04:21.473834 140695757555136 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:04:21.595211 140695757555136 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff62bf07c10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff62e831b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:04:21.702877 140695757555136 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff62bf07c10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff62e831b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:04:21.703414 140695757555136 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:04:22.033269 140695757555136 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:04:22.036221: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:04:22.050808 140695757555136 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:04:22.051109 140695757555136 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:04:22.051446 140695757555136 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:04:22.051516 140695757555136 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:04:22.051588 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:04:22.051779 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:04:22.051850 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:04:22.051917 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:04:22.051980 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:04:22.052041 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:04:22.052099 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:04:22.052160 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:04:22.052256 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:04:22.052323 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:04:22.052407 140695757555136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:04:22.056931 140695757555136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:04:22.069525 140695757555136 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:04:23.470684 140695757555136 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:04:23.537841 140695757555136 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:04:23.718708 140695757555136 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:04:23.801183 140695757555136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:04:23.829319 140695757555136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 02:04:23.834590 140695757555136 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.003478 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.051681 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.103774 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.150733 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.202621 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.252111 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.306076 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:04:24.352536 140695757555136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:04:24.379271 140695757555136 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:04:24.397592 140695757555136 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:04:27.623684 140695757555136 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:04:27.745047 140695757555136 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:04:28.435139 140695757555136 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:04:28.488821 140695757555136 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:04:31.086942 140695757555136 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:04:41.871989 140695757555136 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:04:41.872773 140695757555136 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:04:41.873240: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:04:41.879189 140695757555136 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:04:41.899123 140695757555136 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:04:41.914434 140695757555136 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:05:55.557472 140695757555136 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:05:55.558859 140694664505088 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:05:55.559747 140694656112384 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:05:55.625276 140695757555136 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:05:55.626034 140695757555136 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.04778041, step = 35
I0405 02:06:07.428339 140695757555136 basic_session_run_hooks.py:249] loss = 0.04778041, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:06:07.431217 140695757555136 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:06:19.403703 140695757555136 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:06:19.404014 140695757555136 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:06:19.404257 140694664505088 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:06:19.404395 140694664505088 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:06:19.404576 140695757555136 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:06:19.404695 140695757555136 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:06:19.404762 140695757555136 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:06:19.404901 140694656112384 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:06:19.404987 140694656112384 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:06:19.405107 140695757555136 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:06:19.405211 140695757555136 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.04778041.
I0405 02:06:19.593039 140695757555136 estimator.py:359] Loss for final step: 0.04778041.
INFO:tensorflow:training_loop marked as finished
I0405 02:06:19.593796 140695757555136 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:06:20.519105 140695757555136 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:06:21.795222 140695757555136 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:06:22.032545 140695757555136 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:06:22Z
I0405 02:06:22.048341 140695757555136 evaluation.py:257] Starting evaluation at 2019-04-05T02:06:22Z
INFO:tensorflow:TPU job name worker
I0405 02:06:22.048671 140695757555136 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:06:22.134166 140695757555136 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:06:22.134998 140695757555136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:06:22.302735 140695757555136 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:06:24.678776 140695757555136 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:06:24.709059 140695757555136 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:06:24.760987 140695757555136 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:07:39.617319 140695757555136 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:07:39.618618 140694648268544 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:07:39.619429 140694639875840 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:07:39.672765 140695757555136 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:07:39.699316 140695757555136 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:07:39.699727 140695757555136 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:07:41.053622 140695757555136 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:07:41.054028 140695757555136 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:07:41.054116 140695757555136 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:07:41.054327 140694648268544 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:07:41.054469 140694648268544 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:07:41.054625 140695757555136 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:07:41.054737 140695757555136 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:07:41.054796 140695757555136 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:07:41.054949 140694639875840 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:07:41.055041 140694639875840 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:07:41.055166 140695757555136 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:07:41.055258 140695757555136 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:07:41
I0405 02:07:41.154244 140695757555136 evaluation.py:277] Finished evaluation at 2019-04-05-02:07:41
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9868, global_step = 35, loss = 0.04034524
I0405 02:07:41.154648 140695757555136 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9868, global_step = 35, loss = 0.04034524
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:07:44.778781 140695757555136 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:07:45.751574 140695757555136 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.04034524, 'global_step': 35, 'accuracy': 0.9868}

warmup 10, weight decay 0.00004
Removing gs://bert-pretrain-data/mnist_log3/#1554429972259633...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554429976371346...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554429866.yangyouucb#1554429979180052...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554429877598880...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554429870685697...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554429973813512...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554429881386951...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554429974544640...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554429876919233...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554429978412995...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554430062490244...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554430062.yangyouucb#1554430065522574...
/ [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:07:49.260654 139925054404032 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:07:49.388572 139925054404032 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f42ba73af10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f42bd064b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:07:49.474361 139925054404032 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f42ba73af10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f42bd064b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:07:49.474884 139925054404032 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:07:49.807564 139925054404032 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:07:49.813576: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:07:49.827702 139925054404032 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:07:49.828051 139925054404032 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:07:49.828409 139925054404032 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:07:49.828500 139925054404032 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:07:49.828564 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:07:49.828804 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:07:49.828874 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:07:49.828947 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:07:49.829008 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:07:49.829071 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:07:49.829132 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:07:49.829193 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:07:49.829252 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:07:49.829310 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:07:49.829369 139925054404032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:07:49.834228 139925054404032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:07:49.846719 139925054404032 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:07:51.289453 139925054404032 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:07:51.362884 139925054404032 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:07:51.558693 139925054404032 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:07:51.643621 139925054404032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:07:51.671452 139925054404032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 02:07:51.676707 139925054404032 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:51.847311 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:51.895270 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:51.948097 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:51.996673 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:52.050499 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:52.098253 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:52.149616 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:07:52.195502 139925054404032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:07:52.221724 139925054404032 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:07:52.239902 139925054404032 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:07:55.332818 139925054404032 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:07:55.448591 139925054404032 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:07:56.156008 139925054404032 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:07:56.210403 139925054404032 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:07:58.864209 139925054404032 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:08:10.198067 139925054404032 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:08:10.198935 139925054404032 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:08:10.199367: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:08:10.205975 139925054404032 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:08:10.223216 139925054404032 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:08:10.235671 139925054404032 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:09:23.532388 139925054404032 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:09:23.533653 139924170327808 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:09:23.534399 139924161935104 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:09:23.602269 139925054404032 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:09:23.603013 139925054404032 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.054239877, step = 35
I0405 02:09:35.054395 139925054404032 basic_session_run_hooks.py:249] loss = 0.054239877, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:09:35.056669 139925054404032 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:09:46.882630 139925054404032 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:09:46.883002 139925054404032 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:09:46.883390 139924170327808 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:09:46.883733 139924170327808 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:09:46.884093 139925054404032 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:09:46.884372 139925054404032 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:09:46.884463 139925054404032 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:09:46.884860 139924161935104 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:09:46.885094 139924161935104 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:09:46.885288 139925054404032 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:09:46.885481 139925054404032 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.054239877.
I0405 02:09:47.064351 139925054404032 estimator.py:359] Loss for final step: 0.054239877.
INFO:tensorflow:training_loop marked as finished
I0405 02:09:47.065102 139925054404032 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:09:48.020107 139925054404032 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:09:49.302995 139925054404032 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:09:49.539619 139925054404032 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:09:49Z
I0405 02:09:49.554796 139925054404032 evaluation.py:257] Starting evaluation at 2019-04-05T02:09:49Z
INFO:tensorflow:TPU job name worker
I0405 02:09:49.555104 139925054404032 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:09:49.636620 139925054404032 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:09:49.637408 139925054404032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:09:49.821429 139925054404032 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:09:53.118993 139925054404032 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:09:53.150448 139925054404032 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:09:53.200256 139925054404032 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:11:07.557888 139925054404032 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:11:07.559175 139924153042688 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:11:07.560000 139924144649984 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:11:07.611700 139925054404032 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:11:07.637809 139925054404032 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:11:07.638396 139925054404032 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:11:08.776717 139925054404032 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:11:08.777096 139925054404032 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:11:08.777178 139925054404032 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:11:08.777478 139924153042688 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:11:08.777825 139924153042688 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:11:08.778063 139925054404032 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:11:08.778274 139925054404032 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:11:08.778342 139925054404032 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:11:08.778585 139924144649984 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:11:08.778791 139924144649984 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:11:08.779004 139925054404032 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:11:08.779191 139925054404032 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:11:08
I0405 02:11:08.873150 139925054404032 evaluation.py:277] Finished evaluation at 2019-04-05-02:11:08
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.985, global_step = 35, loss = 0.043015245
I0405 02:11:08.873611 139925054404032 estimator.py:1979] Saving dict for global step 35: accuracy = 0.985, global_step = 35, loss = 0.043015245
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:11:12.659332 139925054404032 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:11:13.382656 139925054404032 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.043015245, 'global_step': 35, 'accuracy': 0.985}

warmup 10, weight decay 0.0
Removing gs://bert-pretrain-data/mnist_log3/#1554430179675654...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554430183752873...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554430085995734...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554430181943425...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554430073.yangyouucb#1554430186657949...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554430181212789...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554430078450421...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554430085369730...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554430089739263...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554430185883029...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554430270255715...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554430270.yangyouucb#1554430273160346...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:11:16.960057 139862696097216 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:11:17.092847 139862696097216 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f34359ba650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f34382dfb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:11:17.254847 139862696097216 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f34359ba650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f34382dfb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:11:17.255433 139862696097216 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:11:17.574912 139862696097216 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:11:17.576653: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:11:17.590646 139862696097216 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:11:17.590933 139862696097216 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:11:17.591285 139862696097216 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:11:17.591361 139862696097216 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:11:17.591438 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:11:17.591655 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:11:17.591725 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:11:17.591808 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:11:17.591883 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:11:17.591944 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:11:17.592017 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:11:17.592094 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:11:17.592155 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:11:17.592214 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:11:17.592272 139862696097216 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:11:17.596790 139862696097216 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:11:17.609767 139862696097216 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:11:19.024647 139862696097216 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:11:19.091267 139862696097216 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:11:19.287153 139862696097216 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:11:19.371443 139862696097216 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:11:19.401318 139862696097216 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0405 02:11:19.406903 139862696097216 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.572945 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.619599 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.667123 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.711168 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.759711 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.807185 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.855907 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:11:19.900788 139862696097216 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:11:19.926882 139862696097216 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:11:19.943577 139862696097216 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:11:23.201642 139862696097216 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:11:23.329781 139862696097216 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:11:24.055512 139862696097216 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:11:24.109179 139862696097216 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:11:26.637773 139862696097216 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:11:37.245934 139862696097216 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:11:37.246762 139862696097216 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:11:37.247182: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:11:37.254781 139862696097216 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:11:37.276424 139862696097216 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:11:37.289200 139862696097216 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:12:51.590945 139862696097216 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:12:51.592155 139861812295424 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:12:51.593056 139861803902720 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:12:51.661740 139862696097216 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:12:51.662455 139862696097216 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.05814294, step = 35
I0405 02:13:05.371786 139862696097216 basic_session_run_hooks.py:249] loss = 0.05814294, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:13:05.381443 139862696097216 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:13:17.535775 139862696097216 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:13:17.536135 139862696097216 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:13:17.536393 139861812295424 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:13:17.536520 139861812295424 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:13:17.536703 139862696097216 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:13:17.536825 139862696097216 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:13:17.536895 139862696097216 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:13:17.537024 139861803902720 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:13:17.537147 139861803902720 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:13:17.537306 139862696097216 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:13:17.537411 139862696097216 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.05814294.
I0405 02:13:17.717325 139862696097216 estimator.py:359] Loss for final step: 0.05814294.
INFO:tensorflow:training_loop marked as finished
I0405 02:13:17.718096 139862696097216 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:13:18.658647 139862696097216 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:13:19.930973 139862696097216 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:13:20.175708 139862696097216 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:13:20Z
I0405 02:13:20.192236 139862696097216 evaluation.py:257] Starting evaluation at 2019-04-05T02:13:20Z
INFO:tensorflow:TPU job name worker
I0405 02:13:20.192578 139862696097216 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:13:20.280355 139862696097216 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:13:20.281259 139862696097216 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:13:20.450083 139862696097216 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:13:23.496675 139862696097216 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:13:23.521161 139862696097216 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:13:23.570220 139862696097216 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 71 seconds
I0405 02:14:35.559231 139862696097216 tpu_estimator.py:510] Initialized TPU in 71 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:14:35.560200 139861794748160 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:14:35.561539 139861449242368 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:14:35.613763 139862696097216 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:14:35.636615 139862696097216 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:14:35.637027 139862696097216 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:14:36.806982 139862696097216 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:14:36.808801 139862696097216 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:14:36.808980 139862696097216 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:14:36.809278 139861794748160 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:14:36.809616 139861794748160 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:14:36.809855 139862696097216 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:14:36.810040 139862696097216 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:14:36.810107 139862696097216 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:14:36.810338 139861449242368 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:14:36.810534 139861449242368 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:14:36.810714 139862696097216 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:14:36.810863 139862696097216 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:14:36
I0405 02:14:36.907011 139862696097216 evaluation.py:277] Finished evaluation at 2019-04-05-02:14:36
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9857, global_step = 35, loss = 0.044344045
I0405 02:14:36.907460 139862696097216 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9857, global_step = 35, loss = 0.044344045
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:14:40.899975 139862696097216 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:14:41.653481 139862696097216 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.044344045, 'global_step': 35, 'accuracy': 0.9857}

warmup 11, weight decay 0.01
Removing gs://bert-pretrain-data/mnist_log3/#1554430389972883...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554430293156965...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554430296765875...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554430394016441...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554430391548435...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554430281.yangyouucb#1554430397310238...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554430286228995...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554430392277282...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554430292433781...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554430396160746...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554430478335808...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554430478.yangyouucb#1554430481415063...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:14:45.141805 140356250174912 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:14:45.252437 140356250174912 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa71fc59e90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fa7224b8b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:14:45.368772 140356250174912 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa71fc59e90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fa7224b8b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:14:45.369272 140356250174912 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:14:45.685539 140356250174912 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:14:45.688619: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:14:45.701778 140356250174912 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:14:45.702065 140356250174912 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:14:45.702431 140356250174912 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:14:45.702506 140356250174912 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:14:45.702569 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:14:45.702768 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:14:45.702836 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:14:45.702903 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:14:45.702965 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:14:45.703026 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:14:45.703083 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:14:45.703142 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:14:45.703201 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:14:45.703258 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:14:45.703316 140356250174912 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:14:45.707546 140356250174912 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:14:45.719472 140356250174912 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:14:47.161530 140356250174912 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:14:47.228741 140356250174912 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:14:47.417270 140356250174912 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:14:47.500328 140356250174912 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:14:47.527565 140356250174912 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:14:47.532793 140356250174912 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:47.695353 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:47.740446 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:47.789320 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:47.835021 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:47.887947 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:47.935779 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:47.987564 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:14:48.034287 140356250174912 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:14:48.060973 140356250174912 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:14:48.079642 140356250174912 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:14:51.452565 140356250174912 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:14:51.576814 140356250174912 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:14:52.274713 140356250174912 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:14:52.327903 140356250174912 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:14:54.738028 140356250174912 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:15:06.335792 140356250174912 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:15:06.337151 140356250174912 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:15:06.337609: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:15:06.344372 140356250174912 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:15:06.365000 140356250174912 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:15:06.379642 140356250174912 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:16:19.569751 140356250174912 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:16:19.570959 140355160762112 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:16:19.571470 140355152369408 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:16:19.638845 140356250174912 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:16:19.639596 140356250174912 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.058512468, step = 35
I0405 02:16:31.463634 140356250174912 basic_session_run_hooks.py:249] loss = 0.058512468, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:16:31.465905 140356250174912 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:16:43.176465 140356250174912 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:16:43.176839 140356250174912 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:16:43.177289 140355160762112 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:16:43.177668 140355160762112 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:16:43.177963 140356250174912 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:16:43.178219 140356250174912 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:16:43.178306 140356250174912 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:16:43.178533 140355152369408 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:16:43.178771 140355152369408 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:16:43.179002 140356250174912 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:16:43.179214 140356250174912 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.058512468.
I0405 02:16:43.358726 140356250174912 estimator.py:359] Loss for final step: 0.058512468.
INFO:tensorflow:training_loop marked as finished
I0405 02:16:43.359430 140356250174912 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:16:44.282048 140356250174912 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:16:45.577089 140356250174912 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:16:45.814001 140356250174912 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:16:45Z
I0405 02:16:45.829838 140356250174912 evaluation.py:257] Starting evaluation at 2019-04-05T02:16:45Z
INFO:tensorflow:TPU job name worker
I0405 02:16:45.830147 140356250174912 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:16:45.915124 140356250174912 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:16:45.915918 140356250174912 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:16:46.086257 140356250174912 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:16:48.587971 140356250174912 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:16:48.612729 140356250174912 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:16:48.660329 140356250174912 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:18:03.525948 140356250174912 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:18:03.527148 140355144525568 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:18:03.528050 140355136132864 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:18:03.582735 140356250174912 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:18:03.608500 140356250174912 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:18:03.608928 140356250174912 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:18:04.813704 140356250174912 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:18:04.814133 140356250174912 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:18:04.814222 140356250174912 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:18:04.814555 140355144525568 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:18:04.814872 140355144525568 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:18:04.815100 140356250174912 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:18:04.815315 140356250174912 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:18:04.815412 140356250174912 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:18:04.815627 140355136132864 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:18:04.815821 140355136132864 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:18:04.816035 140356250174912 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:18:04.816215 140356250174912 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:18:04
I0405 02:18:04.911623 140356250174912 evaluation.py:277] Finished evaluation at 2019-04-05-02:18:04
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9855, global_step = 35, loss = 0.036626406
I0405 02:18:04.912017 140356250174912 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9855, global_step = 35, loss = 0.036626406
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:18:08.665282 140356250174912 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:18:09.425806 140356250174912 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.036626406, 'global_step': 35, 'accuracy': 0.9855}

warmup 11, weight decay 0.02
Removing gs://bert-pretrain-data/mnist_log3/#1554430596019505...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554430600019482...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554430502039040...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554430597569988...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554430489.yangyouucb#1554430602940901...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554430598285580...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554430494329090...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554430505848674...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554430501243726...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554430601850528...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554430686280937...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554430686.yangyouucb#1554430689197564...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:18:12.860107 140707289691584 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:18:12.974641 140707289691584 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff8db4f2650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff8dde17b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:18:13.100521 140707289691584 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff8db4f2650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff8dde17b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:18:13.101025 140707289691584 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:18:13.427494 140707289691584 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:18:13.430646: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:18:13.444578 140707289691584 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:18:13.444864 140707289691584 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:18:13.445224 140707289691584 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:18:13.445291 140707289691584 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:18:13.445355 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:18:13.445708 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:18:13.445780 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:18:13.445847 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:18:13.445910 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:18:13.445991 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:18:13.446052 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:18:13.446110 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:18:13.446170 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:18:13.446228 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:18:13.446285 140707289691584 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:18:13.450669 140707289691584 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:18:13.463028 140707289691584 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:18:14.846939 140707289691584 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:18:14.913605 140707289691584 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:18:15.093729 140707289691584 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:18:15.177156 140707289691584 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:18:15.204042 140707289691584 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:18:15.209168 140707289691584 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.376595 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.423949 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.475826 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.522294 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.576788 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.627420 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.679274 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:18:15.724314 140707289691584 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:18:15.750183 140707289691584 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:18:15.767839 140707289691584 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:18:18.925880 140707289691584 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:18:19.043234 140707289691584 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:18:19.735304 140707289691584 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:18:19.804363 140707289691584 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:18:22.355422 140707289691584 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:18:33.249300 140707289691584 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:18:33.250128 140707289691584 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:18:33.250567: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:18:33.257188 140707289691584 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:18:33.274497 140707289691584 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:18:33.286654 140707289691584 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:19:47.562356 140707289691584 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:19:47.563632 140706324662016 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:19:47.564549 140706316269312 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:19:47.633477 140707289691584 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:19:47.634274 140707289691584 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.058658984, step = 35
I0405 02:20:00.391016 140707289691584 basic_session_run_hooks.py:249] loss = 0.058658984, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:20:00.393336 140707289691584 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:20:12.697750 140707289691584 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:20:12.698103 140707289691584 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:20:12.698524 140706324662016 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:20:12.698718 140706324662016 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:20:12.698878 140707289691584 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:20:12.699001 140707289691584 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:20:12.699067 140707289691584 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:20:12.699206 140706316269312 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:20:12.699306 140706316269312 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:20:12.699448 140707289691584 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:20:12.699546 140707289691584 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.058658984.
I0405 02:20:12.886979 140707289691584 estimator.py:359] Loss for final step: 0.058658984.
INFO:tensorflow:training_loop marked as finished
I0405 02:20:12.887687 140707289691584 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:20:13.677957 140707289691584 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:20:14.910727 140707289691584 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:20:15.135296 140707289691584 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:20:15Z
I0405 02:20:15.150757 140707289691584 evaluation.py:257] Starting evaluation at 2019-04-05T02:20:15Z
INFO:tensorflow:TPU job name worker
I0405 02:20:15.151032 140707289691584 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:20:15.233942 140707289691584 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:20:15.234739 140707289691584 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:20:15.418740 140707289691584 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:20:18.167774 140707289691584 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:20:18.192029 140707289691584 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:20:18.246623 140707289691584 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:21:31.532768 140707289691584 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:21:31.534024 140706316818176 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:21:31.534780 140706308425472 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:21:31.590493 140707289691584 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:21:31.615187 140707289691584 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:21:31.615603 140707289691584 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:21:32.998349 140707289691584 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:21:32.998780 140707289691584 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:21:32.998862 140707289691584 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:21:32.999130 140706316818176 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:21:32.999470 140706316818176 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:21:32.999671 140707289691584 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:21:32.999883 140707289691584 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:21:32.999948 140707289691584 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:21:33.000109 140706308425472 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:21:33.000263 140706308425472 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:21:33.000421 140707289691584 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:21:33.000552 140707289691584 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:21:33
I0405 02:21:33.101624 140707289691584 evaluation.py:277] Finished evaluation at 2019-04-05-02:21:33
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9851, global_step = 35, loss = 0.05048383
I0405 02:21:33.102027 140707289691584 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9851, global_step = 35, loss = 0.05048383
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:21:36.717211 140707289691584 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:21:37.668508 140707289691584 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.05048383, 'global_step': 35, 'accuracy': 0.9851}

warmup 11, weight decay 0.04
Removing gs://bert-pretrain-data/mnist_log3/#1554430805821635...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554430809778733...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554430708144110...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554430697.yangyouucb#1554430812465667...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554430701938580...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554430708891210...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554430712780741...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554430807374639...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554430808051487...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554430811713489...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554430894444380...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554430894.yangyouucb#1554430897426496...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:21:41.028156 140128655185344 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:21:41.156424 140128655185344 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7222014650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7224939b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:21:41.264645 140128655185344 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7222014650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7224939b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:21:41.265173 140128655185344 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:21:41.583309 140128655185344 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:21:41.586639: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:21:41.601898 140128655185344 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:21:41.602216 140128655185344 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:21:41.602641 140128655185344 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:21:41.602710 140128655185344 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:21:41.602773 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:21:41.602993 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:21:41.603063 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:21:41.603132 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:21:41.603199 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:21:41.603260 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:21:41.603319 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:21:41.603396 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:21:41.603463 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:21:41.603522 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:21:41.603600 140128655185344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:21:41.608190 140128655185344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:21:41.621192 140128655185344 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:21:43.071799 140128655185344 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:21:43.138736 140128655185344 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:21:43.320878 140128655185344 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:21:43.403929 140128655185344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:21:43.430125 140128655185344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:21:43.435189 140128655185344 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.596358 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.641124 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.689945 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.734338 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.782473 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.828780 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.878617 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:21:43.921153 140128655185344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:21:43.946568 140128655185344 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:21:43.964236 140128655185344 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:21:47.331101 140128655185344 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:21:47.456201 140128655185344 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:21:48.143903 140128655185344 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:21:48.197802 140128655185344 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:21:50.592266 140128655185344 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:22:00.918431 140128655185344 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:22:00.919181 140128655185344 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:22:00.919653: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:22:00.926290 140128655185344 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:22:00.944298 140128655185344 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:22:00.955712 140128655185344 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:23:15.592070 140128655185344 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:23:15.593075 140127770752768 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:23:15.593475 140127762360064 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:23:15.663902 140128655185344 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:23:15.664642 140128655185344 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.045263525, step = 35
I0405 02:23:29.278505 140128655185344 basic_session_run_hooks.py:249] loss = 0.045263525, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:23:29.281085 140128655185344 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:23:41.838026 140128655185344 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:23:41.838438 140128655185344 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:23:41.838778 140127770752768 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:23:41.839122 140127770752768 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:23:41.839366 140128655185344 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:23:41.839675 140128655185344 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:23:41.839756 140128655185344 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:23:41.839946 140127762360064 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:23:41.840126 140127762360064 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:23:41.840316 140128655185344 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:23:41.840526 140128655185344 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.045263525.
I0405 02:23:42.014445 140128655185344 estimator.py:359] Loss for final step: 0.045263525.
INFO:tensorflow:training_loop marked as finished
I0405 02:23:42.015130 140128655185344 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:23:42.828499 140128655185344 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:23:44.067498 140128655185344 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:23:44.297247 140128655185344 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:23:44Z
I0405 02:23:44.312604 140128655185344 evaluation.py:257] Starting evaluation at 2019-04-05T02:23:44Z
INFO:tensorflow:TPU job name worker
I0405 02:23:44.312902 140128655185344 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:23:44.395049 140128655185344 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:23:44.395821 140128655185344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:23:44.579401 140128655185344 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:23:47.147285 140128655185344 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:23:47.177712 140128655185344 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:23:47.225769 140128655185344 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 02:24:59.558068 140128655185344 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:24:59.559185 140127753729792 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:24:59.559834 140127401670400 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:24:59.612812 140128655185344 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:24:59.634042 140128655185344 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:24:59.634457 140128655185344 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:25:00.762257 140128655185344 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:25:00.762677 140128655185344 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:25:00.762768 140128655185344 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:25:00.763077 140127753729792 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:25:00.763422 140127753729792 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:25:00.763935 140128655185344 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:25:00.764166 140128655185344 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:25:00.764241 140128655185344 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:25:00.764436 140127401670400 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:25:00.764661 140127401670400 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:25:00.764866 140128655185344 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:25:00.765069 140128655185344 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:25:00
I0405 02:25:00.855643 140128655185344 evaluation.py:277] Finished evaluation at 2019-04-05-02:25:00
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9862, global_step = 35, loss = 0.036547907
I0405 02:25:00.856029 140128655185344 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9862, global_step = 35, loss = 0.036547907
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:25:04.740717 140128655185344 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:25:05.504909 140128655185344 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.036547907, 'global_step': 35, 'accuracy': 0.9862}

warmup 11, weight decay 0.08
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554431018782957...
Removing gs://bert-pretrain-data/mnist_log3/#1554431014726752...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554430905.yangyouucb#1554431021599953...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554430910175760...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554430916697690...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554430920440039...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554431016260877...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554431016950118...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554430916036543...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554431020891733...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554431102279082...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554431102.yangyouucb#1554431105269917...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:25:09.058334 139652681979328 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:25:09.169378 139652681979328 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f034fca8650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f03525cdb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:25:09.287276 139652681979328 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f034fca8650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f03525cdb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:25:09.287837 139652681979328 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:25:09.624587 139652681979328 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:25:09.627743: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:25:09.640654 139652681979328 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:25:09.640940 139652681979328 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:25:09.641289 139652681979328 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:25:09.641362 139652681979328 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:25:09.641449 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:25:09.641701 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:25:09.641778 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:25:09.641868 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:25:09.641941 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:25:09.642014 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:25:09.642081 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:25:09.642158 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:25:09.642240 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:25:09.642307 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:25:09.642373 139652681979328 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:25:09.646995 139652681979328 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:25:09.659565 139652681979328 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:25:11.160588 139652681979328 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:25:11.226841 139652681979328 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:25:11.421101 139652681979328 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:25:11.505249 139652681979328 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:25:11.532954 139652681979328 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:25:11.538301 139652681979328 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:11.702198 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:11.748320 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:11.798266 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:11.844274 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:11.895349 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:11.943237 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:11.995035 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:25:12.039985 139652681979328 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:25:12.066401 139652681979328 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:25:12.084582 139652681979328 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:25:15.309802 139652681979328 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:25:15.430841 139652681979328 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:25:16.148942 139652681979328 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:25:16.202555 139652681979328 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:25:18.551737 139652681979328 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:25:30.250854 139652681979328 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:25:30.251676 139652681979328 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:25:30.252121: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:25:30.258934 139652681979328 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:25:30.280612 139652681979328 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:25:30.294749 139652681979328 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:26:43.439621 139652681979328 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:26:43.440598 139651583039232 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:26:43.441179 139651574646528 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:26:43.509546 139652681979328 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:26:43.510277 139652681979328 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.061212663, step = 35
I0405 02:26:55.890650 139652681979328 basic_session_run_hooks.py:249] loss = 0.061212663, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:26:55.893393 139652681979328 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:27:07.640562 139652681979328 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:27:07.640896 139652681979328 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:27:07.641227 139651583039232 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:27:07.641659 139651583039232 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:27:07.641925 139652681979328 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:27:07.642222 139652681979328 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:27:07.642299 139652681979328 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:27:07.642549 139651574646528 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:27:07.642784 139651574646528 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:27:07.643110 139652681979328 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:27:07.643331 139652681979328 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.061212663.
I0405 02:27:07.817933 139652681979328 estimator.py:359] Loss for final step: 0.061212663.
INFO:tensorflow:training_loop marked as finished
I0405 02:27:07.818658 139652681979328 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:27:08.732094 139652681979328 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:27:09.974035 139652681979328 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:27:10.208015 139652681979328 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:27:10Z
I0405 02:27:10.223618 139652681979328 evaluation.py:257] Starting evaluation at 2019-04-05T02:27:10Z
INFO:tensorflow:TPU job name worker
I0405 02:27:10.223901 139652681979328 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:27:10.307799 139652681979328 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:27:10.308609 139652681979328 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:27:10.489228 139652681979328 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:27:13.137531 139652681979328 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:27:13.162147 139652681979328 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:27:13.208059 139652681979328 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:28:27.625446 139652681979328 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:28:27.626559 139651574646528 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:28:27.626900 139651566253824 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:28:27.682478 139652681979328 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:28:27.703385 139652681979328 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:28:27.703797 139652681979328 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:28:29.006311 139652681979328 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:28:29.006721 139652681979328 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:28:29.006838 139652681979328 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:28:29.007064 139651574646528 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:28:29.007175 139651574646528 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:28:29.007328 139652681979328 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:28:29.007451 139652681979328 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:28:29.007509 139652681979328 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:28:29.007637 139651566253824 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:28:29.007719 139651566253824 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:28:29.007863 139652681979328 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:28:29.007967 139652681979328 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:28:29
I0405 02:28:29.106322 139652681979328 evaluation.py:277] Finished evaluation at 2019-04-05-02:28:29
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.983, global_step = 35, loss = 0.047039386
I0405 02:28:29.106708 139652681979328 estimator.py:1979] Saving dict for global step 35: accuracy = 0.983, global_step = 35, loss = 0.047039386
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:28:32.797991 139652681979328 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:28:33.450268 139652681979328 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.047039386, 'global_step': 35, 'accuracy': 0.983}

warmup 11, weight decay 0.1
Removing gs://bert-pretrain-data/mnist_log3/#1554431220614328...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554431224779833...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554431113.yangyouucb#1554431227417763...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554431118134630...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554431125249939...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554431125923640...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554431222194565...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554431129747508...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554431222922167...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554431226662069...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554431310450680...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554431310.yangyouucb#1554431313219762...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:28:36.966875 140462046016960 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:28:37.084270 140462046016960 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fbfc1a5a650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fbfc437fb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:28:37.207534 140462046016960 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fbfc1a5a650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fbfc437fb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:28:37.208081 140462046016960 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:28:37.545116 140462046016960 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:28:37.548383: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:28:37.563566 140462046016960 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:28:37.563870 140462046016960 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:28:37.564244 140462046016960 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:28:37.564343 140462046016960 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:28:37.564424 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:28:37.564640 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:28:37.564711 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:28:37.564776 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:28:37.564841 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:28:37.564903 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:28:37.564965 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:28:37.565025 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:28:37.565100 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:28:37.565160 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:28:37.565220 140462046016960 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:28:37.569549 140462046016960 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:28:37.581907 140462046016960 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:28:39.014617 140462046016960 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:28:39.083658 140462046016960 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:28:39.276032 140462046016960 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:28:39.362071 140462046016960 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:28:39.390047 140462046016960 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:28:39.395421 140462046016960 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.570347 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.618776 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.671719 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.719870 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.776062 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.827079 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.881438 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:28:39.928591 140462046016960 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:28:39.955909 140462046016960 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:28:39.974565 140462046016960 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:28:43.240003 140462046016960 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:28:43.356662 140462046016960 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:28:44.066277 140462046016960 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:28:44.124164 140462046016960 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:28:46.490864 140462046016960 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:28:57.363742 140462046016960 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:28:57.364541 140462046016960 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:28:57.364956: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:28:57.371334 140462046016960 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:28:57.389281 140462046016960 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:28:57.401684 140462046016960 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:30:11.560602 140462046016960 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:30:11.561779 140461161821952 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:30:11.562279 140461153429248 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:30:11.628410 140462046016960 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:30:11.629134 140462046016960 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.04808128, step = 35
I0405 02:30:24.395901 140462046016960 basic_session_run_hooks.py:249] loss = 0.04808128, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:30:24.398400 140462046016960 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:30:37.501732 140462046016960 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:30:37.502146 140462046016960 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:30:37.502412 140461161821952 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:30:37.502537 140461161821952 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:30:37.502717 140462046016960 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:30:37.502837 140462046016960 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:30:37.502917 140462046016960 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:30:37.503046 140461153429248 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:30:37.503134 140461153429248 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:30:37.503274 140462046016960 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:30:37.503385 140462046016960 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.04808128.
I0405 02:30:37.684786 140462046016960 estimator.py:359] Loss for final step: 0.04808128.
INFO:tensorflow:training_loop marked as finished
I0405 02:30:37.685616 140462046016960 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:30:38.647671 140462046016960 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:30:39.932610 140462046016960 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:30:40.190247 140462046016960 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:30:40Z
I0405 02:30:40.207556 140462046016960 evaluation.py:257] Starting evaluation at 2019-04-05T02:30:40Z
INFO:tensorflow:TPU job name worker
I0405 02:30:40.207868 140462046016960 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:30:40.300523 140462046016960 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:30:40.301361 140462046016960 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:30:40.473079 140462046016960 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:30:43.315874 140462046016960 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:30:43.341018 140462046016960 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:30:43.399086 140462046016960 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 02:31:55.582447 140462046016960 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:31:55.583444 140461144536832 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:31:55.583939 140460798506752 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:31:55.637031 140462046016960 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:31:55.662662 140462046016960 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:31:55.663106 140462046016960 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:31:56.901413 140462046016960 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:31:56.901998 140462046016960 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:31:56.902115 140462046016960 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:31:56.902321 140461144536832 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:31:56.902533 140461144536832 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:31:56.902720 140462046016960 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:31:56.902841 140462046016960 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:31:56.902906 140462046016960 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:31:56.903044 140460798506752 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:31:56.903208 140460798506752 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:31:56.903351 140462046016960 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:31:56.903470 140462046016960 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:31:56
I0405 02:31:56.995842 140462046016960 evaluation.py:277] Finished evaluation at 2019-04-05-02:31:56
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9869, global_step = 35, loss = 0.041699767
I0405 02:31:56.996293 140462046016960 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9869, global_step = 35, loss = 0.041699767
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:32:00.747822 140462046016960 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:32:01.442343 140462046016960 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.041699767, 'global_step': 35, 'accuracy': 0.9869}

warmup 11, weight decay 0.001
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554431326074983...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554431434101102...
Removing gs://bert-pretrain-data/mnist_log3/#1554431430022519...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554431321.yangyouucb#1554431437276573...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554431332455601...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554431333097028...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554431336888626...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554431431592375...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554431432278300...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554431436134492...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554431518354980...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554431518.yangyouucb#1554431521212789...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:32:04.839325 139841015580096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:32:04.967515 139841015580096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2f29659690>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2f2beb8b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:32:05.103897 139841015580096 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2f29659690>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2f2beb8b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:32:05.104413 139841015580096 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:32:05.434227 139841015580096 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:32:05.437187: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:32:05.451968 139841015580096 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:32:05.452244 139841015580096 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:32:05.452589 139841015580096 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:32:05.452656 139841015580096 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:32:05.452723 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:32:05.452936 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:32:05.453006 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:32:05.453071 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:32:05.453131 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:32:05.453191 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:32:05.453250 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:32:05.453309 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:32:05.453408 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:32:05.453471 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:32:05.453581 139841015580096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:32:05.457952 139841015580096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:32:05.470352 139841015580096 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:32:06.926778 139841015580096 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:32:06.994323 139841015580096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:32:07.187627 139841015580096 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:32:07.272692 139841015580096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:32:07.300214 139841015580096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:32:07.305597 139841015580096 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.479361 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.528228 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.580924 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.628484 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.680428 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.730585 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.784975 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:32:07.832886 139841015580096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:32:07.860410 139841015580096 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:32:07.879251 139841015580096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:32:11.113656 139841015580096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:32:11.231791 139841015580096 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:32:11.965281 139841015580096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:32:12.015678 139841015580096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:32:14.700124 139841015580096 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:32:24.935606 139841015580096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:32:24.936346 139841015580096 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:32:24.936765: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:32:24.944065 139841015580096 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:32:24.963176 139841015580096 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:32:24.975836 139841015580096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:33:39.618498 139841015580096 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:33:39.619821 139839994468096 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:33:39.620625 139839986075392 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:33:39.686783 139841015580096 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:33:39.687567 139841015580096 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.063151546, step = 35
I0405 02:33:53.058248 139841015580096 basic_session_run_hooks.py:249] loss = 0.063151546, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:33:53.060734 139841015580096 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:34:04.727268 139841015580096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:34:04.727616 139841015580096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:34:04.727943 139839994468096 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:34:04.728293 139839994468096 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:34:04.728559 139841015580096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:34:04.728768 139841015580096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:34:04.728833 139841015580096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:34:04.729038 139839986075392 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:34:04.729269 139839986075392 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:34:04.729581 139841015580096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:34:04.729800 139841015580096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.063151546.
I0405 02:34:04.911983 139841015580096 estimator.py:359] Loss for final step: 0.063151546.
INFO:tensorflow:training_loop marked as finished
I0405 02:34:04.912669 139841015580096 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:34:05.854573 139841015580096 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:34:07.132308 139841015580096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:34:07.378130 139841015580096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:34:07Z
I0405 02:34:07.395100 139841015580096 evaluation.py:257] Starting evaluation at 2019-04-05T02:34:07Z
INFO:tensorflow:TPU job name worker
I0405 02:34:07.395456 139841015580096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:34:07.484734 139841015580096 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:34:07.485692 139841015580096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:34:07.659200 139841015580096 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:34:10.983725 139841015580096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:34:11.011301 139841015580096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:34:11.059170 139841015580096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 02:35:23.581970 139841015580096 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:35:23.583036 139839773079296 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:35:23.583913 139839764686592 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:35:23.636878 139841015580096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:35:23.662653 139841015580096 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:35:23.663058 139841015580096 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:35:24.850441 139841015580096 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:35:24.850917 139841015580096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:35:24.851015 139841015580096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:35:24.851191 139839773079296 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:35:24.851368 139839773079296 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:35:24.851540 139841015580096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:35:24.851653 139841015580096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:35:24.851710 139841015580096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:35:24.851828 139839764686592 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:35:24.852019 139839764686592 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:35:24.852154 139841015580096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:35:24.852250 139841015580096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:35:24
I0405 02:35:24.950069 139841015580096 evaluation.py:277] Finished evaluation at 2019-04-05-02:35:24
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.982, global_step = 35, loss = 0.061130255
I0405 02:35:24.950459 139841015580096 estimator.py:1979] Saving dict for global step 35: accuracy = 0.982, global_step = 35, loss = 0.061130255
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:35:28.736659 139841015580096 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:35:29.478342 139841015580096 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.061130255, 'global_step': 35, 'accuracy': 0.982}

warmup 11, weight decay 0.002
Removing gs://bert-pretrain-data/mnist_log3/#1554431637634035...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554431641705449...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554431529.yangyouucb#1554431644507150...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554431540902370...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554431534268762...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554431544479973...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554431639184448...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554431540286527...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554431639893644...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554431643798510...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554431726367318...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554431726.yangyouucb#1554431729245476...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:35:32.953125 139697666782656 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:35:33.073642 139697666782656 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0dc9248690>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0dcbaa7b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:35:33.196825 139697666782656 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0dc9248690>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0dcbaa7b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:35:33.197428 139697666782656 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:35:33.505286 139697666782656 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:35:33.508820: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:35:33.523186 139697666782656 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:35:33.523498 139697666782656 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:35:33.523876 139697666782656 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:35:33.523957 139697666782656 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:35:33.524022 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:35:33.524230 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:35:33.524298 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:35:33.524379 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:35:33.524456 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:35:33.524518 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:35:33.524614 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:35:33.524677 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:35:33.524738 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:35:33.524797 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:35:33.524864 139697666782656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:35:33.529658 139697666782656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:35:33.543040 139697666782656 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:35:35.004987 139697666782656 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:35:35.072884 139697666782656 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:35:35.274436 139697666782656 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:35:35.359595 139697666782656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:35:35.386394 139697666782656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:35:35.391567 139697666782656 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.555845 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.600703 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.650065 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.694869 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.744172 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.790987 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.842406 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:35:35.886821 139697666782656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:35:35.912458 139697666782656 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:35:35.930075 139697666782656 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:35:39.188663 139697666782656 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:35:39.311338 139697666782656 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:35:40.003727 139697666782656 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:35:40.052978 139697666782656 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:35:42.419548 139697666782656 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:35:54.150600 139697666782656 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:35:54.151365 139697666782656 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:35:54.151839: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:35:54.158442 139697666782656 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:35:54.176336 139697666782656 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:35:54.188857 139697666782656 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:37:07.564956 139697666782656 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:37:07.566590 139696641541888 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:37:07.567486 139696428545792 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:37:07.633313 139697666782656 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:37:07.634037 139697666782656 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.055894896, step = 35
I0405 02:37:20.215632 139697666782656 basic_session_run_hooks.py:249] loss = 0.055894896, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:37:20.218039 139697666782656 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:37:32.042998 139697666782656 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:37:32.043363 139697666782656 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:37:32.043647 139696641541888 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:37:32.043775 139696641541888 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:37:32.043958 139697666782656 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:37:32.044085 139697666782656 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:37:32.044146 139697666782656 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:37:32.044270 139696428545792 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:37:32.044367 139696428545792 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:37:32.044519 139697666782656 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:37:32.044611 139697666782656 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.055894896.
I0405 02:37:32.227715 139697666782656 estimator.py:359] Loss for final step: 0.055894896.
INFO:tensorflow:training_loop marked as finished
I0405 02:37:32.228435 139697666782656 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:37:33.138046 139697666782656 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:37:34.726207 139697666782656 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:37:34.952943 139697666782656 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:37:34Z
I0405 02:37:34.968080 139697666782656 evaluation.py:257] Starting evaluation at 2019-04-05T02:37:34Z
INFO:tensorflow:TPU job name worker
I0405 02:37:34.968374 139697666782656 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:37:35.050420 139697666782656 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:37:35.051158 139697666782656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:37:35.245954 139697666782656 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:37:38.080640 139697666782656 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:37:38.112390 139697666782656 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:37:38.164244 139697666782656 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:38:51.565762 139697666782656 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:38:51.566637 139696420153088 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:38:51.567173 139696411760384 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:38:51.619110 139697666782656 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:38:51.639856 139697666782656 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:38:51.640242 139697666782656 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:38:52.834635 139697666782656 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:38:52.835016 139697666782656 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:38:52.835115 139697666782656 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:38:52.835372 139696420153088 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:38:52.835575 139696420153088 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:38:52.835755 139697666782656 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:38:52.835875 139697666782656 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:38:52.835937 139697666782656 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:38:52.836064 139696411760384 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:38:52.836174 139696411760384 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:38:52.836312 139697666782656 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:38:52.836421 139697666782656 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:38:52
I0405 02:38:52.926701 139697666782656 evaluation.py:277] Finished evaluation at 2019-04-05-02:38:52
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9879, global_step = 35, loss = 0.03895092
I0405 02:38:52.927095 139697666782656 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9879, global_step = 35, loss = 0.03895092
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:38:56.668467 139697666782656 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:38:57.428705 139697666782656 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.03895092, 'global_step': 35, 'accuracy': 0.9879}

warmup 11, weight decay 0.004
Removing gs://bert-pretrain-data/mnist_log3/#1554431845121882...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554431849147970...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554431737.yangyouucb#1554431851815285...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554431749806571...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554431753670754...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554431741973249...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554431749112050...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554431847337175...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554431846649985...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554431851060798...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554431934336375...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554431934.yangyouucb#1554431937197673...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:39:00.938061 140105906685376 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:39:01.058556 140105906685376 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f6cd6231e90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f6cd8a90b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:39:01.181596 140105906685376 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f6cd6231e90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f6cd8a90b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:39:01.182106 140105906685376 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:39:01.514978 140105906685376 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:39:01.518000: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:39:01.531351 140105906685376 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:39:01.531698 140105906685376 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:39:01.532051 140105906685376 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:39:01.532124 140105906685376 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:39:01.532187 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:39:01.532426 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:39:01.532500 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:39:01.532566 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:39:01.532627 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:39:01.532685 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:39:01.532743 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:39:01.532802 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:39:01.532866 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:39:01.532924 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:39:01.532983 140105906685376 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:39:01.537306 140105906685376 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:39:01.550065 140105906685376 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:39:03.066046 140105906685376 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:39:03.133274 140105906685376 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:39:03.326339 140105906685376 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:39:03.409024 140105906685376 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:39:03.436768 140105906685376 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:39:03.442017 140105906685376 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.606971 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.654495 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.704703 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.750008 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.799736 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.848908 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.900904 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:39:03.945439 140105906685376 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:39:03.973895 140105906685376 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:39:03.992202 140105906685376 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:39:07.302412 140105906685376 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:39:07.420066 140105906685376 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:39:08.145214 140105906685376 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:39:08.200270 140105906685376 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:39:10.849071 140105906685376 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:39:21.604095 140105906685376 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:39:21.604898 140105906685376 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:39:21.605293: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:39:21.612608 140105906685376 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:39:21.630948 140105906685376 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:39:21.642807 140105906685376 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:40:35.564455 140105906685376 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:40:35.565624 140105020847872 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:40:35.566142 140105012455168 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:40:35.633265 140105906685376 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:40:35.634402 140105906685376 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.06764234, step = 35
I0405 02:40:47.914266 140105906685376 basic_session_run_hooks.py:249] loss = 0.06764234, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:40:47.916627 140105906685376 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:40:59.737953 140105906685376 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:40:59.738292 140105906685376 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:40:59.738527 140105020847872 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:40:59.738682 140105020847872 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:40:59.738851 140105906685376 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:40:59.738982 140105906685376 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:40:59.739042 140105906685376 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:40:59.739170 140105012455168 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:40:59.739259 140105012455168 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:40:59.739411 140105906685376 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:40:59.739509 140105906685376 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.06764234.
I0405 02:40:59.924103 140105906685376 estimator.py:359] Loss for final step: 0.06764234.
INFO:tensorflow:training_loop marked as finished
I0405 02:40:59.924874 140105906685376 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:41:00.832288 140105906685376 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:41:02.103136 140105906685376 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:41:02.367347 140105906685376 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:41:02Z
I0405 02:41:02.385667 140105906685376 evaluation.py:257] Starting evaluation at 2019-04-05T02:41:02Z
INFO:tensorflow:TPU job name worker
I0405 02:41:02.385982 140105906685376 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:41:02.483428 140105906685376 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:41:02.484288 140105906685376 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:41:02.663922 140105906685376 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:41:05.511497 140105906685376 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:41:05.542571 140105906685376 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:41:05.591634 140105906685376 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:42:19.550267 140105906685376 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:42:19.551249 140105004611328 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:42:19.552162 140104996218624 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:42:19.604134 140105906685376 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:42:19.630798 140105906685376 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:42:19.631222 140105906685376 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:42:20.730071 140105906685376 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:42:20.730535 140105906685376 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:42:20.730648 140105906685376 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:42:20.730945 140105004611328 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:42:20.731161 140105004611328 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:42:20.731405 140105906685376 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:42:20.731543 140105906685376 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:42:20.731607 140105906685376 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:42:20.731769 140104996218624 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:42:20.731873 140104996218624 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:42:20.732006 140105906685376 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:42:20.732109 140105906685376 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:42:20
I0405 02:42:20.830409 140105906685376 evaluation.py:277] Finished evaluation at 2019-04-05-02:42:20
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9829, global_step = 35, loss = 0.049342316
I0405 02:42:20.830799 140105906685376 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9829, global_step = 35, loss = 0.049342316
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:42:24.635667 140105906685376 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:42:25.425796 140105906685376 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.049342316, 'global_step': 35, 'accuracy': 0.9829}

warmup 11, weight decay 0.008
Removing gs://bert-pretrain-data/mnist_log3/#1554432052712376...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554431945.yangyouucb#1554432059494633...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554432056901435...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554431957335640...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554431950421481...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554431956590977...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554431961129876...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554432054307549...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554432055043337...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554432058683611...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554432142280287...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554432142.yangyouucb#1554432145198308...
/ [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:42:28.894881 139680653297088 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:42:29.023451 139680653297088 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f09d30f5ed0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f09d5954b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:42:29.197837 139680653297088 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f09d30f5ed0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f09d5954b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:42:29.198371 139680653297088 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:42:29.542794 139680653297088 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:42:29.545834: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:42:29.559509 139680653297088 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:42:29.559801 139680653297088 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:42:29.560143 139680653297088 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:42:29.560211 139680653297088 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:42:29.560276 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:42:29.560493 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:42:29.560564 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:42:29.560628 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:42:29.560703 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:42:29.560764 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:42:29.560823 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:42:29.560884 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:42:29.560944 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:42:29.561002 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:42:29.561058 139680653297088 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:42:29.565402 139680653297088 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:42:29.577881 139680653297088 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:42:31.741688 139680653297088 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:42:31.807889 139680653297088 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:42:32.015101 139680653297088 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:42:32.101641 139680653297088 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:42:32.128288 139680653297088 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:42:32.133467 139680653297088 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.306691 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.353120 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.403361 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.448853 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.499005 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.546616 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.597737 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:42:32.641812 139680653297088 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:42:32.667639 139680653297088 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:42:32.685345 139680653297088 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:42:35.850270 139680653297088 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:42:35.968195 139680653297088 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:42:36.691632 139680653297088 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:42:36.764991 139680653297088 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:42:39.107753 139680653297088 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:42:51.900800 139680653297088 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:42:51.901611 139680653297088 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:42:51.902021: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:42:51.908166 139680653297088 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:42:51.926363 139680653297088 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:42:51.938574 139680653297088 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 71 seconds
I0405 02:44:03.505521 139680653297088 tpu_estimator.py:510] Initialized TPU in 71 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:44:03.506634 139679693260544 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:44:03.507133 139679684867840 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:44:03.578186 139680653297088 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:44:03.578933 139680653297088 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.05356756, step = 35
I0405 02:44:15.279030 139680653297088 basic_session_run_hooks.py:249] loss = 0.05356756, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:44:15.281006 139680653297088 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:44:27.754884 139680653297088 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:44:27.755270 139680653297088 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:44:27.755748 139679693260544 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:44:27.756125 139679693260544 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:44:27.756457 139680653297088 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:44:27.756736 139680653297088 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:44:27.756855 139680653297088 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:44:27.757035 139679684867840 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:44:27.757241 139679684867840 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:44:27.757414 139680653297088 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:44:27.757601 139680653297088 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.05356756.
I0405 02:44:27.931443 139680653297088 estimator.py:359] Loss for final step: 0.05356756.
INFO:tensorflow:training_loop marked as finished
I0405 02:44:27.932356 139680653297088 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:44:28.855501 139680653297088 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:44:30.115046 139680653297088 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:44:30.352061 139680653297088 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:44:30Z
I0405 02:44:30.368207 139680653297088 evaluation.py:257] Starting evaluation at 2019-04-05T02:44:30Z
INFO:tensorflow:TPU job name worker
I0405 02:44:30.368522 139680653297088 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:44:30.463277 139680653297088 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:44:30.464051 139680653297088 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:44:30.646485 139680653297088 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:44:33.048100 139680653297088 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:44:33.077873 139680653297088 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:44:33.134483 139680653297088 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:45:47.538758 139680653297088 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:45:47.539797 139679676212992 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:45:47.540312 139679667820288 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:45:47.591387 139680653297088 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:45:47.612600 139680653297088 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:45:47.613032 139680653297088 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:45:48.715215 139680653297088 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:45:48.715614 139680653297088 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:45:48.715694 139680653297088 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:45:48.715904 139679676212992 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:45:48.716023 139679676212992 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:45:48.716217 139680653297088 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:45:48.716325 139680653297088 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:45:48.716408 139680653297088 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:45:48.716537 139679667820288 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:45:48.716622 139679667820288 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:45:48.716742 139680653297088 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:45:48.716840 139680653297088 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:45:48
I0405 02:45:48.821930 139680653297088 evaluation.py:277] Finished evaluation at 2019-04-05-02:45:48
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9861, global_step = 35, loss = 0.040681686
I0405 02:45:48.824019 139680653297088 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9861, global_step = 35, loss = 0.040681686
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:45:52.789256 139680653297088 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:45:53.546066 139680653297088 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.040681686, 'global_step': 35, 'accuracy': 0.9861}

warmup 11, weight decay 0.0001
Removing gs://bert-pretrain-data/mnist_log3/#1554432260611534...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554432264790983...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554432154.yangyouucb#1554432267516972...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554432158712952...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554432166719923...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554432167431382...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554432262243542...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554432171414941...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554432262955066...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554432266751486...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554432350269687...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554432350.yangyouucb#1554432353318672...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:45:56.967724 140379211388352 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:45:57.118346 140379211388352 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fac78518650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fac7ae3db50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:45:57.227478 140379211388352 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fac78518650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fac7ae3db50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:45:57.228012 140379211388352 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:45:57.554749 140379211388352 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:45:57.557902: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:45:57.572740 140379211388352 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:45:57.573072 140379211388352 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:45:57.573453 140379211388352 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:45:57.573561 140379211388352 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:45:57.573626 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:45:57.573873 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:45:57.573944 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:45:57.574012 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:45:57.574085 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:45:57.574148 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:45:57.574209 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:45:57.574269 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:45:57.574327 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:45:57.574400 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:45:57.574476 140379211388352 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:45:57.579113 140379211388352 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:45:57.591447 140379211388352 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:45:59.496193 140379211388352 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:45:59.568964 140379211388352 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:45:59.760184 140379211388352 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:45:59.845835 140379211388352 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:45:59.872977 140379211388352 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:45:59.878278 140379211388352 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.045768 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.092116 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.143054 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.189773 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.240047 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.288153 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.340245 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:46:00.388451 140379211388352 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:46:00.414871 140379211388352 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:46:00.433820 140379211388352 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:46:03.671319 140379211388352 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:46:03.794955 140379211388352 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:46:04.517004 140379211388352 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:46:04.587327 140379211388352 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:46:07.175254 140379211388352 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:46:19.090465 140379211388352 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:46:19.091207 140379211388352 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:46:19.091681: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:46:19.099690 140379211388352 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:46:19.120774 140379211388352 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:46:19.140017 140379211388352 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 02:47:31.570396 140379211388352 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:47:31.571572 140378120386304 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:47:31.572175 140378111993600 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:47:31.638362 140379211388352 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:47:31.639148 140379211388352 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.0544038, step = 35
I0405 02:47:43.997006 140379211388352 basic_session_run_hooks.py:249] loss = 0.0544038, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:47:43.999911 140379211388352 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:47:57.229329 140379211388352 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:47:57.231092 140379211388352 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:47:57.231472 140378120386304 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:47:57.231616 140378120386304 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:47:57.231908 140379211388352 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:47:57.232039 140379211388352 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:47:57.232136 140379211388352 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:47:57.232274 140378111993600 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:47:57.232389 140378111993600 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:47:57.232526 140379211388352 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:47:57.232633 140379211388352 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.0544038.
I0405 02:47:57.416237 140379211388352 estimator.py:359] Loss for final step: 0.0544038.
INFO:tensorflow:training_loop marked as finished
I0405 02:47:57.416973 140379211388352 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:47:58.227468 140379211388352 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:47:59.488739 140379211388352 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:47:59.731491 140379211388352 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:47:59Z
I0405 02:47:59.747513 140379211388352 evaluation.py:257] Starting evaluation at 2019-04-05T02:47:59Z
INFO:tensorflow:TPU job name worker
I0405 02:47:59.747796 140379211388352 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:47:59.834662 140379211388352 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:47:59.835474 140379211388352 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:48:00.005618 140379211388352 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:48:02.612117 140379211388352 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:48:02.641966 140379211388352 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:48:02.694638 140379211388352 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 02:49:15.538309 140379211388352 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:49:15.539547 140378103600896 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:49:15.540363 140378095208192 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:49:15.596529 140379211388352 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:49:15.622968 140379211388352 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:49:15.623891 140379211388352 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:49:16.822699 140379211388352 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:49:16.823100 140379211388352 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:49:16.823201 140379211388352 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:49:16.823506 140378103600896 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:49:16.823843 140378103600896 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:49:16.824079 140379211388352 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:49:16.824280 140379211388352 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:49:16.824352 140379211388352 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:49:16.824563 140378095208192 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:49:16.824780 140378095208192 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:49:16.824968 140379211388352 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:49:16.825113 140379211388352 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:49:16
I0405 02:49:16.917448 140379211388352 evaluation.py:277] Finished evaluation at 2019-04-05-02:49:16
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9857, global_step = 35, loss = 0.054581385
I0405 02:49:16.917901 140379211388352 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9857, global_step = 35, loss = 0.054581385
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:49:20.536504 140379211388352 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:49:21.254111 140379211388352 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.054581385, 'global_step': 35, 'accuracy': 0.9857}

warmup 11, weight decay 0.0002
Removing gs://bert-pretrain-data/mnist_log3/#1554432469516732...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554432374853790...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554432378617450...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554432473523329...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554432362.yangyouucb#1554432476980524...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554432470959678...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554432366675554...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554432374227448...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554432471664214...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554432475557187...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554432558297345...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554432558.yangyouucb#1554432561024647...
/ [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:49:24.846657 140093412173248 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:49:24.968054 140093412173248 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f69ed5b9650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f69efedeb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:49:25.086349 140093412173248 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f69ed5b9650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f69efedeb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:49:25.086894 140093412173248 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:49:25.408715 140093412173248 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:49:25.411724: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:49:25.425756 140093412173248 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:49:25.426069 140093412173248 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:49:25.426444 140093412173248 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:49:25.426516 140093412173248 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:49:25.426578 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:49:25.426780 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:49:25.426850 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:49:25.426934 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:49:25.426995 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:49:25.427054 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:49:25.427122 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:49:25.427182 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:49:25.427246 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:49:25.427313 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:49:25.427386 140093412173248 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:49:25.432153 140093412173248 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:49:25.445384 140093412173248 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:49:26.892595 140093412173248 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:49:26.985764 140093412173248 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:49:27.176590 140093412173248 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:49:27.262814 140093412173248 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:49:27.291048 140093412173248 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:49:27.296355 140093412173248 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.474309 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.523701 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.576993 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.625464 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.678975 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.729744 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.784434 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:49:27.830828 140093412173248 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:49:27.857721 140093412173248 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:49:27.876270 140093412173248 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:49:31.058985 140093412173248 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:49:31.183048 140093412173248 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:49:31.888931 140093412173248 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:49:31.941607 140093412173248 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:49:34.226752 140093412173248 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:49:44.806226 140093412173248 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:49:44.807099 140093412173248 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:49:44.807554: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:49:44.813993 140093412173248 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:49:44.832509 140093412173248 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:49:44.844849 140093412173248 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:50:59.579657 140093412173248 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:50:59.580651 140092382512896 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:50:59.581237 140092169516800 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:50:59.647294 140093412173248 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:50:59.648020 140093412173248 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.050161686, step = 35
I0405 02:51:11.408509 140093412173248 basic_session_run_hooks.py:249] loss = 0.050161686, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:51:11.411004 140093412173248 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:51:23.388086 140093412173248 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:51:23.388516 140093412173248 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:51:23.388768 140092382512896 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:51:23.388895 140092382512896 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:51:23.389090 140093412173248 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:51:23.389225 140093412173248 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:51:23.389288 140093412173248 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:51:23.389461 140092169516800 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:51:23.389619 140092169516800 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:51:23.389761 140093412173248 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:51:23.389878 140093412173248 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.050161686.
I0405 02:51:23.561876 140093412173248 estimator.py:359] Loss for final step: 0.050161686.
INFO:tensorflow:training_loop marked as finished
I0405 02:51:23.562556 140093412173248 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:51:24.498564 140093412173248 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:51:25.776550 140093412173248 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:51:26.027127 140093412173248 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:51:26Z
I0405 02:51:26.044178 140093412173248 evaluation.py:257] Starting evaluation at 2019-04-05T02:51:26Z
INFO:tensorflow:TPU job name worker
I0405 02:51:26.044573 140093412173248 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:51:26.140625 140093412173248 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:51:26.141525 140093412173248 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:51:26.315695 140093412173248 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:51:28.963493 140093412173248 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:51:28.993999 140093412173248 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:51:29.046827 140093412173248 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:52:43.519403 140093412173248 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:52:43.520354 140092169516800 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:52:43.520931 140092161124096 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:52:43.592541 140093412173248 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:52:43.616444 140093412173248 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:52:43.616847 140093412173248 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:52:44.776695 140093412173248 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:52:44.777137 140093412173248 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:52:44.777229 140093412173248 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:52:44.777456 140092169516800 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:52:44.778110 140092169516800 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:52:44.778356 140093412173248 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:52:44.778513 140093412173248 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:52:44.778574 140093412173248 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:52:44.778716 140092161124096 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:52:44.778805 140092161124096 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:52:44.778954 140093412173248 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:52:44.779056 140093412173248 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:52:44
I0405 02:52:44.875767 140093412173248 evaluation.py:277] Finished evaluation at 2019-04-05-02:52:44
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9865, global_step = 35, loss = 0.033938494
I0405 02:52:44.876166 140093412173248 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9865, global_step = 35, loss = 0.033938494
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:52:48.527896 140093412173248 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:52:49.207731 140093412173248 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.033938494, 'global_step': 35, 'accuracy': 0.9865}

warmup 11, weight decay 0.0004
Removing gs://bert-pretrain-data/mnist_log3/#1554432676145200...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554432680146686...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554432580666138...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554432584326345...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554432569.yangyouucb#1554432683158713...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554432678321788...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554432573830851...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554432677700110...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554432579942302...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554432682442972...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554432766.yangyouucb#1554432768988607...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554432766261035...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:52:52.647244 140262655792576 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:52:52.763636 140262655792576 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9155104650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f9157a29b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:52:52.862310 140262655792576 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9155104650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f9157a29b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:52:52.862865 140262655792576 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:52:53.202081 140262655792576 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:52:53.204909: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:52:53.218993 140262655792576 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:52:53.219286 140262655792576 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:52:53.219651 140262655792576 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:52:53.219719 140262655792576 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:52:53.219789 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:52:53.219995 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:52:53.220063 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:52:53.220127 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:52:53.220187 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:52:53.220247 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:52:53.220304 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:52:53.220364 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:52:53.220455 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:52:53.220515 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:52:53.220572 140262655792576 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:52:53.225248 140262655792576 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:52:53.238116 140262655792576 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:52:54.770917 140262655792576 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:52:54.836621 140262655792576 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:52:55.014197 140262655792576 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:52:55.096038 140262655792576 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:52:55.122806 140262655792576 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:52:55.127963 140262655792576 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.293442 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.340046 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.390907 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.439496 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.491411 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.539858 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.591943 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:52:55.637073 140262655792576 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:52:55.662978 140262655792576 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:52:55.680655 140262655792576 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:52:58.992753 140262655792576 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:52:59.106343 140262655792576 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:52:59.812071 140262655792576 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:52:59.871741 140262655792576 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:53:02.473056 140262655792576 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:53:13.372451 140262655792576 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:53:13.373220 140262655792576 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:53:13.373668: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:53:13.380983 140262655792576 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:53:13.399135 140262655792576 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:53:13.411468 140262655792576 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 02:54:27.594870 140262655792576 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:54:27.596029 140261628970752 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:54:27.596596 140261418071808 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:54:27.664522 140262655792576 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:54:27.665261 140262655792576 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.04935942, step = 35
I0405 02:54:39.935214 140262655792576 basic_session_run_hooks.py:249] loss = 0.04935942, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:54:39.937669 140262655792576 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:54:52.258899 140262655792576 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:54:52.259354 140262655792576 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:54:52.259764 140261628970752 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:54:52.260145 140261628970752 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:54:52.260415 140262655792576 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:54:52.260704 140262655792576 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:54:52.260771 140262655792576 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:54:52.261023 140261418071808 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:54:52.261253 140261418071808 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:54:52.261550 140262655792576 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:54:52.261765 140262655792576 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.04935942.
I0405 02:54:52.439824 140262655792576 estimator.py:359] Loss for final step: 0.04935942.
INFO:tensorflow:training_loop marked as finished
I0405 02:54:52.440563 140262655792576 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:54:53.373358 140262655792576 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:54:54.614896 140262655792576 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:54:54.854407 140262655792576 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:54:54Z
I0405 02:54:54.869632 140262655792576 evaluation.py:257] Starting evaluation at 2019-04-05T02:54:54Z
INFO:tensorflow:TPU job name worker
I0405 02:54:54.869935 140262655792576 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:54:54.952400 140262655792576 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:54:54.953198 140262655792576 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:54:55.142252 140262655792576 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:54:57.816539 140262655792576 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:54:57.841393 140262655792576 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:54:57.887991 140262655792576 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:56:11.553076 140262655792576 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:56:11.554347 140261418071808 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:56:11.555238 140261409679104 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:56:11.615614 140262655792576 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:56:11.637692 140262655792576 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:56:11.638097 140262655792576 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:56:12.863106 140262655792576 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:56:12.863523 140262655792576 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:56:12.863621 140262655792576 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:56:12.863924 140261418071808 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:56:12.864248 140261418071808 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:56:12.864464 140262655792576 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:56:12.864658 140262655792576 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:56:12.864723 140262655792576 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:56:12.864881 140261409679104 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:56:12.865040 140261409679104 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:56:12.865190 140262655792576 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:56:12.865318 140262655792576 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:56:12
I0405 02:56:12.954245 140262655792576 evaluation.py:277] Finished evaluation at 2019-04-05-02:56:12
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9861, global_step = 35, loss = 0.04173733
I0405 02:56:12.954700 140262655792576 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9861, global_step = 35, loss = 0.04173733
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:56:16.828977 140262655792576 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:56:17.716288 140262655792576 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.04173733, 'global_step': 35, 'accuracy': 0.9861}

warmup 11, weight decay 0.0008
Removing gs://bert-pretrain-data/mnist_log3/#1554432884725390...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554432788975032...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554432888816506...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554432792893672...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554432777.yangyouucb#1554432892038207...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554432886311061...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554432886993262...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554432782054851...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554432788271481...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554432890926485...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554432974357268...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554432974.yangyouucb#1554432977492657...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:56:21.239590 139708552918464 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:56:21.362730 139708552918464 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f1051f56650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f105487bb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:56:21.492716 139708552918464 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f1051f56650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f105487bb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:56:21.493231 139708552918464 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:56:21.860475 139708552918464 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:56:21.863573: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:56:21.878143 139708552918464 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:56:21.878457 139708552918464 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:56:21.878796 139708552918464 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:56:21.878870 139708552918464 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:56:21.878932 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:56:21.879152 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:56:21.879221 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:56:21.879285 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:56:21.879343 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:56:21.879426 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:56:21.879484 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:56:21.879547 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:56:21.879605 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:56:21.879666 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:56:21.879724 139708552918464 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:56:21.884329 139708552918464 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:56:21.896872 139708552918464 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:56:23.327426 139708552918464 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:56:23.395059 139708552918464 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:56:23.590023 139708552918464 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:56:23.674607 139708552918464 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:56:23.701952 139708552918464 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:56:23.707144 139708552918464 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:23.878015 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:23.926635 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:23.979028 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:24.027714 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:24.080465 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:24.130897 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:24.186084 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:56:24.233144 139708552918464 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:56:24.261140 139708552918464 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:56:24.280185 139708552918464 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:56:27.504085 139708552918464 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:56:27.624515 139708552918464 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:56:28.303864 139708552918464 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:56:28.354377 139708552918464 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:56:30.910242 139708552918464 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:56:41.873773 139708552918464 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 02:56:41.874579 139708552918464 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 02:56:41.874990: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 02:56:41.881835 139708552918464 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 02:56:41.900528 139708552918464 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 02:56:41.913801 139708552918464 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:57:55.447745 139708552918464 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:57:55.449064 139707668739840 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:57:55.449825 139707660347136 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 02:57:55.516518 139708552918464 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 02:57:55.517250 139708552918464 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.054303654, step = 35
I0405 02:58:07.969281 139708552918464 basic_session_run_hooks.py:249] loss = 0.054303654, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:58:07.971816 139708552918464 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 02:58:20.889014 139708552918464 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:58:20.889347 139708552918464 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:58:20.889614 139707668739840 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:58:20.889722 139707668739840 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:58:20.889985 139708552918464 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:58:20.890094 139708552918464 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:58:20.890151 139708552918464 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:58:20.890463 139707660347136 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:58:20.890770 139707660347136 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:58:20.891632 139708552918464 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:58:20.892477 139708552918464 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.054303654.
I0405 02:58:21.081912 139708552918464 estimator.py:359] Loss for final step: 0.054303654.
INFO:tensorflow:training_loop marked as finished
I0405 02:58:21.082668 139708552918464 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 02:58:22.023096 139708552918464 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:58:23.359074 139708552918464 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 02:58:23.621997 139708552918464 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T02:58:23Z
I0405 02:58:23.639920 139708552918464 evaluation.py:257] Starting evaluation at 2019-04-05T02:58:23Z
INFO:tensorflow:TPU job name worker
I0405 02:58:23.640229 139708552918464 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:58:23.735141 139708552918464 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 02:58:23.735980 139708552918464 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:58:23.936582 139708552918464 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 02:58:26.441477 139708552918464 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:58:26.466619 139708552918464 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 02:58:26.515624 139708552918464 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 02:59:39.597944 139708552918464 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 02:59:39.598989 139707651454720 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 02:59:39.599409 139707300181760 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 02:59:39.657743 139708552918464 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 02:59:39.678538 139708552918464 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 02:59:39.678952 139708552918464 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 02:59:40.904359 139708552918464 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 02:59:40.904767 139708552918464 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 02:59:40.904894 139708552918464 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 02:59:40.905098 139707651454720 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 02:59:40.905213 139707651454720 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 02:59:40.905386 139708552918464 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 02:59:40.905525 139708552918464 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 02:59:40.905601 139708552918464 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 02:59:40.905730 139707300181760 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 02:59:40.905818 139707300181760 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 02:59:40.905945 139708552918464 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 02:59:40.906042 139708552918464 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-02:59:40
I0405 02:59:40.996126 139708552918464 evaluation.py:277] Finished evaluation at 2019-04-05-02:59:40
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9868, global_step = 35, loss = 0.03694177
I0405 02:59:40.996531 139708552918464 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9868, global_step = 35, loss = 0.03694177
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 02:59:45.295288 139708552918464 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 02:59:46.206988 139708552918464 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.03694177, 'global_step': 35, 'accuracy': 0.9868}

warmup 11, weight decay 0.00001
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554432997411768...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554433097939798...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554433001401327...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554433095246840...
Removing gs://bert-pretrain-data/mnist_log3/#1554433093669494...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554432985.yangyouucb#1554433100640779...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554432990505961...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554432996668151...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554433096035304...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554433099806161...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554433182421096...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554433182.yangyouucb#1554433185978611...
/ [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 02:59:49.699306 140647502046656 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 02:59:49.821229 140647502046656 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7feaefb01610>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7feaf2427b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 02:59:49.939585 140647502046656 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7feaefb01610>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7feaf2427b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 02:59:49.940135 140647502046656 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 02:59:50.265707 140647502046656 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 02:59:50.268626: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 02:59:50.282372 140647502046656 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 02:59:50.282723 140647502046656 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 02:59:50.283058 140647502046656 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 02:59:50.283139 140647502046656 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 02:59:50.283205 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 02:59:50.283412 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 02:59:50.283482 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 02:59:50.283545 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 02:59:50.283612 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 02:59:50.283674 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 02:59:50.283755 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 02:59:50.283816 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 02:59:50.283885 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 02:59:50.283941 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 02:59:50.284003 140647502046656 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 02:59:50.288424 140647502046656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 02:59:50.301100 140647502046656 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:59:51.797995 140647502046656 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 02:59:51.864218 140647502046656 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 02:59:52.043682 140647502046656 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 02:59:52.126127 140647502046656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 02:59:52.152945 140647502046656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 02:59:52.158179 140647502046656 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.329086 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.380892 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.434598 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.486581 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.539175 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.589399 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.643269 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 02:59:52.689661 140647502046656 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 02:59:52.716171 140647502046656 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 02:59:52.734523 140647502046656 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 02:59:55.893686 140647502046656 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 02:59:56.012257 140647502046656 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 02:59:56.707591 140647502046656 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 02:59:56.760716 140647502046656 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 02:59:59.249628 140647502046656 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:00:10.721029 140647502046656 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:00:10.721821 140647502046656 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:00:10.722284: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:00:10.728926 140647502046656 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:00:10.748270 140647502046656 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:00:10.765562 140647502046656 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:01:23.548381 140647502046656 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:01:23.549305 140646404839168 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:01:23.549729 140646396446464 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:01:23.627823 140647502046656 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:01:23.628556 140647502046656 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.050179437, step = 35
I0405 03:01:36.117194 140647502046656 basic_session_run_hooks.py:249] loss = 0.050179437, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:01:36.119437 140647502046656 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:01:48.044841 140647502046656 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:01:48.045167 140647502046656 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:01:48.045620 140646404839168 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:01:48.045975 140646404839168 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:01:48.046267 140647502046656 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:01:48.046576 140647502046656 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:01:48.046658 140647502046656 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:01:48.046897 140646396446464 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:01:48.047122 140646396446464 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:01:48.047343 140647502046656 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:01:48.047569 140647502046656 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.050179437.
I0405 03:01:48.227180 140647502046656 estimator.py:359] Loss for final step: 0.050179437.
INFO:tensorflow:training_loop marked as finished
I0405 03:01:48.227982 140647502046656 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:01:49.151819 140647502046656 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:01:50.425842 140647502046656 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:01:50.695126 140647502046656 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:01:50Z
I0405 03:01:50.713841 140647502046656 evaluation.py:257] Starting evaluation at 2019-04-05T03:01:50Z
INFO:tensorflow:TPU job name worker
I0405 03:01:50.714162 140647502046656 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:01:50.812726 140647502046656 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:01:50.813657 140647502046656 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:01:51.002027 140647502046656 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:01:53.750938 140647502046656 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:01:53.778552 140647502046656 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:01:53.825866 140647502046656 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:03:07.598222 140647502046656 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:03:07.599179 140646396995328 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:03:07.599509 140646388602624 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:03:07.659486 140647502046656 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:03:07.684518 140647502046656 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:03:07.684969 140647502046656 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:03:08.940160 140647502046656 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:03:08.940552 140647502046656 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:03:08.940635 140647502046656 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:03:08.940820 140646396995328 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:03:08.940923 140646396995328 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:03:08.941072 140647502046656 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:03:08.941191 140647502046656 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:03:08.941251 140647502046656 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:03:08.941381 140646388602624 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:03:08.941520 140646388602624 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:03:08.941662 140647502046656 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:03:08.941765 140647502046656 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:03:09
I0405 03:03:09.031611 140647502046656 evaluation.py:277] Finished evaluation at 2019-04-05-03:03:09
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9867, global_step = 35, loss = 0.031539626
I0405 03:03:09.031995 140647502046656 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9867, global_step = 35, loss = 0.031539626
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:03:13.016758 140647502046656 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:03:13.832317 140647502046656 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.031539626, 'global_step': 35, 'accuracy': 0.9867}

warmup 11, weight decay 0.00002
Removing gs://bert-pretrain-data/mnist_log3/#1554433300739786...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554433304881518...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554433194.yangyouucb#1554433307808800...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554433198846175...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554433206390755...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554433205728224...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554433210242383...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554433302396078...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554433303142614...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554433306761886...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554433390363988...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554433390.yangyouucb#1554433393606725...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:03:17.275728 139957459998144 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:03:17.521631 139957459998144 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f4a45f9ce90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f4a488c6b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:03:17.606834 139957459998144 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f4a45f9ce90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f4a488c6b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:03:17.607353 139957459998144 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:03:17.931190 139957459998144 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:03:17.934190: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:03:17.947668 139957459998144 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:03:17.947971 139957459998144 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:03:17.948342 139957459998144 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:03:17.948434 139957459998144 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:03:17.948508 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:03:17.948730 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:03:17.948808 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:03:17.948882 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:03:17.948951 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:03:17.949019 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:03:17.949089 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:03:17.949166 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:03:17.949233 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:03:17.949299 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:03:17.949381 139957459998144 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:03:17.954061 139957459998144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:03:17.966975 139957459998144 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:03:19.429656 139957459998144 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:03:19.496774 139957459998144 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:03:19.695020 139957459998144 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:03:19.780219 139957459998144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:03:19.806689 139957459998144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 03:03:19.812118 139957459998144 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:19.975323 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:20.021553 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:20.070936 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:20.115746 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:20.165436 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:20.212132 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:20.264893 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:03:20.310971 139957459998144 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:03:20.337431 139957459998144 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:03:20.355719 139957459998144 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:03:23.452220 139957459998144 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:03:23.568276 139957459998144 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:03:24.289437 139957459998144 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:03:24.341459 139957459998144 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:03:26.748112 139957459998144 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:03:37.337167 139957459998144 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:03:37.339757 139957459998144 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:03:37.340294: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:03:37.347021 139957459998144 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:03:37.365247 139957459998144 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:03:37.377814 139957459998144 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 03:04:51.548666 139957459998144 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:04:51.549941 139956575778560 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:04:51.550909 139956567385856 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:04:51.618616 139957459998144 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:04:51.619326 139957459998144 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.054062016, step = 35
I0405 03:05:03.204632 139957459998144 basic_session_run_hooks.py:249] loss = 0.054062016, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:05:03.207113 139957459998144 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:05:16.499054 139957459998144 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:05:16.499432 139957459998144 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:05:16.499722 139956575778560 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:05:16.499869 139956575778560 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:05:16.500055 139957459998144 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:05:16.500199 139957459998144 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:05:16.500272 139957459998144 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:05:16.500412 139956567385856 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:05:16.500503 139956567385856 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:05:16.500643 139957459998144 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:05:16.500731 139957459998144 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.054062016.
I0405 03:05:16.681468 139957459998144 estimator.py:359] Loss for final step: 0.054062016.
INFO:tensorflow:training_loop marked as finished
I0405 03:05:16.682219 139957459998144 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:05:17.538254 139957459998144 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:05:18.801729 139957459998144 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:05:19.043204 139957459998144 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:05:19Z
I0405 03:05:19.059820 139957459998144 evaluation.py:257] Starting evaluation at 2019-04-05T03:05:19Z
INFO:tensorflow:TPU job name worker
I0405 03:05:19.060117 139957459998144 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:05:19.150871 139957459998144 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:05:19.151706 139957459998144 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:05:19.338279 139957459998144 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:05:21.861418 139957459998144 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:05:21.891593 139957459998144 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:05:21.941402 139957459998144 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:06:35.569271 139957459998144 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:06:35.570398 139956558493440 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:06:35.570944 139956206958336 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:06:35.624809 139957459998144 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:06:35.650132 139957459998144 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:06:35.650543 139957459998144 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:06:36.986223 139957459998144 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:06:36.986651 139957459998144 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:06:36.986738 139957459998144 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:06:36.986943 139956558493440 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:06:36.987061 139956558493440 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:06:36.987206 139957459998144 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:06:36.987330 139957459998144 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:06:36.987410 139957459998144 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:06:36.987544 139956206958336 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:06:36.987627 139956206958336 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:06:36.987750 139957459998144 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:06:36.987848 139957459998144 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:06:37
I0405 03:06:37.079061 139957459998144 evaluation.py:277] Finished evaluation at 2019-04-05-03:06:37
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.04833204
I0405 03:06:37.079478 139957459998144 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.04833204
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:06:40.905874 139957459998144 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:06:41.702613 139957459998144 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.04833204, 'global_step': 35, 'accuracy': 0.9853}

warmup 11, weight decay 0.00004
Removing gs://bert-pretrain-data/mnist_log3/#1554433509093045...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554433513042210...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554433413144673...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554433401.yangyouucb#1554433516251237...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554433416862419...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554433510521172...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554433412531509...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554433406318248...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554433511229872...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554433515053722...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554433598503040...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554433598.yangyouucb#1554433601473807...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:06:45.195307 139770534667712 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:06:45.307777 139770534667712 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f1ec05bd610>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f1ec2ee3b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:06:45.448805 139770534667712 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f1ec05bd610>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f1ec2ee3b10>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:06:45.449347 139770534667712 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:06:45.777255 139770534667712 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:06:45.780482: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:06:45.793262 139770534667712 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:06:45.793600 139770534667712 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:06:45.793989 139770534667712 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:06:45.794058 139770534667712 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:06:45.794121 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:06:45.794317 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:06:45.794399 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:06:45.794467 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:06:45.794547 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:06:45.794608 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:06:45.794666 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:06:45.794723 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:06:45.794780 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:06:45.794843 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:06:45.794902 139770534667712 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:06:45.799377 139770534667712 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:06:45.811734 139770534667712 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:06:47.236584 139770534667712 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:06:47.304025 139770534667712 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:06:47.495335 139770534667712 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:06:47.575547 139770534667712 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:06:47.601548 139770534667712 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 03:06:47.606575 139770534667712 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:47.768047 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:47.814971 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:47.864794 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:47.910609 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:47.961357 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:48.008632 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:48.060440 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:06:48.105273 139770534667712 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:06:48.131356 139770534667712 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:06:48.150044 139770534667712 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:06:51.361378 139770534667712 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:06:51.482067 139770534667712 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:06:52.160075 139770534667712 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:06:52.208774 139770534667712 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:06:54.609266 139770534667712 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:07:05.553592 139770534667712 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:07:05.554342 139770534667712 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:07:05.554842: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:07:05.561893 139770534667712 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:07:05.580763 139770534667712 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:07:05.594007 139770534667712 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:08:19.563854 139770534667712 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:08:19.565385 139769434597120 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:08:19.566164 139769426204416 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:08:19.636198 139770534667712 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:08:19.636970 139770534667712 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.047658782, step = 35
I0405 03:08:31.977010 139770534667712 basic_session_run_hooks.py:249] loss = 0.047658782, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:08:31.980118 139770534667712 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:08:43.699398 139770534667712 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:08:43.699774 139770534667712 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:08:43.700018 139769434597120 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:08:43.700151 139769434597120 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:08:43.700330 139770534667712 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:08:43.700469 139770534667712 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:08:43.700540 139770534667712 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:08:43.700665 139769426204416 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:08:43.700767 139769426204416 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:08:43.700915 139770534667712 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:08:43.701011 139770534667712 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.047658782.
I0405 03:08:43.904464 139770534667712 estimator.py:359] Loss for final step: 0.047658782.
INFO:tensorflow:training_loop marked as finished
I0405 03:08:43.905138 139770534667712 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:08:44.709424 139770534667712 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:08:46.186220 139770534667712 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:08:46.428869 139770534667712 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:08:46Z
I0405 03:08:46.445683 139770534667712 evaluation.py:257] Starting evaluation at 2019-04-05T03:08:46Z
INFO:tensorflow:TPU job name worker
I0405 03:08:46.445993 139770534667712 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:08:46.532278 139770534667712 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:08:46.533101 139770534667712 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:08:46.720385 139770534667712 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:08:49.317918 139770534667712 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:08:49.343039 139770534667712 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:08:49.391597 139770534667712 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 03:10:03.557065 139770534667712 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:10:03.558119 139769426204416 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:10:03.558660 139769417811712 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:10:03.616925 139770534667712 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:10:03.640537 139770534667712 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:10:03.640995 139770534667712 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:10:04.880527 139770534667712 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:10:04.880959 139770534667712 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:10:04.881047 139770534667712 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:10:04.881254 139769426204416 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:10:04.881407 139769426204416 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:10:04.881593 139770534667712 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:10:04.881712 139770534667712 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:10:04.881771 139770534667712 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:10:04.881906 139769417811712 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:10:04.881994 139769417811712 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:10:04.882121 139770534667712 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:10:04.882214 139770534667712 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:10:04
I0405 03:10:04.981827 139770534667712 evaluation.py:277] Finished evaluation at 2019-04-05-03:10:04
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9872, global_step = 35, loss = 0.03478223
I0405 03:10:04.982208 139770534667712 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9872, global_step = 35, loss = 0.03478223
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:10:08.630672 139770534667712 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:10:09.400185 139770534667712 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.03478223, 'global_step': 35, 'accuracy': 0.9872}

warmup 11, weight decay 0.0
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554433621151826...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554433720578234...
Removing gs://bert-pretrain-data/mnist_log3/#1554433716657728...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554433625080952...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554433614192930...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554433609.yangyouucb#1554433723474832...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554433718126852...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554433620409072...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554433718792781...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554433722736816...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554433806344206...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554433806.yangyouucb#1554433809159954...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:10:13.033340 140319326922176 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:10:13.152903 140319326922176 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9e86ed1650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f9e897f6b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:10:13.282464 140319326922176 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9e86ed1650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f9e897f6b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:10:13.283018 140319326922176 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:10:13.608109 140319326922176 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:10:13.610986: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:10:13.625154 140319326922176 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:10:13.625430 140319326922176 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:10:13.625797 140319326922176 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:10:13.625880 140319326922176 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:10:13.625945 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:10:13.626140 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:10:13.626208 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:10:13.626272 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:10:13.626333 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:10:13.626416 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:10:13.626477 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:10:13.626535 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:10:13.626594 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:10:13.626667 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:10:13.626727 140319326922176 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:10:13.631009 140319326922176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:10:13.645086 140319326922176 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:10:15.069330 140319326922176 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:10:15.136883 140319326922176 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:10:15.321724 140319326922176 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:10:15.406553 140319326922176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:10:15.433743 140319326922176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0405 03:10:15.438903 140319326922176 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.603930 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.650141 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.697886 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.743268 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.792870 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.841471 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.890583 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:10:15.935638 140319326922176 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:10:15.961796 140319326922176 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:10:15.978231 140319326922176 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:10:19.193077 140319326922176 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:10:19.306551 140319326922176 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:10:20.002094 140319326922176 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:10:20.050261 140319326922176 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:10:22.627585 140319326922176 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:10:34.078671 140319326922176 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:10:34.079421 140319326922176 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:10:34.079822: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:10:34.086038 140319326922176 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:10:34.104173 140319326922176 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:10:34.117839 140319326922176 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:11:47.549803 140319326922176 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:11:47.550944 140318375925504 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:11:47.551479 140318367532800 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:11:47.617758 140319326922176 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:11:47.618488 140319326922176 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.051448442, step = 35
I0405 03:11:59.921411 140319326922176 basic_session_run_hooks.py:249] loss = 0.051448442, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:11:59.924038 140319326922176 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:12:12.033797 140319326922176 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:12:12.034140 140319326922176 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:12:12.034821 140318375925504 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:12:12.035172 140318375925504 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:12:12.035474 140319326922176 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:12:12.035748 140319326922176 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:12:12.035834 140319326922176 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:12:12.036209 140318367532800 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:12:12.036518 140318367532800 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:12:12.036748 140319326922176 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:12:12.036947 140319326922176 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.051448442.
I0405 03:12:12.217644 140319326922176 estimator.py:359] Loss for final step: 0.051448442.
INFO:tensorflow:training_loop marked as finished
I0405 03:12:12.218347 140319326922176 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:12:13.146179 140319326922176 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:12:14.422593 140319326922176 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:12:14.694952 140319326922176 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:12:14Z
I0405 03:12:14.724970 140319326922176 evaluation.py:257] Starting evaluation at 2019-04-05T03:12:14Z
INFO:tensorflow:TPU job name worker
I0405 03:12:14.725831 140319326922176 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:12:14.838161 140319326922176 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:12:14.839030 140319326922176 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:12:15.006582 140319326922176 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:12:17.842030 140319326922176 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:12:17.865823 140319326922176 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:12:17.914971 140319326922176 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:13:31.571360 140319326922176 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:13:31.572597 140318358378240 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:13:31.573590 140318349985536 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:13:31.626281 140319326922176 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:13:31.655745 140319326922176 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:13:31.656167 140319326922176 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:13:32.927979 140319326922176 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:13:32.928380 140319326922176 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:13:32.928500 140319326922176 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:13:32.928750 140318358378240 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:13:32.929059 140318358378240 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:13:32.929274 140319326922176 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:13:32.929524 140319326922176 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:13:32.929603 140319326922176 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:13:32.929766 140318349985536 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:13:32.929944 140318349985536 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:13:32.930155 140319326922176 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:13:32.930377 140319326922176 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:13:33
I0405 03:13:33.020153 140319326922176 evaluation.py:277] Finished evaluation at 2019-04-05-03:13:33
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.985, global_step = 35, loss = 0.04343199
I0405 03:13:33.020586 140319326922176 estimator.py:1979] Saving dict for global step 35: accuracy = 0.985, global_step = 35, loss = 0.04343199
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:13:36.803013 140319326922176 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:13:37.617465 140319326922176 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.04343199, 'global_step': 35, 'accuracy': 0.985}

warmup 12, weight decay 0.01
Removing gs://bert-pretrain-data/mnist_log3/#1554433924549089...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554433829907899...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554433928699928...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554433822216290...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554433817.yangyouucb#1554433931800985...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554433926918179...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554433833596281...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554433829195880...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554433926205668...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554433930699084...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554434014390493...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554434014.yangyouucb#1554434017389570...
/ [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:13:41.178617 140692847900096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:13:41.300626 140692847900096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff57e82e650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff581153b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:13:41.436829 140692847900096 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff57e82e650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff581153b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:13:41.437352 140692847900096 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:13:41.758586 140692847900096 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:13:41.764014: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:13:41.781074 140692847900096 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:13:41.781435 140692847900096 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:13:41.781868 140692847900096 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:13:41.781951 140692847900096 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:13:41.782022 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:13:41.782236 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:13:41.782326 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:13:41.782413 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:13:41.782496 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:13:41.782565 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:13:41.782635 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:13:41.782701 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:13:41.782768 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:13:41.782835 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:13:41.782900 140692847900096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:13:41.787481 140692847900096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:13:41.800302 140692847900096 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:13:43.200150 140692847900096 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:13:43.266645 140692847900096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:13:43.461236 140692847900096 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:13:43.546191 140692847900096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:13:43.576128 140692847900096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:13:43.581403 140692847900096 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:43.749526 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:43.795427 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:43.848232 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:43.894063 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:43.943814 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:43.990293 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:44.041086 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:13:44.085131 140692847900096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:13:44.110636 140692847900096 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:13:44.128213 140692847900096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:13:47.464766 140692847900096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:13:47.579814 140692847900096 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:13:48.262995 140692847900096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:13:48.317008 140692847900096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:13:50.887573 140692847900096 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:14:01.252511 140692847900096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:14:01.253277 140692847900096 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:14:01.253723: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:14:01.261106 140692847900096 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:14:01.281116 140692847900096 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:14:01.300107 140692847900096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 03:15:15.575716 140692847900096 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:15:15.576782 140691896256256 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:15:15.577409 140691887863552 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:15:15.646452 140692847900096 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:15:15.647170 140692847900096 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.050363444, step = 35
I0405 03:15:28.306785 140692847900096 basic_session_run_hooks.py:249] loss = 0.050363444, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:15:28.309809 140692847900096 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:15:40.324681 140692847900096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:15:40.325103 140692847900096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:15:40.325556 140691896256256 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:15:40.325903 140691896256256 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:15:40.326245 140692847900096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:15:40.326530 140692847900096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:15:40.326605 140692847900096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:15:40.326813 140691887863552 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:15:40.327013 140691887863552 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:15:40.327169 140692847900096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:15:40.327311 140692847900096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.050363444.
I0405 03:15:40.515134 140692847900096 estimator.py:359] Loss for final step: 0.050363444.
INFO:tensorflow:training_loop marked as finished
I0405 03:15:40.515851 140692847900096 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:15:41.357908 140692847900096 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:15:42.627378 140692847900096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:15:42.853399 140692847900096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:15:42Z
I0405 03:15:42.868557 140692847900096 evaluation.py:257] Starting evaluation at 2019-04-05T03:15:42Z
INFO:tensorflow:TPU job name worker
I0405 03:15:42.868856 140692847900096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:15:42.949938 140692847900096 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:15:42.950719 140692847900096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:15:43.114867 140692847900096 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:15:46.606395 140692847900096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:15:46.632606 140692847900096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:15:46.688446 140692847900096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:16:59.603039 140692847900096 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:16:59.604165 140691879233280 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:16:59.605290 140691870840576 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:16:59.659727 140692847900096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:16:59.704226 140692847900096 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:16:59.704649 140692847900096 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:17:00.902127 140692847900096 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:17:00.902524 140692847900096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:17:00.902615 140692847900096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:17:00.902905 140691879233280 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:17:00.903203 140691879233280 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:17:00.903419 140692847900096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:17:00.903650 140692847900096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:17:00.903719 140692847900096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:17:00.903918 140691870840576 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:17:00.904123 140691870840576 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:17:00.904294 140692847900096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:17:00.904442 140692847900096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:17:00
I0405 03:17:00.997065 140692847900096 evaluation.py:277] Finished evaluation at 2019-04-05-03:17:00
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9863, global_step = 35, loss = 0.047761574
I0405 03:17:00.997479 140692847900096 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9863, global_step = 35, loss = 0.047761574
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:17:04.979123 140692847900096 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:17:05.708744 140692847900096 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.047761574, 'global_step': 35, 'accuracy': 0.9863}

warmup 12, weight decay 0.02
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554434037119210...
Removing gs://bert-pretrain-data/mnist_log3/#1554434133023770...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554434137149269...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554434025.yangyouucb#1554434140096665...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554434030465500...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554434040778469...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554434036429179...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554434134549604...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554434135319131...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554434139056270...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554434222451450...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554434222.yangyouucb#1554434225473260...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:17:09.150679 140433532421568 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:17:09.261287 140433532421568 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fb91e1ab650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fb920ad0b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:17:09.355633 140433532421568 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fb91e1ab650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fb920ad0b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:17:09.356175 140433532421568 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:17:09.673944 140433532421568 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:17:09.676943: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:17:09.691584 140433532421568 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:17:09.691880 140433532421568 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:17:09.692224 140433532421568 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:17:09.692290 140433532421568 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:17:09.692414 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:17:09.692636 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:17:09.692707 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:17:09.692770 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:17:09.692862 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:17:09.692924 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:17:09.693001 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:17:09.693075 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:17:09.693135 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:17:09.693193 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:17:09.693252 140433532421568 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:17:09.697762 140433532421568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:17:09.710546 140433532421568 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:17:11.116136 140433532421568 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:17:11.179667 140433532421568 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:17:11.370507 140433532421568 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:17:11.455317 140433532421568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:17:11.483525 140433532421568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:17:11.489200 140433532421568 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:11.662308 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:11.710752 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:11.764405 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:11.812131 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:11.864463 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:11.913294 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:11.966253 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:17:12.012547 140433532421568 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:17:12.039011 140433532421568 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:17:12.057396 140433532421568 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:17:15.305723 140433532421568 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:17:15.424945 140433532421568 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:17:16.103720 140433532421568 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:17:16.171134 140433532421568 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:17:18.721059 140433532421568 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:17:29.503618 140433532421568 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:17:29.504417 140433532421568 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:17:29.504821: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:17:29.510982 140433532421568 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:17:29.528496 140433532421568 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:17:29.541836 140433532421568 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 03:18:43.559390 140433532421568 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:18:43.560897 140432646321920 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:18:43.561938 140432637929216 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:18:43.628603 140433532421568 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:18:43.629407 140433532421568 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.040207125, step = 35
I0405 03:18:57.191804 140433532421568 basic_session_run_hooks.py:249] loss = 0.040207125, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:18:57.194175 140433532421568 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:19:09.321692 140433532421568 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:19:09.322134 140433532421568 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:19:09.322671 140432646321920 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:19:09.325114 140432646321920 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:19:09.325618 140433532421568 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:19:09.325922 140433532421568 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:19:09.326847 140433532421568 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:19:09.327198 140432637929216 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:19:09.331271 140432637929216 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:19:09.331765 140433532421568 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:19:09.332015 140433532421568 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.040207125.
I0405 03:19:09.504189 140433532421568 estimator.py:359] Loss for final step: 0.040207125.
INFO:tensorflow:training_loop marked as finished
I0405 03:19:09.504931 140433532421568 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:19:10.422880 140433532421568 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:19:11.701419 140433532421568 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:19:11.939627 140433532421568 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:19:11Z
I0405 03:19:11.956068 140433532421568 evaluation.py:257] Starting evaluation at 2019-04-05T03:19:11Z
INFO:tensorflow:TPU job name worker
I0405 03:19:11.956424 140433532421568 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:19:12.044286 140433532421568 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:19:12.045144 140433532421568 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:19:12.215472 140433532421568 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:19:14.931323 140433532421568 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:19:14.960752 140433532421568 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:19:15.009222 140433532421568 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:20:27.592931 140433532421568 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:20:27.594053 140432638478080 tpu_estimator.py:463] Starting infeed thread controller.
I0405 03:20:27.594445 140432630085376 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:20:27.648169 140433532421568 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:20:27.673460 140433532421568 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:20:27.673882 140433532421568 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:20:28.722333 140433532421568 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:20:28.722759 140433532421568 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:20:28.722851 140433532421568 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:20:28.723066 140432638478080 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:20:28.723195 140432638478080 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:20:28.723345 140433532421568 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:20:28.723484 140433532421568 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:20:28.723543 140433532421568 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:20:28.723665 140432630085376 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:20:28.723750 140432630085376 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:20:28.723871 140433532421568 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:20:28.723968 140433532421568 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:20:28
I0405 03:20:28.826771 140433532421568 evaluation.py:277] Finished evaluation at 2019-04-05-03:20:28
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9869, global_step = 35, loss = 0.033125244
I0405 03:20:28.827150 140433532421568 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9869, global_step = 35, loss = 0.033125244
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:20:32.554879 140433532421568 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:20:33.454557 140433532421568 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.033125244, 'global_step': 35, 'accuracy': 0.9869}

warmup 12, weight decay 0.04
Removing gs://bert-pretrain-data/mnist_log3/#1554434341805025...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554434346080495...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554434249004540...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554434233.yangyouucb#1554434349099832...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554434245183961...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554434238308369...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554434343378861...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554434244456666...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554434344172024...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554434347999448...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554434430216901...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554434430.yangyouucb#1554434433159304...
/ [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:20:36.916219 140160096552384 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:20:37.034662 140160096552384 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f79740e7650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7976a0cb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:20:37.467127 140160096552384 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f79740e7650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7976a0cb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:20:37.467708 140160096552384 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:20:37.793565 140160096552384 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:20:37.796777: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:20:37.810585 140160096552384 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:20:37.810919 140160096552384 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:20:37.811252 140160096552384 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:20:37.811326 140160096552384 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:20:37.811424 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:20:37.811640 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:20:37.811717 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:20:37.811783 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:20:37.811844 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:20:37.811912 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:20:37.811973 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:20:37.812032 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:20:37.812092 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:20:37.812154 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:20:37.812212 140160096552384 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:20:37.816924 140160096552384 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:20:37.830157 140160096552384 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:20:40.194690 140160096552384 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:20:40.261744 140160096552384 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:20:40.448285 140160096552384 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:20:40.535351 140160096552384 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:20:40.562619 140160096552384 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:20:40.567823 140160096552384 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:40.736543 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:40.786549 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:40.838110 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:40.884850 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:40.936597 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:40.985394 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:41.038621 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:20:41.084888 140160096552384 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:20:41.111489 140160096552384 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:20:41.130240 140160096552384 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:20:44.361339 140160096552384 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:20:44.477740 140160096552384 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:20:45.184190 140160096552384 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:20:45.251316 140160096552384 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:20:47.706401 140160096552384 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:20:58.573457 140160096552384 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:20:58.575798 140160096552384 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:20:58.576410: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:20:58.582550 140160096552384 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:20:58.602231 140160096552384 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:20:58.615192 140160096552384 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:22:11.586313 140160096552384 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:22:11.590015 140159009945344 tpu_estimator.py:463] Starting infeed thread controller.
I0405 03:22:11.590457 140159001552640 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:22:11.656003 140160096552384 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:22:11.656723 140160096552384 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.061371144, step = 35
I0405 03:22:24.786700 140160096552384 basic_session_run_hooks.py:249] loss = 0.061371144, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:22:24.788966 140160096552384 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:22:36.602183 140160096552384 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:22:36.602570 140160096552384 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:22:36.602842 140159009945344 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:22:36.603009 140159009945344 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:22:36.603200 140160096552384 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:22:36.603332 140160096552384 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:22:36.603461 140160096552384 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:22:36.603631 140159001552640 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:22:36.603729 140159001552640 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:22:36.603895 140160096552384 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:22:36.604011 140160096552384 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.061371144.
I0405 03:22:36.792876 140160096552384 estimator.py:359] Loss for final step: 0.061371144.
INFO:tensorflow:training_loop marked as finished
I0405 03:22:36.796596 140160096552384 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:22:37.722533 140160096552384 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:22:38.962344 140160096552384 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:22:39.226903 140160096552384 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:22:39Z
I0405 03:22:39.244971 140160096552384 evaluation.py:257] Starting evaluation at 2019-04-05T03:22:39Z
INFO:tensorflow:TPU job name worker
I0405 03:22:39.245296 140160096552384 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:22:39.339088 140160096552384 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:22:39.339982 140160096552384 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:22:39.515105 140160096552384 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:22:42.257065 140160096552384 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:22:42.289077 140160096552384 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:22:42.344064 140160096552384 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:23:55.540407 140160096552384 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:23:55.541522 140158993159936 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:23:55.541887 140158984767232 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:23:55.597157 140160096552384 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:23:55.622415 140160096552384 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:23:55.622873 140160096552384 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:23:56.875893 140160096552384 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:23:56.876435 140160096552384 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:23:56.876557 140160096552384 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:23:56.876745 140158993159936 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:23:56.876961 140158993159936 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:23:56.877146 140160096552384 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:23:56.877269 140160096552384 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:23:56.877334 140160096552384 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:23:56.877475 140158984767232 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:23:56.877670 140158984767232 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:23:56.877810 140160096552384 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:23:56.877917 140160096552384 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:23:56
I0405 03:23:56.974577 140160096552384 evaluation.py:277] Finished evaluation at 2019-04-05-03:23:56
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9852, global_step = 35, loss = 0.040387746
I0405 03:23:56.974998 140160096552384 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9852, global_step = 35, loss = 0.040387746
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:24:00.782049 140160096552384 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:24:01.671938 140160096552384 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.040387746, 'global_step': 35, 'accuracy': 0.9852}

warmup 12, weight decay 0.08
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554434553649194...
Removing gs://bert-pretrain-data/mnist_log3/#1554434549555457...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554434442.yangyouucb#1554434556378085...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554434453434845...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554434454172766...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554434458093721...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554434551128704...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554434551815440...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554434447302624...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554434555624727...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554434638389217...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554434638.yangyouucb#1554434641444172...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:24:05.135062 140566007469504 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:24:05.250890 140566007469504 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd7f647ef50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd7f8cddb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:24:05.355659 140566007469504 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd7f647ef50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd7f8cddb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:24:05.356198 140566007469504 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:24:05.684173 140566007469504 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:24:05.687075: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:24:05.700560 140566007469504 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:24:05.700854 140566007469504 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:24:05.701184 140566007469504 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:24:05.701251 140566007469504 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:24:05.701323 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:24:05.701642 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:24:05.701726 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:24:05.701797 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:24:05.701895 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:24:05.701957 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:24:05.702039 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:24:05.702100 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:24:05.702161 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:24:05.702218 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:24:05.702275 140566007469504 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:24:05.706939 140566007469504 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:24:05.719840 140566007469504 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:24:07.243702 140566007469504 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:24:07.311599 140566007469504 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:24:07.505094 140566007469504 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:24:07.588933 140566007469504 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:24:07.616141 140566007469504 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:24:07.621387 140566007469504 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:07.787192 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:07.835726 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:07.886879 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:07.932321 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:07.982461 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:08.030206 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:08.083601 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:24:08.127921 140566007469504 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:24:08.154393 140566007469504 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:24:08.172785 140566007469504 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:24:11.434309 140566007469504 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:24:11.555329 140566007469504 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:24:12.275466 140566007469504 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:24:12.330687 140566007469504 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:24:14.757643 140566007469504 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:24:25.611531 140566007469504 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:24:25.612306 140566007469504 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:24:25.612743: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:24:25.619875 140566007469504 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:24:25.639230 140566007469504 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:24:25.652272 140566007469504 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:25:39.571330 140566007469504 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:25:39.572324 140565119219456 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:25:39.572948 140565110826752 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:25:39.642097 140566007469504 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:25:39.642822 140566007469504 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.056239862, step = 35
I0405 03:25:51.695677 140566007469504 basic_session_run_hooks.py:249] loss = 0.056239862, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:25:51.698579 140566007469504 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:26:04.430284 140566007469504 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:26:04.430633 140566007469504 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:26:04.430974 140565119219456 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:26:04.431277 140565119219456 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:26:04.431615 140566007469504 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:26:04.431884 140566007469504 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:26:04.431977 140566007469504 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:26:04.432163 140565110826752 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:26:04.432357 140565110826752 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:26:04.432620 140566007469504 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:26:04.432818 140566007469504 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.056239862.
I0405 03:26:04.610944 140566007469504 estimator.py:359] Loss for final step: 0.056239862.
INFO:tensorflow:training_loop marked as finished
I0405 03:26:04.611639 140566007469504 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:26:05.503496 140566007469504 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:26:06.767821 140566007469504 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:26:06.999145 140566007469504 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:26:07Z
I0405 03:26:07.015140 140566007469504 evaluation.py:257] Starting evaluation at 2019-04-05T03:26:07Z
INFO:tensorflow:TPU job name worker
I0405 03:26:07.015466 140566007469504 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:26:07.098948 140566007469504 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:26:07.099721 140566007469504 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:26:07.270823 140566007469504 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:26:10.712163 140566007469504 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:26:10.779733 140566007469504 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:26:10.829432 140566007469504 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:27:23.543601 140566007469504 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:27:23.544579 140565102982912 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:27:23.545028 140565094590208 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:27:23.598212 140566007469504 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:27:23.618824 140566007469504 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:27:23.619301 140566007469504 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:27:24.949275 140566007469504 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:27:24.949723 140566007469504 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:27:24.949846 140566007469504 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:27:24.950038 140565102982912 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:27:24.950171 140565102982912 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:27:24.950320 140566007469504 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:27:24.950462 140566007469504 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:27:24.950527 140566007469504 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:27:24.950674 140565094590208 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:27:24.950763 140565094590208 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:27:24.950920 140566007469504 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:27:24.951018 140566007469504 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:27:25
I0405 03:27:25.039257 140566007469504 evaluation.py:277] Finished evaluation at 2019-04-05-03:27:25
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9839, global_step = 35, loss = 0.057300705
I0405 03:27:25.039660 140566007469504 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9839, global_step = 35, loss = 0.057300705
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:27:28.879065 140566007469504 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:27:29.840512 140566007469504 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.057300705, 'global_step': 35, 'accuracy': 0.9839}

warmup 12, weight decay 0.1
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554434761509001...
Removing gs://bert-pretrain-data/mnist_log3/#1554434757478969...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554434649.yangyouucb#1554434764192574...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554434665157741...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554434759027190...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554434654337335...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554434759679086...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554434661341338...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554434660634280...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554434763494714...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554434846474536...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554434846.yangyouucb#1554434849581196...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:27:33.292191 140051989919168 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:27:33.418365 140051989919168 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f6048728ed0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f604af87b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:27:33.541731 140051989919168 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f6048728ed0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f604af87b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:27:33.542222 140051989919168 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:27:33.863768 140051989919168 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:27:33.866735: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:27:33.880501 140051989919168 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:27:33.882883 140051989919168 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:27:33.883341 140051989919168 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:27:33.883502 140051989919168 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:27:33.883584 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:27:33.883810 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:27:33.883888 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:27:33.883955 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:27:33.884018 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:27:33.884079 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:27:33.884140 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:27:33.884198 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:27:33.884257 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:27:33.884320 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:27:33.884424 140051989919168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:27:33.888895 140051989919168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:27:33.901278 140051989919168 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:27:35.355912 140051989919168 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:27:35.423260 140051989919168 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:27:35.600188 140051989919168 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:27:35.681592 140051989919168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:27:35.707933 140051989919168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:27:35.712977 140051989919168 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:35.876766 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:35.922650 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:35.972827 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:36.018532 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:36.068934 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:36.116419 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:36.168159 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:27:36.213203 140051989919168 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:27:36.239300 140051989919168 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:27:36.257396 140051989919168 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:27:39.656466 140051989919168 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:27:39.773396 140051989919168 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:27:40.485625 140051989919168 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:27:40.537411 140051989919168 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:27:42.949510 140051989919168 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:27:55.278147 140051989919168 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:27:55.278978 140051989919168 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:27:55.279407: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:27:55.286214 140051989919168 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:27:55.303798 140051989919168 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:27:55.316410 140051989919168 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:29:07.529923 140051989919168 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:29:07.533014 140050889172736 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:29:07.533978 140050880780032 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:29:07.605062 140051989919168 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:29:07.605849 140051989919168 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.056479953, step = 35
I0405 03:29:20.023402 140051989919168 basic_session_run_hooks.py:249] loss = 0.056479953, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:29:20.025764 140051989919168 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:29:31.751770 140051989919168 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:29:31.752130 140051989919168 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:29:31.752430 140050889172736 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:29:31.752578 140050889172736 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:29:31.752763 140051989919168 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:29:31.752928 140051989919168 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:29:31.753012 140051989919168 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:29:31.753154 140050880780032 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:29:31.753242 140050880780032 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:29:31.753405 140051989919168 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:29:31.753580 140051989919168 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.056479953.
I0405 03:29:31.934528 140051989919168 estimator.py:359] Loss for final step: 0.056479953.
INFO:tensorflow:training_loop marked as finished
I0405 03:29:31.935265 140051989919168 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:29:32.735313 140051989919168 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:29:33.992326 140051989919168 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:29:34.219316 140051989919168 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:29:34Z
I0405 03:29:34.234760 140051989919168 evaluation.py:257] Starting evaluation at 2019-04-05T03:29:34Z
INFO:tensorflow:TPU job name worker
I0405 03:29:34.235055 140051989919168 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:29:34.322109 140051989919168 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:29:34.322990 140051989919168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:29:34.482959 140051989919168 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:29:37.632584 140051989919168 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:29:37.657052 140051989919168 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:29:37.705399 140051989919168 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:30:51.652940 140051989919168 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:30:51.653918 140050880780032 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:30:51.654473 140050872387328 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:30:51.709938 140051989919168 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:30:51.736939 140051989919168 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:30:51.737334 140051989919168 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:30:52.897716 140051989919168 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:30:52.898096 140051989919168 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:30:52.898179 140051989919168 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:30:52.898396 140050880780032 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:30:52.898511 140050880780032 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:30:52.898658 140051989919168 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:30:52.898778 140051989919168 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:30:52.898843 140051989919168 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:30:52.898977 140050872387328 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:30:52.899064 140050872387328 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:30:52.899180 140051989919168 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:30:52.899275 140051989919168 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:30:52
I0405 03:30:52.987863 140051989919168 evaluation.py:277] Finished evaluation at 2019-04-05-03:30:52
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.044376537
I0405 03:30:52.988255 140051989919168 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.044376537
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:30:56.879789 140051989919168 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:30:57.776777 140051989919168 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.044376537, 'global_step': 35, 'accuracy': 0.9853}

warmup 12, weight decay 0.001
Removing gs://bert-pretrain-data/mnist_log3/#1554434964792851...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554434870990070...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554434968831948...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554434857.yangyouucb#1554434971519700...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554434862527374...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554434874795091...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554434870340901...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554434967051109...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554434966277345...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554434970744002...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554435054372236...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554435054.yangyouucb#1554435057544958...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:31:01.230969 140636352869824 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:31:01.360091 140636352869824 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fe857318650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fe859b77b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:31:01.515727 140636352869824 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fe857318650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fe859b77b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:31:01.516247 140636352869824 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:31:01.840558 140636352869824 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:31:01.843666: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:31:01.857397 140636352869824 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:31:01.857662 140636352869824 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:31:01.858025 140636352869824 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:31:01.858093 140636352869824 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:31:01.858160 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:31:01.858357 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:31:01.858438 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:31:01.858505 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:31:01.858587 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:31:01.858647 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:31:01.858705 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:31:01.858762 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:31:01.858820 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:31:01.858885 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:31:01.858942 140636352869824 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:31:01.863025 140636352869824 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:31:01.874741 140636352869824 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:31:03.300653 140636352869824 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:31:03.367264 140636352869824 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:31:03.558188 140636352869824 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:31:03.638729 140636352869824 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:31:03.665044 140636352869824 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:31:03.670154 140636352869824 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:03.832448 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:03.878420 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:03.927738 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:03.972584 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:04.021799 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:04.068433 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:04.118997 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:31:04.162622 140636352869824 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:31:04.188330 140636352869824 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:31:04.206033 140636352869824 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:31:07.419714 140636352869824 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:31:07.544006 140636352869824 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:31:08.262769 140636352869824 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:31:08.327781 140636352869824 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:31:10.687700 140636352869824 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:31:22.077023 140636352869824 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:31:22.077805 140636352869824 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:31:22.078251: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:31:22.084847 140636352869824 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:31:22.101284 140636352869824 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:31:22.113440 140636352869824 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:32:35.541646 140636352869824 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:32:35.542720 140635398985472 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:32:35.543171 140635390592768 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:32:35.619131 140636352869824 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:32:35.619872 140636352869824 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.048767213, step = 35
I0405 03:32:48.544032 140636352869824 basic_session_run_hooks.py:249] loss = 0.048767213, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:32:48.546142 140636352869824 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:33:01.667702 140636352869824 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:33:01.668035 140636352869824 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:33:01.668327 140635398985472 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:33:01.668508 140635398985472 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:33:01.668708 140636352869824 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:33:01.668845 140636352869824 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:33:01.668920 140636352869824 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:33:01.669095 140635390592768 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:33:01.669190 140635390592768 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:33:01.669348 140636352869824 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:33:01.669532 140636352869824 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.048767213.
I0405 03:33:01.855092 140636352869824 estimator.py:359] Loss for final step: 0.048767213.
INFO:tensorflow:training_loop marked as finished
I0405 03:33:01.855798 140636352869824 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:33:02.821166 140636352869824 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:33:04.173527 140636352869824 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:33:04.448683 140636352869824 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:33:04Z
I0405 03:33:04.466978 140636352869824 evaluation.py:257] Starting evaluation at 2019-04-05T03:33:04Z
INFO:tensorflow:TPU job name worker
I0405 03:33:04.467278 140636352869824 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:33:04.562345 140636352869824 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:33:04.563255 140636352869824 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:33:04.749453 140636352869824 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:33:07.303740 140636352869824 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:33:07.327531 140636352869824 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:33:07.375282 140636352869824 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:34:19.543591 140636352869824 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:34:19.544672 140635382748928 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:34:19.545475 140635374356224 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:34:19.602848 140636352869824 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:34:19.626327 140636352869824 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:34:19.626738 140636352869824 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:34:20.720853 140636352869824 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:34:20.721247 140636352869824 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:34:20.721334 140636352869824 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:34:20.721684 140635382748928 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:34:20.722078 140635382748928 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:34:20.725785 140636352869824 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:34:20.726125 140636352869824 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:34:20.726198 140636352869824 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:34:20.726728 140635374356224 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:34:20.727025 140635374356224 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:34:20.727262 140636352869824 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:34:20.727519 140636352869824 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:34:20
I0405 03:34:20.847232 140636352869824 evaluation.py:277] Finished evaluation at 2019-04-05-03:34:20
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9852, global_step = 35, loss = 0.042126052
I0405 03:34:20.847656 140636352869824 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9852, global_step = 35, loss = 0.042126052
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:34:24.629012 140636352869824 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:34:25.564898 140636352869824 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.042126052, 'global_step': 35, 'accuracy': 0.9852}

warmup 12, weight decay 0.002
Removing gs://bert-pretrain-data/mnist_log3/#1554435174302705...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554435178399157...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554435077884971...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554435065.yangyouucb#1554435181403242...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554435081623323...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554435070281365...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554435077166675...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554435176598239...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554435175902846...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554435180643310...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554435262316942...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554435262.yangyouucb#1554435265325361...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:34:29.174463 140253066204608 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:34:29.307744 140253066204608 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f8f19872f50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f8f1c0d1b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:34:29.418723 140253066204608 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f8f19872f50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f8f1c0d1b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:34:29.419267 140253066204608 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:34:29.759994 140253066204608 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:34:29.764910: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:34:29.782068 140253066204608 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:34:29.782385 140253066204608 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:34:29.782707 140253066204608 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:34:29.782776 140253066204608 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:34:29.782845 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:34:29.783113 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:34:29.783181 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:34:29.783247 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:34:29.783308 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:34:29.783385 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:34:29.783457 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:34:29.783518 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:34:29.783576 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:34:29.783660 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:34:29.783721 140253066204608 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:34:29.788412 140253066204608 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:34:29.800976 140253066204608 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:34:31.281003 140253066204608 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:34:31.346812 140253066204608 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:34:31.535495 140253066204608 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:34:31.615096 140253066204608 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:34:31.641771 140253066204608 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:34:31.646908 140253066204608 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:31.821537 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:31.868773 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:31.920424 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:31.967070 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:32.017230 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:32.065659 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:32.118952 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:34:32.164170 140253066204608 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:34:32.190407 140253066204608 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:34:32.208483 140253066204608 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:34:35.534867 140253066204608 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:34:35.659691 140253066204608 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:34:36.342061 140253066204608 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:34:36.423243 140253066204608 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:34:38.845698 140253066204608 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:34:49.660078 140253066204608 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:34:49.660895 140253066204608 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:34:49.661306: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:34:49.668024 140253066204608 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:34:49.686005 140253066204608 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:34:49.698275 140253066204608 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:36:03.482126 140253066204608 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:36:03.483171 140252173543168 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:36:03.484318 140251821504256 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:36:03.551512 140253066204608 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:36:03.552257 140253066204608 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.05933544, step = 35
I0405 03:36:15.402689 140253066204608 basic_session_run_hooks.py:249] loss = 0.05933544, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:36:15.404891 140253066204608 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:36:27.463157 140253066204608 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:36:27.463613 140253066204608 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:36:27.463979 140252173543168 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:36:27.464301 140252173543168 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:36:27.464557 140253066204608 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:36:27.464795 140253066204608 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:36:27.464860 140253066204608 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:36:27.465025 140251821504256 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:36:27.465208 140251821504256 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:36:27.465358 140253066204608 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:36:27.465547 140253066204608 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.05933544.
I0405 03:36:27.645394 140253066204608 estimator.py:359] Loss for final step: 0.05933544.
INFO:tensorflow:training_loop marked as finished
I0405 03:36:27.646147 140253066204608 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:36:28.562386 140253066204608 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:36:29.832545 140253066204608 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:36:30.075997 140253066204608 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:36:30Z
I0405 03:36:30.092819 140253066204608 evaluation.py:257] Starting evaluation at 2019-04-05T03:36:30Z
INFO:tensorflow:TPU job name worker
I0405 03:36:30.093136 140253066204608 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:36:30.179570 140253066204608 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:36:30.180435 140253066204608 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:36:30.371443 140253066204608 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:36:33.325787 140253066204608 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:36:33.349565 140253066204608 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:36:33.401884 140253066204608 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 03:37:47.568717 140253066204608 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:37:47.569761 140251821504256 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:37:47.570106 140251813111552 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:37:47.623766 140253066204608 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:37:47.650298 140253066204608 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:37:47.650716 140253066204608 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:37:48.774075 140253066204608 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:37:48.774518 140253066204608 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:37:48.774607 140253066204608 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:37:48.774889 140251821504256 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:37:48.775213 140251821504256 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:37:48.775424 140253066204608 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:37:48.775613 140253066204608 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:37:48.775676 140253066204608 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:37:48.775839 140251813111552 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:37:48.776021 140251813111552 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:37:48.776180 140253066204608 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:37:48.776324 140253066204608 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:37:48
I0405 03:37:48.877865 140253066204608 evaluation.py:277] Finished evaluation at 2019-04-05-03:37:48
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9835, global_step = 35, loss = 0.056015383
I0405 03:37:48.878251 140253066204608 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9835, global_step = 35, loss = 0.056015383
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:37:52.698051 140253066204608 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:37:53.528862 140253066204608 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.056015383, 'global_step': 35, 'accuracy': 0.9835}

warmup 12, weight decay 0.004
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554435285405054...
Removing gs://bert-pretrain-data/mnist_log3/#1554435380202311...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554435384334931...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554435289197926...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554435381776994...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554435273.yangyouucb#1554435387219529...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554435278416279...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554435284748556...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554435382500374...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554435386453103...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554435470313337...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554435470.yangyouucb#1554435473300909...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:37:57.104418 139706669188544 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:37:57.239887 139706669188544 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0fe1adf650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0fe4404b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:37:57.380805 139706669188544 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0fe1adf650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0fe4404b50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:37:57.381386 139706669188544 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:37:57.807672 139706669188544 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:37:57.810954: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:37:57.825767 139706669188544 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:37:57.826085 139706669188544 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:37:57.826436 139706669188544 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:37:57.826503 139706669188544 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:37:57.826565 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:37:57.826764 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:37:57.826852 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:37:57.826925 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:37:57.826993 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:37:57.827054 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:37:57.827114 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:37:57.827172 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:37:57.827229 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:37:57.827287 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:37:57.827346 139706669188544 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:37:57.831926 139706669188544 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:37:57.844954 139706669188544 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:37:59.367219 139706669188544 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:37:59.436372 139706669188544 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:37:59.618793 139706669188544 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:37:59.700834 139706669188544 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:37:59.727797 139706669188544 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:37:59.732897 139706669188544 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:37:59.898235 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:37:59.945594 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:37:59.997164 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:38:00.044053 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:38:00.094875 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:38:00.142704 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:38:00.194648 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:38:00.240449 139706669188544 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:38:00.266515 139706669188544 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:38:00.284096 139706669188544 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:38:03.632129 139706669188544 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:38:03.751981 139706669188544 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:38:04.471205 139706669188544 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:38:04.524342 139706669188544 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:38:07.392153 139706669188544 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:38:18.030575 139706669188544 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:38:18.031332 139706669188544 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:38:18.031753: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:38:18.038151 139706669188544 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:38:18.057307 139706669188544 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:38:18.070328 139706669188544 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0405 03:39:31.553983 139706669188544 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:39:31.555145 139705784973056 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:39:31.555636 139705776580352 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:39:31.624186 139706669188544 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:39:31.624932 139706669188544 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.06298246, step = 35
I0405 03:39:43.341449 139706669188544 basic_session_run_hooks.py:249] loss = 0.06298246, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:39:43.343992 139706669188544 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0405 03:39:55.669892 139706669188544 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:39:55.670290 139706669188544 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:39:55.670670 139705784973056 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:39:55.671084 139705784973056 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:39:55.671401 139706669188544 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:39:55.671660 139706669188544 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:39:55.671751 139706669188544 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:39:55.671986 139705776580352 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:39:55.672197 139705776580352 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:39:55.672434 139706669188544 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:39:55.672636 139706669188544 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.06298246.
I0405 03:39:55.852462 139706669188544 estimator.py:359] Loss for final step: 0.06298246.
INFO:tensorflow:training_loop marked as finished
I0405 03:39:55.853140 139706669188544 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0405 03:39:56.803719 139706669188544 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:39:58.074034 139706669188544 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0405 03:39:58.322525 139706669188544 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-05T03:39:58Z
I0405 03:39:58.339411 139706669188544 evaluation.py:257] Starting evaluation at 2019-04-05T03:39:58Z
INFO:tensorflow:TPU job name worker
I0405 03:39:58.339728 139706669188544 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:39:58.428335 139706669188544 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0405 03:39:58.429184 139706669188544 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:39:58.600970 139706669188544 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0405 03:40:01.461541 139706669188544 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:40:01.492086 139706669188544 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0405 03:40:01.539563 139706669188544 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0405 03:41:15.554501 139706669188544 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:41:15.555375 139705767687936 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:41:15.555705 139705421133568 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:41:15.610220 139706669188544 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0405 03:41:15.635324 139706669188544 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0405 03:41:15.635756 139706669188544 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0405 03:41:16.724853 139706669188544 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0405 03:41:16.725248 139706669188544 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0405 03:41:16.725327 139706669188544 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0405 03:41:16.725603 139705767687936 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0405 03:41:16.725725 139705767687936 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0405 03:41:16.725888 139706669188544 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0405 03:41:16.726001 139706669188544 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0405 03:41:16.726059 139706669188544 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0405 03:41:16.726186 139705421133568 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0405 03:41:16.726270 139705421133568 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0405 03:41:16.726408 139706669188544 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0405 03:41:16.726502 139706669188544 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-05-03:41:16
I0405 03:41:16.828355 139706669188544 evaluation.py:277] Finished evaluation at 2019-04-05-03:41:16
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9807, global_step = 35, loss = 0.059973735
I0405 03:41:16.828737 139706669188544 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9807, global_step = 35, loss = 0.059973735
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0405 03:41:20.673942 139706669188544 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0405 03:41:21.586996 139706669188544 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.059973735, 'global_step': 35, 'accuracy': 0.9807}

warmup 12, weight decay 0.008
Removing gs://bert-pretrain-data/mnist_log3/#1554435588252667...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554435592303062...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554435482.yangyouucb#1554435595424843...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554435486770457...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554435493644851...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554435497550907...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554435492951164...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554435589814092...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554435590498664...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554435594297771...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554435678312752...
/ [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554435678.yangyouucb#1554435681304371...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0405 03:41:25.166791 139972402431424 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0405 03:41:25.296436 139972402431424 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f4dc09d7650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f4dc32fcb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0405 03:41:25.438766 139972402431424 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f4dc09d7650>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f4dc32fcb50>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0405 03:41:25.439292 139972402431424 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0405 03:41:25.779984 139972402431424 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-05 03:41:25.783371: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0405 03:41:25.799396 139972402431424 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0405 03:41:25.799745 139972402431424 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0405 03:41:25.800088 139972402431424 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0405 03:41:25.800163 139972402431424 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0405 03:41:25.800226 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0405 03:41:25.800436 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0405 03:41:25.800507 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0405 03:41:25.800579 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0405 03:41:25.800651 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0405 03:41:25.800710 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0405 03:41:25.800771 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0405 03:41:25.800848 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0405 03:41:25.800909 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0405 03:41:25.800967 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0405 03:41:25.801026 139972402431424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0405 03:41:25.806828 139972402431424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0405 03:41:25.820734 139972402431424 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:41:29.057151 139972402431424 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0405 03:41:29.121881 139972402431424 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0405 03:41:29.311249 139972402431424 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0405 03:41:29.392110 139972402431424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0405 03:41:29.420124 139972402431424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0405 03:41:29.425551 139972402431424 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.588816 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.634772 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.684449 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.729645 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.779386 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.830387 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.883827 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0405 03:41:29.928920 139972402431424 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0405 03:41:29.955264 139972402431424 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0405 03:41:29.973560 139972402431424 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0405 03:41:33.111143 139972402431424 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0405 03:41:33.234276 139972402431424 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0405 03:41:34.039530 139972402431424 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0405 03:41:34.107184 139972402431424 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0405 03:41:36.494525 139972402431424 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0405 03:41:47.447822 139972402431424 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0405 03:41:47.448630 139972402431424 session_support.py:345] Installing graceful shutdown hook.
2019-04-05 03:41:47.449060: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0405 03:41:47.455746 139972402431424 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0405 03:41:47.473910 139972402431424 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0405 03:41:47.486326 139972402431424 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0405 03:42:59.548206 139972402431424 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0405 03:42:59.549402 139971719730944 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0405 03:42:59.550293 139971172235008 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0405 03:42:59.621803 139972402431424 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0405 03:42:59.622524 139972402431424 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
