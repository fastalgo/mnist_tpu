warmup 10, LR 0.001
Removing gs://bert-pretrain-data/mnist_log3/#1554332779547067...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554332748545180...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554332783832139...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554332752313222...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554332736.yangyouucb#1554332786826180...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554332741591391...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-2050.data-00000-of-00001#1554332781125530...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-2050.index#1554332781819079...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554332747790768...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-2050.meta#1554332785711673...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554332807668610...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554332807.yangyouucb#1554332810691327...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:35:56.430896 140056623412672 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:35:56.668363 140056623412672 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f615c8f6a90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f615f260ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:35:56.802011 140056623412672 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f615c8f6a90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f615f260ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:35:56.802561 140056623412672 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:35:57.122828 140056623412672 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:35:57.125989: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:35:57.139887 140056623412672 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:35:57.140218 140056623412672 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:35:57.140567 140056623412672 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:35:57.140634 140056623412672 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:35:57.140697 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:35:57.140899 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:35:57.140976 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:35:57.141041 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:35:57.141120 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:35:57.141181 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:35:57.141241 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:35:57.141309 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:35:57.141370 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:35:57.141428 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:35:57.141537 140056623412672 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:35:57.145869 140056623412672 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:35:57.158258 140056623412672 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:35:58.883469 140056623412672 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:35:58.950218 140056623412672 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:35:59.126140 140056623412672 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:35:59.208528 140056623412672 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:35:59.235272 140056623412672 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:35:59.240315 140056623412672 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.402462 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.447572 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.497270 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.542984 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.593183 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.639662 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.690794 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:35:59.734703 140056623412672 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:35:59.760409 140056623412672 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:35:59.778019 140056623412672 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:36:03.123328 140056623412672 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:36:03.238713 140056623412672 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:36:03.928180 140056623412672 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:36:03.979918 140056623412672 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:36:06.593722 140056623412672 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:36:17.985111 140056623412672 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:36:17.985872 140056623412672 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:36:17.986262: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:36:17.993726 140056623412672 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:36:18.012274 140056623412672 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:36:18.024616 140056623412672 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 7 seconds
I0404 01:36:25.069675 140056623412672 tpu_estimator.py:510] Initialized TPU in 7 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:36:25.070611 140055806613248 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:36:25.071176 140055393859328 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:36:25.123405 140056623412672 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:36:25.124051 140056623412672 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.1582434, step = 35
I0404 01:36:36.533005 140056623412672 basic_session_run_hooks.py:249] loss = 2.1582434, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:36:36.538079 140056623412672 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:36:48.379024 140056623412672 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:36:48.379410 140056623412672 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:36:48.379662 140055806613248 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:36:48.379806 140055806613248 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:36:48.379987 140056623412672 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:36:48.380131 140056623412672 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:36:48.380192 140056623412672 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:36:48.380376 140055393859328 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:36:48.380472 140055393859328 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:36:48.380625 140056623412672 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:36:48.380733 140056623412672 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.1582434.
I0404 01:36:48.541693 140056623412672 estimator.py:359] Loss for final step: 2.1582434.
INFO:tensorflow:training_loop marked as finished
I0404 01:36:48.542542 140056623412672 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:36:49.454005 140056623412672 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:36:50.762443 140056623412672 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:36:51.026143 140056623412672 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:36:51Z
I0404 01:36:51.044364 140056623412672 evaluation.py:257] Starting evaluation at 2019-04-04T01:36:51Z
INFO:tensorflow:TPU job name worker
I0404 01:36:51.044703 140056623412672 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:36:51.141897 140056623412672 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:36:51.142795 140056623412672 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:36:51.312660 140056623412672 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:36:53.910109 140056623412672 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:36:53.934367 140056623412672 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:36:53.979813 140056623412672 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 10 seconds
I0404 01:37:04.139866 140056623412672 tpu_estimator.py:510] Initialized TPU in 10 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:37:04.140913 140055385466624 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:37:04.142163 140055377073920 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:37:04.193584 140056623412672 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:37:04.214227 140056623412672 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:37:04.214628 140056623412672 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:37:05.597429 140056623412672 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:37:05.597848 140056623412672 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:37:05.597934 140056623412672 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:37:05.598125 140055385466624 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:37:05.598248 140055385466624 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:37:05.598439 140056623412672 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:37:05.598562 140056623412672 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:37:05.598623 140056623412672 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:37:05.598743 140055377073920 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:37:05.598826 140055377073920 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:37:05.598949 140056623412672 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:37:05.599060 140056623412672 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:37:05
I0404 01:37:05.715373 140056623412672 evaluation.py:277] Finished evaluation at 2019-04-04-01:37:05
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.606, global_step = 35, loss = 2.160483
I0404 01:37:05.715730 140056623412672 estimator.py:1979] Saving dict for global step 35: accuracy = 0.606, global_step = 35, loss = 2.160483
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:37:09.536006 140056623412672 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:37:10.301033 140056623412672 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 2.160483, 'global_step': 35, 'accuracy': 0.606}

warmup 10, LR 0.002
Removing gs://bert-pretrain-data/mnist_log3/#1554341801284240...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554341805457796...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554341761.yangyouucb#1554341808148105...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554341773520428...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554341777524630...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554341766168845...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554341803602175...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554341772829380...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554341802849712...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554341807443078...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554341827053727...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554341827.yangyouucb#1554341830073801...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:37:13.531244 140387368396224 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:37:13.668356 140387368396224 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fae5e7f8550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fae6115fad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:37:13.841803 140387368396224 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fae5e7f8550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fae6115fad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:37:13.842302 140387368396224 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:37:14.156267 140387368396224 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:37:14.159272: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:37:14.174122 140387368396224 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:37:14.174422 140387368396224 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:37:14.174760 140387368396224 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:37:14.174829 140387368396224 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:37:14.174890 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:37:14.175138 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:37:14.175209 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:37:14.175273 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:37:14.175344 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:37:14.175404 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:37:14.175462 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:37:14.175524 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:37:14.175582 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:37:14.175640 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:37:14.175717 140387368396224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:37:14.180119 140387368396224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:37:14.192401 140387368396224 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:37:15.603876 140387368396224 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:37:15.667819 140387368396224 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:37:15.840960 140387368396224 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:37:15.920711 140387368396224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:37:15.947069 140387368396224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:37:15.952121 140387368396224 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.115009 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.160254 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.210604 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.256190 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.305819 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.352447 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.403805 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:37:16.448643 140387368396224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:37:16.474622 140387368396224 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:37:16.492238 140387368396224 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:37:19.875164 140387368396224 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:37:19.991514 140387368396224 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:37:20.690530 140387368396224 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:37:20.737274 140387368396224 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:37:23.382886 140387368396224 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:37:33.948709 140387368396224 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:37:33.949466 140387368396224 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:37:33.949896: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:37:33.956439 140387368396224 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:37:33.974694 140387368396224 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:37:33.986843 140387368396224 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 13 seconds
I0404 01:37:47.722335 140387368396224 tpu_estimator.py:510] Initialized TPU in 13 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:37:47.723351 140386416707328 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:37:47.723890 140386408314624 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:37:47.784306 140387368396224 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:37:47.784966 140387368396224 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 1.9619192, step = 35
I0404 01:37:59.374339 140387368396224 basic_session_run_hooks.py:249] loss = 1.9619192, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:37:59.376595 140387368396224 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:38:12.492100 140387368396224 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:38:12.492430 140387368396224 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:38:12.492674 140386416707328 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:38:12.492796 140386416707328 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:38:12.492974 140387368396224 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:38:12.493113 140387368396224 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:38:12.493172 140387368396224 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:38:12.493308 140386408314624 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:38:12.493393 140386408314624 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:38:12.493922 140387368396224 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:38:12.494069 140387368396224 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 1.9619192.
I0404 01:38:12.653312 140387368396224 estimator.py:359] Loss for final step: 1.9619192.
INFO:tensorflow:training_loop marked as finished
I0404 01:38:12.654005 140387368396224 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:38:13.437324 140387368396224 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:38:14.811594 140387368396224 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:38:15.038682 140387368396224 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:38:15Z
I0404 01:38:15.053988 140387368396224 evaluation.py:257] Starting evaluation at 2019-04-04T01:38:15Z
INFO:tensorflow:TPU job name worker
I0404 01:38:15.054274 140387368396224 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:38:15.135816 140387368396224 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:38:15.136610 140387368396224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:38:15.306099 140387368396224 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:38:17.775737 140387368396224 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:38:17.799607 140387368396224 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:38:17.845408 140387368396224 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 01:38:33.311386 140387368396224 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:38:33.312441 140386399946496 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:38:33.313193 140386391553792 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:38:33.367752 140387368396224 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:38:33.389457 140387368396224 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:38:33.389894 140387368396224 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:38:34.672396 140387368396224 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:38:34.672796 140387368396224 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:38:34.672883 140387368396224 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:38:34.673098 140386399946496 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:38:34.673228 140386399946496 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:38:34.673387 140387368396224 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:38:34.673537 140387368396224 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:38:34.673613 140387368396224 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:38:34.673741 140386391553792 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:38:34.673830 140386391553792 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:38:34.673950 140387368396224 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:38:34.674050 140387368396224 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:38:34
I0404 01:38:34.792515 140387368396224 evaluation.py:277] Finished evaluation at 2019-04-04-01:38:34
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.7327, global_step = 35, loss = 1.9473248
I0404 01:38:34.792859 140387368396224 estimator.py:1979] Saving dict for global step 35: accuracy = 0.7327, global_step = 35, loss = 1.9473248
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:38:38.576414 140387368396224 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:38:39.405596 140387368396224 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 1.9473248, 'global_step': 35, 'accuracy': 0.7327}

warmup 10, LR 0.005
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554341849724370...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554341853505496...
Removing gs://bert-pretrain-data/mnist_log3/#1554341884959287...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554341838.yangyouucb#1554341892249531...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554341889062927...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554341886506998...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554341842972840...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554341849087906...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554341887258703...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554341891252326...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554341916176461...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554341916.yangyouucb#1554341919183050...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:38:42.714313 139916732130752 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:38:42.856620 139916732130752 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f40ca640550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f40ccfa7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:38:42.945674 139916732130752 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f40ca640550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f40ccfa7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:38:42.946187 139916732130752 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:38:43.293123 139916732130752 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:38:43.296373: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:38:43.309808 139916732130752 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:38:43.310108 139916732130752 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:38:43.310468 139916732130752 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:38:43.310554 139916732130752 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:38:43.310626 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:38:43.310833 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:38:43.310926 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:38:43.310998 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:38:43.311069 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:38:43.311137 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:38:43.311204 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:38:43.311270 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:38:43.311357 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:38:43.311424 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:38:43.311490 139916732130752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:38:43.316209 139916732130752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:38:43.329333 139916732130752 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:38:44.721426 139916732130752 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:38:44.784163 139916732130752 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:38:44.961085 139916732130752 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:38:45.038861 139916732130752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:38:45.064224 139916732130752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:38:45.069227 139916732130752 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.227749 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.273720 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.322856 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.367197 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.416649 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.463423 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.520802 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:38:45.566963 139916732130752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:38:45.593157 139916732130752 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:38:45.611422 139916732130752 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:38:48.846350 139916732130752 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:38:48.966851 139916732130752 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:38:49.648484 139916732130752 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:38:49.711263 139916732130752 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:38:52.280134 139916732130752 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:39:03.010462 139916732130752 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:39:03.011354 139916732130752 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:39:03.011795: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:39:03.018624 139916732130752 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:39:03.035793 139916732130752 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:39:03.048540 139916732130752 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:39:17.076212 139916732130752 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:39:17.077229 139915848042240 tpu_estimator.py:463] Starting infeed thread controller.
I0404 01:39:17.077661 139915839649536 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:39:17.137166 139916732130752 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:39:17.137919 139916732130752 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 1.0490094, step = 35
I0404 01:39:28.583517 139916732130752 basic_session_run_hooks.py:249] loss = 1.0490094, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:39:28.586075 139916732130752 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:39:41.540239 139916732130752 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:39:41.540611 139916732130752 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:39:41.540926 139915848042240 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:39:41.541079 139915848042240 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:39:41.541256 139916732130752 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:39:41.541385 139916732130752 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:39:41.541446 139916732130752 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:39:41.541659 139915839649536 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:39:41.541754 139915839649536 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:39:41.541899 139916732130752 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:39:41.542001 139916732130752 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 1.0490094.
I0404 01:39:41.701045 139916732130752 estimator.py:359] Loss for final step: 1.0490094.
INFO:tensorflow:training_loop marked as finished
I0404 01:39:41.701765 139916732130752 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:39:42.524146 139916732130752 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:39:43.739603 139916732130752 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:39:43.958756 139916732130752 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:39:43Z
I0404 01:39:43.973396 139916732130752 evaluation.py:257] Starting evaluation at 2019-04-04T01:39:43Z
INFO:tensorflow:TPU job name worker
I0404 01:39:43.973692 139916732130752 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:39:44.053461 139916732130752 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:39:44.054239 139916732130752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:39:44.218765 139916732130752 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:39:46.692931 139916732130752 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:39:46.722070 139916732130752 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:39:46.784595 139916732130752 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:40:01.038182 139916732130752 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:40:01.039097 139915830757120 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:40:01.039599 139915822364416 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:40:01.091216 139916732130752 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:40:01.115042 139916732130752 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:40:01.115597 139916732130752 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:40:02.287976 139916732130752 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:40:02.288419 139916732130752 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:40:02.288536 139916732130752 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:40:02.288846 139915830757120 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:40:02.289210 139915830757120 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:40:02.289465 139916732130752 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:40:02.289745 139916732130752 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:40:02.289814 139916732130752 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:40:02.290013 139915822364416 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:40:02.290244 139915822364416 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:40:02.290448 139916732130752 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:40:02.290621 139916732130752 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:40:02
I0404 01:40:02.386171 139916732130752 evaluation.py:277] Finished evaluation at 2019-04-04-01:40:02
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8357, global_step = 35, loss = 0.9947742
I0404 01:40:02.386590 139916732130752 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8357, global_step = 35, loss = 0.9947742
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:40:06.007788 139916732130752 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:40:06.828383 139916732130752 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.9947742, 'global_step': 35, 'accuracy': 0.8357}

warmup 10, LR 0.006
Removing gs://bert-pretrain-data/mnist_log3/#1554341974243375...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554341978402329...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554341931877786...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554341927.yangyouucb#1554341981310916...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554341938817838...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554341942567737...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554341976574490...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554341975824759...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554341938204878...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554341980264678...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342003700218...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342003.yangyouucb#1554342006608590...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:40:10.235568 140185325004224 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:40:10.368782 140185325004224 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7f53c61550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7f565c7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:40:10.489895 140185325004224 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7f53c61550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7f565c7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:40:10.490469 140185325004224 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:40:10.810919 140185325004224 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:40:10.813757: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:40:10.827835 140185325004224 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:40:10.828125 140185325004224 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:40:10.828514 140185325004224 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:40:10.828583 140185325004224 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:40:10.828646 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:40:10.828843 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:40:10.828913 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:40:10.828984 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:40:10.829045 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:40:10.829103 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:40:10.829163 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:40:10.829220 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:40:10.829310 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:40:10.829376 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:40:10.829437 140185325004224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:40:10.833952 140185325004224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:40:10.846482 140185325004224 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:40:12.267092 140185325004224 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:40:12.335436 140185325004224 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:40:12.514039 140185325004224 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:40:12.600603 140185325004224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:40:12.627566 140185325004224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:40:12.632785 140185325004224 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:12.802248 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:12.850622 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:12.902839 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:12.949779 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:13.000415 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:13.047272 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:13.099010 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:40:13.143346 140185325004224 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:40:13.169271 140185325004224 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:40:13.186656 140185325004224 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:40:16.235224 140185325004224 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:40:16.349077 140185325004224 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:40:17.014537 140185325004224 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:40:17.059731 140185325004224 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:40:19.655663 140185325004224 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:40:30.622971 140185325004224 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:40:30.623713 140185325004224 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:40:30.624096: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:40:30.630364 140185325004224 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:40:30.647994 140185325004224 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:40:30.659744 140185325004224 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:40:44.781759 140185325004224 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:40:44.782922 140184234485504 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:40:44.783682 140184226092800 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:40:44.844063 140185325004224 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:40:44.844719 140185325004224 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.8763881, step = 35
I0404 01:40:56.319962 140185325004224 basic_session_run_hooks.py:249] loss = 0.8763881, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:40:56.322932 140185325004224 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:41:08.864562 140185325004224 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:41:08.864881 140185325004224 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:41:08.865101 140184234485504 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:41:08.865214 140184234485504 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:41:08.865386 140185325004224 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:41:08.865562 140185325004224 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:41:08.865653 140185325004224 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:41:08.865778 140184226092800 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:41:08.865875 140184226092800 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:41:08.866002 140185325004224 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:41:08.866094 140185325004224 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.8763881.
I0404 01:41:09.034162 140185325004224 estimator.py:359] Loss for final step: 0.8763881.
INFO:tensorflow:training_loop marked as finished
I0404 01:41:09.034848 140185325004224 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:41:09.812546 140185325004224 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:41:11.043665 140185325004224 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:41:11.269269 140185325004224 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:41:11Z
I0404 01:41:11.284765 140185325004224 evaluation.py:257] Starting evaluation at 2019-04-04T01:41:11Z
INFO:tensorflow:TPU job name worker
I0404 01:41:11.285065 140185325004224 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:41:11.367144 140185325004224 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:41:11.367923 140185325004224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:41:11.535315 140185325004224 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:41:14.126265 140185325004224 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:41:14.150007 140185325004224 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:41:14.202606 140185325004224 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:41:28.719211 140185325004224 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:41:28.720160 140184218248960 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:41:28.721035 140184209856256 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:41:28.796176 140185325004224 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:41:28.822103 140185325004224 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:41:28.822500 140185325004224 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:41:30.002007 140185325004224 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:41:30.002398 140185325004224 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:41:30.002487 140185325004224 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:41:30.002691 140184218248960 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:41:30.002820 140184218248960 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:41:30.002973 140185325004224 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:41:30.003084 140185325004224 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:41:30.003143 140185325004224 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:41:30.003261 140184209856256 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:41:30.003360 140184209856256 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:41:30.003483 140185325004224 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:41:30.003572 140185325004224 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:41:30
I0404 01:41:30.095474 140185325004224 evaluation.py:277] Finished evaluation at 2019-04-04-01:41:30
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8321, global_step = 35, loss = 0.8174416
I0404 01:41:30.095851 140185325004224 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8321, global_step = 35, loss = 0.8174416
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:41:33.951828 140185325004224 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:41:34.851417 140185325004224 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.8174416, 'global_step': 35, 'accuracy': 0.8321}

warmup 10, LR 0.008
Removing gs://bert-pretrain-data/mnist_log3/#1554342061980621...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342026270720...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342066017996...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342014.yangyouucb#1554342068639610...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342019257099...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342030180282...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342063459174...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342064106982...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342025215717...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342067855627...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342091398947...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342091.yangyouucb#1554342094623072...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:41:38.173985 139792940524992 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:41:38.305389 139792940524992 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f23f7d5dad0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f23fa6c7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:41:38.423696 139792940524992 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f23f7d5dad0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f23fa6c7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:41:38.424215 139792940524992 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:41:38.743388 139792940524992 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:41:38.746152: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:41:38.760399 139792940524992 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:41:38.760716 139792940524992 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:41:38.761130 139792940524992 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:41:38.761199 139792940524992 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:41:38.761265 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:41:38.761524 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:41:38.761606 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:41:38.761677 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:41:38.761740 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:41:38.761809 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:41:38.761869 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:41:38.761929 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:41:38.761987 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:41:38.762047 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:41:38.762104 139792940524992 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:41:38.766861 139792940524992 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:41:38.779441 139792940524992 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:41:40.412446 139792940524992 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:41:40.477248 139792940524992 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:41:40.654654 139792940524992 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:41:40.736069 139792940524992 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:41:40.762609 139792940524992 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:41:40.767679 139792940524992 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:40.930090 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:40.975217 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:41.025396 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:41.070904 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:41.120564 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:41.168620 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:41.222174 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:41:41.267972 139792940524992 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:41:41.294004 139792940524992 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:41:41.312201 139792940524992 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:41:44.347399 139792940524992 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:41:44.465200 139792940524992 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:41:45.127490 139792940524992 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:41:45.187285 139792940524992 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:41:47.567734 139792940524992 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:41:58.920345 139792940524992 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:41:58.923207 139792940524992 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:41:58.923860: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:41:58.930754 139792940524992 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:41:58.948805 139792940524992 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:41:58.961242 139792940524992 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:42:13.653093 139792940524992 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:42:13.654313 139791848957696 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:42:13.655116 139791840564992 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:42:13.718091 139792940524992 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:42:13.718780 139792940524992 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.5489943, step = 35
I0404 01:42:25.359241 139792940524992 basic_session_run_hooks.py:249] loss = 0.5489943, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:42:25.361920 139792940524992 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:42:37.021847 139792940524992 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:42:37.022154 139792940524992 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:42:37.022454 139791848957696 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:42:37.022819 139791848957696 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:42:37.023144 139792940524992 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:42:37.023425 139792940524992 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:42:37.023516 139792940524992 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:42:37.023721 139791840564992 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:42:37.023905 139791840564992 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:42:37.024080 139792940524992 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:42:37.024264 139792940524992 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.5489943.
I0404 01:42:37.197515 139792940524992 estimator.py:359] Loss for final step: 0.5489943.
INFO:tensorflow:training_loop marked as finished
I0404 01:42:37.198173 139792940524992 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:42:37.981168 139792940524992 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:42:39.221121 139792940524992 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:42:39.464994 139792940524992 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:42:39Z
I0404 01:42:39.482048 139792940524992 evaluation.py:257] Starting evaluation at 2019-04-04T01:42:39Z
INFO:tensorflow:TPU job name worker
I0404 01:42:39.482369 139792940524992 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:42:39.568821 139792940524992 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:42:39.569643 139792940524992 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:42:39.727133 139792940524992 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:42:42.235670 139792940524992 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:42:42.259251 139792940524992 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:42:42.305563 139792940524992 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:42:56.820858 139792940524992 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:42:56.821788 139791832721152 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:42:56.822278 139791824328448 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:42:56.873325 139792940524992 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:42:56.894537 139792940524992 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:42:56.894932 139792940524992 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:42:58.187155 139792940524992 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:42:58.187532 139792940524992 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:42:58.187618 139792940524992 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:42:58.187803 139791832721152 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:42:58.187918 139791832721152 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:42:58.188071 139792940524992 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:42:58.188175 139792940524992 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:42:58.188239 139792940524992 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:42:58.188374 139791824328448 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:42:58.188458 139791824328448 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:42:58.188597 139792940524992 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:42:58.188695 139792940524992 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:42:58
I0404 01:42:58.277697 139792940524992 evaluation.py:277] Finished evaluation at 2019-04-04-01:42:58
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8753, global_step = 35, loss = 0.51938826
I0404 01:42:58.278059 139792940524992 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8753, global_step = 35, loss = 0.51938826
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:43:02.005783 139792940524992 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:43:02.723095 139792940524992 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.51938826, 'global_step': 35, 'accuracy': 0.8753}

warmup 10, LR 0.01
Removing gs://bert-pretrain-data/mnist_log3/#1554342150185638...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342114761917...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342118449291...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342114103709...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342154209307...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342102.yangyouucb#1554342156795139...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342152459059...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342107150679...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342151782966...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342156114679...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342179676004...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342179.yangyouucb#1554342182491787...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:43:05.990086 140700698428864 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:43:06.108484 140700698428864 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff7526c3f90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff75502dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:43:06.261249 140700698428864 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff7526c3f90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff75502dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:43:06.263993 140700698428864 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:43:06.593411 140700698428864 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:43:06.596391: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:43:06.609810 140700698428864 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:43:06.610110 140700698428864 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:43:06.610485 140700698428864 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:43:06.610558 140700698428864 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:43:06.610620 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:43:06.610822 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:43:06.610891 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:43:06.610954 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:43:06.611017 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:43:06.611078 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:43:06.611155 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:43:06.611213 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:43:06.611273 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:43:06.611346 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:43:06.611406 140700698428864 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:43:06.615890 140700698428864 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:43:06.628248 140700698428864 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:43:08.133094 140700698428864 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:43:08.197268 140700698428864 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:43:08.368284 140700698428864 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:43:08.446011 140700698428864 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:43:08.471498 140700698428864 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:43:08.476484 140700698428864 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.635898 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.680366 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.729887 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.774333 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.823539 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.869599 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.919675 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:43:08.962439 140700698428864 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:43:08.987457 140700698428864 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:43:09.004580 140700698428864 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:43:12.247515 140700698428864 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:43:12.369266 140700698428864 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:43:13.079346 140700698428864 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:43:13.123143 140700698428864 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:43:15.472088 140700698428864 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:43:27.170361 140700698428864 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:43:27.171138 140700698428864 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:43:27.171545: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:43:27.177376 140700698428864 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:43:27.193129 140700698428864 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:43:27.205015 140700698428864 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:43:41.910033 140700698428864 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:43:41.910995 140699747206912 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:43:41.912149 140699738814208 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:43:41.971693 140700698428864 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:43:41.972382 140700698428864 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.40423325, step = 35
I0404 01:43:54.915170 140700698428864 basic_session_run_hooks.py:249] loss = 0.40423325, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:43:54.917645 140700698428864 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:44:07.616283 140700698428864 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:44:07.616677 140700698428864 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:44:07.616914 140699747206912 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:44:07.617048 140699747206912 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:44:07.617224 140700698428864 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:44:07.617352 140700698428864 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:44:07.617427 140700698428864 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:44:07.617610 140699738814208 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:44:07.617707 140699738814208 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:44:07.617840 140700698428864 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:44:07.617938 140700698428864 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.40423325.
I0404 01:44:07.783833 140700698428864 estimator.py:359] Loss for final step: 0.40423325.
INFO:tensorflow:training_loop marked as finished
I0404 01:44:07.784550 140700698428864 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:44:08.678313 140700698428864 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:44:10.078579 140700698428864 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:44:10.305816 140700698428864 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:44:10Z
I0404 01:44:10.321409 140700698428864 evaluation.py:257] Starting evaluation at 2019-04-04T01:44:10Z
INFO:tensorflow:TPU job name worker
I0404 01:44:10.321731 140700698428864 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:44:10.411097 140700698428864 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:44:10.411904 140700698428864 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:44:10.579591 140700698428864 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:44:13.285984 140700698428864 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:44:13.309401 140700698428864 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:44:13.354784 140700698428864 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:44:27.904453 140700698428864 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:44:27.905517 140699729921792 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:44:27.906059 140699721529088 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:44:27.957551 140700698428864 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:44:27.978229 140700698428864 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:44:27.978677 140700698428864 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:44:29.233088 140700698428864 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:44:29.233469 140700698428864 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:44:29.233633 140700698428864 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:44:29.233830 140699729921792 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:44:29.233968 140699729921792 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:44:29.234142 140700698428864 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:44:29.234271 140700698428864 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:44:29.234345 140700698428864 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:44:29.234477 140699721529088 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:44:29.234586 140699721529088 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:44:29.234719 140700698428864 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:44:29.234827 140700698428864 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:44:29
I0404 01:44:29.322469 140700698428864 evaluation.py:277] Finished evaluation at 2019-04-04-01:44:29
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9008, global_step = 35, loss = 0.39774004
I0404 01:44:29.322827 140700698428864 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9008, global_step = 35, loss = 0.39774004
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:44:32.962497 140700698428864 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:44:33.695281 140700698428864 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.39774004, 'global_step': 35, 'accuracy': 0.9008}

warmup 10, LR 0.02
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342202976485...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342206719287...
Removing gs://bert-pretrain-data/mnist_log3/#1554342240588470...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342242129571...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342195054353...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342202237889...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342190.yangyouucb#1554342247387743...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342244636389...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342242807282...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342246605699...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342270689333...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342270.yangyouucb#1554342273466852...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:44:36.975615 139709383144896 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:44:37.117436 139709383144896 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f10836d9550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f1086040ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:44:37.232156 139709383144896 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f10836d9550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f1086040ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:44:37.232656 139709383144896 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:44:37.551208 139709383144896 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:44:37.554640: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:44:37.568694 139709383144896 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:44:37.569035 139709383144896 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:44:37.569644 139709383144896 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:44:37.569724 139709383144896 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:44:37.569789 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:44:37.570131 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:44:37.570281 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:44:37.570466 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:44:37.570538 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:44:37.570602 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:44:37.570663 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:44:37.570725 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:44:37.570786 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:44:37.570884 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:44:37.570951 139709383144896 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:44:37.575773 139709383144896 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:44:37.588270 139709383144896 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:44:39.108283 139709383144896 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:44:39.174278 139709383144896 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:44:39.357419 139709383144896 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:44:39.438277 139709383144896 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:44:39.464221 139709383144896 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:44:39.469185 139709383144896 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.629355 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.674442 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.724430 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.769845 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.818885 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.864881 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.915319 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:44:39.959201 139709383144896 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:44:39.984730 139709383144896 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:44:40.002276 139709383144896 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:44:43.266222 139709383144896 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:44:43.378617 139709383144896 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:44:44.059617 139709383144896 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:44:44.106956 139709383144896 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:44:46.719647 139709383144896 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:44:58.154761 139709383144896 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:44:58.155473 139709383144896 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:44:58.155864: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:44:58.162731 139709383144896 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:44:58.180459 139709383144896 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:44:58.193367 139709383144896 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:45:12.889338 139709383144896 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:45:12.890350 139708424247040 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:45:12.890927 139708415854336 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:45:12.950423 139709383144896 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:45:12.951081 139709383144896 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.18722376, step = 35
I0404 01:45:25.159337 139709383144896 basic_session_run_hooks.py:249] loss = 0.18722376, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:45:25.161689 139709383144896 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:45:36.559340 139709383144896 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:45:36.559676 139709383144896 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:45:36.559921 139708424247040 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:45:36.560050 139708424247040 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:45:36.560223 139709383144896 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:45:36.560353 139709383144896 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:45:36.560425 139709383144896 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:45:36.560564 139708415854336 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:45:36.560648 139708415854336 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:45:36.560770 139709383144896 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:45:36.560858 139709383144896 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.18722376.
I0404 01:45:36.722764 139709383144896 estimator.py:359] Loss for final step: 0.18722376.
INFO:tensorflow:training_loop marked as finished
I0404 01:45:36.723480 139709383144896 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:45:37.650742 139709383144896 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:45:38.882226 139709383144896 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:45:39.108971 139709383144896 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:45:39Z
I0404 01:45:39.123930 139709383144896 evaluation.py:257] Starting evaluation at 2019-04-04T01:45:39Z
INFO:tensorflow:TPU job name worker
I0404 01:45:39.124222 139709383144896 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:45:39.206552 139709383144896 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:45:39.207314 139709383144896 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:45:39.361375 139709383144896 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:45:41.900527 139709383144896 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:45:41.923691 139709383144896 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:45:41.971622 139709383144896 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:45:56.281548 139709383144896 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:45:56.282609 139708408010496 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:45:56.283627 139708399617792 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:45:56.336479 139709383144896 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:45:56.361787 139709383144896 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:45:56.362222 139709383144896 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:45:57.469933 139709383144896 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:45:57.470340 139709383144896 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:45:57.470431 139709383144896 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:45:57.470732 139708408010496 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:45:57.471064 139708408010496 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:45:57.471268 139709383144896 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:45:57.471479 139709383144896 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:45:57.471573 139709383144896 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:45:57.471766 139708399617792 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:45:57.471961 139708399617792 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:45:57.472135 139709383144896 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:45:57.472281 139709383144896 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:45:57
I0404 01:45:57.565033 139709383144896 evaluation.py:277] Finished evaluation at 2019-04-04-01:45:57
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9513, global_step = 35, loss = 0.18265048
I0404 01:45:57.565454 139709383144896 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9513, global_step = 35, loss = 0.18265048
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:46:01.269932 139709383144896 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:46:01.997577 139709383144896 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.18265048, 'global_step': 35, 'accuracy': 0.9513}

warmup 10, LR 0.04
Removing gs://bert-pretrain-data/mnist_log3/#1554342329744598...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342333737118...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342281.yangyouucb#1554342336338563...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342286232146...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342293117171...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342293802221...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342331277954...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342297704523...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342331952634...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342335598436...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342358844834...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342358.yangyouucb#1554342361775793...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:46:05.329648 140575988327872 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:46:05.493745 140575988327872 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fda491f4550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fda4bb5bad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:46:05.582873 140575988327872 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fda491f4550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fda4bb5bad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:46:05.585556 140575988327872 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:46:05.946126 140575988327872 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:46:05.949233: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:46:05.964020 140575988327872 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:46:05.964318 140575988327872 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:46:05.964652 140575988327872 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:46:05.964720 140575988327872 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:46:05.964783 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:46:05.965029 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:46:05.965100 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:46:05.965164 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:46:05.965246 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:46:05.965318 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:46:05.965379 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:46:05.965440 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:46:05.965549 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:46:05.965620 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:46:05.965678 140575988327872 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:46:05.970019 140575988327872 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:46:05.982522 140575988327872 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:46:07.746131 140575988327872 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:46:07.811103 140575988327872 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:46:07.990497 140575988327872 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:46:08.070969 140575988327872 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:46:08.097341 140575988327872 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:46:08.102546 140575988327872 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.267025 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.313314 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.368541 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.414499 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.464623 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.511859 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.565756 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:46:08.610111 140575988327872 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:46:08.635605 140575988327872 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:46:08.652894 140575988327872 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:46:11.774485 140575988327872 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:46:11.887828 140575988327872 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:46:12.582456 140575988327872 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:46:12.644006 140575988327872 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:46:14.944104 140575988327872 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:46:26.438663 140575988327872 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:46:26.439409 140575988327872 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:46:26.439825: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:46:26.445998 140575988327872 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:46:26.462794 140575988327872 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:46:26.475145 140575988327872 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:46:41.134330 140575988327872 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:46:41.135237 140574962353920 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:46:41.135732 140574749357824 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:46:41.193891 140575988327872 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:46:41.194561 140575988327872 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.12585971, step = 35
I0404 01:46:52.831574 140575988327872 basic_session_run_hooks.py:249] loss = 0.12585971, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:46:52.834176 140575988327872 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:47:04.689549 140575988327872 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:47:04.689899 140575988327872 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:47:04.690105 140574962353920 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:47:04.690227 140574962353920 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:47:04.690408 140575988327872 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:47:04.690551 140575988327872 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:47:04.690613 140575988327872 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:47:04.690749 140574749357824 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:47:04.690840 140574749357824 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:47:04.690980 140575988327872 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:47:04.691092 140575988327872 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.12585971.
I0404 01:47:04.874872 140575988327872 estimator.py:359] Loss for final step: 0.12585971.
INFO:tensorflow:training_loop marked as finished
I0404 01:47:04.875538 140575988327872 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:47:05.830219 140575988327872 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:47:07.093700 140575988327872 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:47:07.338216 140575988327872 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:47:07Z
I0404 01:47:07.356131 140575988327872 evaluation.py:257] Starting evaluation at 2019-04-04T01:47:07Z
INFO:tensorflow:TPU job name worker
I0404 01:47:07.356524 140575988327872 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:47:07.445787 140575988327872 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:47:07.446621 140575988327872 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:47:07.598565 140575988327872 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:47:10.085361 140575988327872 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:47:10.108254 140575988327872 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:47:10.154077 140575988327872 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:47:24.932869 140575988327872 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:47:24.933890 140574740965120 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:47:24.934439 140574732572416 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:47:24.987704 140575988327872 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:47:25.013861 140575988327872 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:47:25.014260 140575988327872 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:47:26.092982 140575988327872 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:47:26.093589 140575988327872 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:47:26.094156 140575988327872 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:47:26.094399 140574740965120 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:47:26.094510 140574740965120 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:47:26.094690 140575988327872 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:47:26.094806 140575988327872 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:47:26.094908 140575988327872 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:47:26.096247 140574732572416 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:47:26.096405 140574732572416 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:47:26.096553 140575988327872 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:47:26.096657 140575988327872 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:47:26
I0404 01:47:26.192744 140575988327872 evaluation.py:277] Finished evaluation at 2019-04-04-01:47:26
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.965, global_step = 35, loss = 0.12354438
I0404 01:47:26.193103 140575988327872 estimator.py:1979] Saving dict for global step 35: accuracy = 0.965, global_step = 35, loss = 0.12354438
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:47:29.754473 140575988327872 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:47:30.624815 140575988327872 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.12354438, 'global_step': 35, 'accuracy': 0.965}

warmup 10, LR 0.06
Removing gs://bert-pretrain-data/mnist_log3/#1554342417507168...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342370.yangyouucb#1554342424461085...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342421554398...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342382171395...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342385984075...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342419040756...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342374535219...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342419693841...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342381449961...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342423402513...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342447547191...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342447.yangyouucb#1554342450403465...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:47:33.919131 140554454771136 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:47:34.042431 140554454771136 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd5459f5550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd54835bad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:47:34.154633 140554454771136 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd5459f5550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd54835bad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:47:34.155523 140554454771136 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:47:34.480261 140554454771136 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:47:34.483305: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:47:34.498716 140554454771136 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:47:34.499022 140554454771136 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:47:34.499387 140554454771136 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:47:34.499459 140554454771136 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:47:34.499527 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:47:34.499737 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:47:34.499805 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:47:34.499872 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:47:34.499933 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:47:34.499994 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:47:34.500055 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:47:34.500113 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:47:34.500171 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:47:34.500228 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:47:34.500328 140554454771136 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:47:34.505256 140554454771136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:47:34.518415 140554454771136 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:47:36.114772 140554454771136 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:47:36.178297 140554454771136 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:47:36.354110 140554454771136 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:47:36.437063 140554454771136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:47:36.464560 140554454771136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:47:36.469901 140554454771136 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.634080 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.678831 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.727593 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.771924 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.820621 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.866303 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.915977 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:47:36.958858 140554454771136 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:47:36.983855 140554454771136 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:47:37.000894 140554454771136 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:47:40.197679 140554454771136 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:47:40.310985 140554454771136 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:47:41.003108 140554454771136 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:47:41.062995 140554454771136 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:47:43.463855 140554454771136 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:47:54.019299 140554454771136 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:47:54.020000 140554454771136 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:47:54.020396: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:47:54.025780 140554454771136 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:47:54.043509 140554454771136 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:47:54.064964 140554454771136 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:48:08.868117 140554454771136 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:48:08.869290 140553570727680 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:48:08.870343 140553562334976 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:48:08.927371 140554454771136 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:48:08.928064 140554454771136 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.07046809, step = 35
I0404 01:48:20.624409 140554454771136 basic_session_run_hooks.py:249] loss = 0.07046809, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:48:20.627325 140554454771136 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:48:32.078368 140554454771136 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:48:32.078727 140554454771136 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:48:32.079029 140553570727680 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:48:32.079158 140553570727680 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:48:32.079329 140554454771136 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:48:32.079447 140554454771136 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:48:32.079509 140554454771136 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:48:32.079627 140553562334976 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:48:32.079714 140553562334976 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:48:32.079835 140554454771136 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:48:32.079921 140554454771136 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.07046809.
I0404 01:48:32.241677 140554454771136 estimator.py:359] Loss for final step: 0.07046809.
INFO:tensorflow:training_loop marked as finished
I0404 01:48:32.242347 140554454771136 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:48:33.139801 140554454771136 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:48:34.369983 140554454771136 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:48:34.596347 140554454771136 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:48:34Z
I0404 01:48:34.612087 140554454771136 evaluation.py:257] Starting evaluation at 2019-04-04T01:48:34Z
INFO:tensorflow:TPU job name worker
I0404 01:48:34.612396 140554454771136 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:48:34.694540 140554454771136 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:48:34.695343 140554454771136 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:48:34.852114 140554454771136 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:48:37.402436 140554454771136 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:48:37.431508 140554454771136 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:48:37.483549 140554454771136 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 01:48:52.589677 140554454771136 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:48:52.590694 140553553442560 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:48:52.591604 140553207412480 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:48:52.646326 140554454771136 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:48:52.669827 140554454771136 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:48:52.670218 140554454771136 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:48:53.930605 140554454771136 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:48:53.930983 140554454771136 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:48:53.931066 140554454771136 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:48:53.931247 140553553442560 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:48:53.931385 140553553442560 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:48:53.931535 140554454771136 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:48:53.931646 140554454771136 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:48:53.931705 140554454771136 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:48:53.931828 140553207412480 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:48:53.931914 140553207412480 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:48:53.932032 140554454771136 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:48:53.932125 140554454771136 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:48:54
I0404 01:48:54.034051 140554454771136 evaluation.py:277] Finished evaluation at 2019-04-04-01:48:54
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9811, global_step = 35, loss = 0.064675175
I0404 01:48:54.034430 140554454771136 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9811, global_step = 35, loss = 0.064675175
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:48:57.562697 140554454771136 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:48:58.299949 140554454771136 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.064675175, 'global_step': 35, 'accuracy': 0.9811}

warmup 10, LR 0.08
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342509212886...
Removing gs://bert-pretrain-data/mnist_log3/#1554342505100153...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342458.yangyouucb#1554342511856762...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342463049559...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342469696660...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342473548388...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342506645412...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342468953763...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342507362244...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342511041865...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342535394043...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342535.yangyouucb#1554342538076760...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:49:01.586977 140088346486208 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:49:01.770737 140088346486208 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f68bf674550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f68c1fdbad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:49:01.901005 140088346486208 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f68bf674550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f68c1fdbad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:49:01.901556 140088346486208 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:49:02.219774 140088346486208 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:49:02.223020: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:49:02.237479 140088346486208 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:49:02.237823 140088346486208 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:49:02.238183 140088346486208 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:49:02.238256 140088346486208 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:49:02.238332 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:49:02.238533 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:49:02.238605 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:49:02.238687 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:49:02.238754 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:49:02.238821 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:49:02.238881 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:49:02.238943 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:49:02.239001 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:49:02.239064 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:49:02.239123 140088346486208 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:49:02.243758 140088346486208 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:49:02.256795 140088346486208 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:49:03.893919 140088346486208 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:49:03.956991 140088346486208 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:49:04.136462 140088346486208 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:49:04.216089 140088346486208 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:49:04.242505 140088346486208 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:49:04.247648 140088346486208 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.417897 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.463973 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.514369 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.557676 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.604868 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.649509 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.697868 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:49:04.740040 140088346486208 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:49:04.764755 140088346486208 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:49:04.781670 140088346486208 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:49:07.940598 140088346486208 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:49:08.058295 140088346486208 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:49:08.729558 140088346486208 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:49:08.797574 140088346486208 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:49:11.269402 140088346486208 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:49:22.059859 140088346486208 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:49:22.060579 140088346486208 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:49:22.060964: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:49:22.067406 140088346486208 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:49:22.083992 140088346486208 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:49:22.095690 140088346486208 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:49:36.930691 140088346486208 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:49:36.931751 140087379609344 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:49:36.932089 140087371216640 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:49:36.990544 140088346486208 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:49:36.991271 140088346486208 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.058765322, step = 35
I0404 01:49:48.378686 140088346486208 basic_session_run_hooks.py:249] loss = 0.058765322, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:49:48.381124 140088346486208 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:50:00.937153 140088346486208 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:50:00.937549 140088346486208 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:50:00.937887 140087379609344 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:50:00.938258 140087379609344 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:50:00.938510 140088346486208 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:50:00.938766 140088346486208 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:50:00.938851 140088346486208 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:50:00.939058 140087371216640 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:50:00.939230 140087371216640 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:50:00.939389 140088346486208 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:50:00.939523 140088346486208 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.058765322.
I0404 01:50:01.111417 140088346486208 estimator.py:359] Loss for final step: 0.058765322.
INFO:tensorflow:training_loop marked as finished
I0404 01:50:01.113524 140088346486208 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:50:01.913297 140088346486208 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:50:03.172643 140088346486208 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:50:03.411843 140088346486208 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:50:03Z
I0404 01:50:03.427603 140088346486208 evaluation.py:257] Starting evaluation at 2019-04-04T01:50:03Z
INFO:tensorflow:TPU job name worker
I0404 01:50:03.427891 140088346486208 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:50:03.513154 140088346486208 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:50:03.513997 140088346486208 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:50:03.686762 140088346486208 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:50:06.150836 140088346486208 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:50:06.181884 140088346486208 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:50:06.232495 140088346486208 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:50:21.030137 140088346486208 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:50:21.031014 140087371216640 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:50:21.031347 140087362823936 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:50:21.089041 140088346486208 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:50:21.110105 140088346486208 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:50:21.110737 140088346486208 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:50:22.254911 140088346486208 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:50:22.255311 140088346486208 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:50:22.255400 140088346486208 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:50:22.255630 140087371216640 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:50:22.255760 140087371216640 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:50:22.255908 140088346486208 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:50:22.256021 140088346486208 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:50:22.256083 140088346486208 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:50:22.256208 140087362823936 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:50:22.256306 140087362823936 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:50:22.256431 140088346486208 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:50:22.256535 140088346486208 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:50:22
I0404 01:50:22.350269 140088346486208 evaluation.py:277] Finished evaluation at 2019-04-04-01:50:22
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.0427754
I0404 01:50:22.350646 140088346486208 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9853, global_step = 35, loss = 0.0427754
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:50:25.995032 140088346486208 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:50:26.710788 140088346486208 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.0427754, 'global_step': 35, 'accuracy': 0.9853}

warmup 10, LR 0.1
Removing gs://bert-pretrain-data/mnist_log3/#1554342593769624...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342597955618...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342546.yangyouucb#1554342600703717...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342557632528...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342550858307...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342561596895...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342595393727...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342596241034...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342556908711...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342599878181...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342623641197...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342623.yangyouucb#1554342626477479...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:50:30.043579 140223194817984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:50:30.165424 140223194817984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f8824fd8510>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f882793fa90>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:50:30.266002 140223194817984 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f8824fd8510>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f882793fa90>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:50:30.266514 140223194817984 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:50:30.595344 140223194817984 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:50:30.598379: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:50:30.611445 140223194817984 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:50:30.611731 140223194817984 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:50:30.612061 140223194817984 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:50:30.612128 140223194817984 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:50:30.612191 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:50:30.612405 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:50:30.612474 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:50:30.612539 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:50:30.612598 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:50:30.612658 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:50:30.612718 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:50:30.612776 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:50:30.612854 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:50:30.612912 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:50:30.612978 140223194817984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:50:30.617320 140223194817984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:50:30.630006 140223194817984 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:50:32.225696 140223194817984 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:50:32.289210 140223194817984 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:50:32.464390 140223194817984 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:50:32.547024 140223194817984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:50:32.573798 140223194817984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 10 steps ++++++
I0404 01:50:32.578871 140223194817984 optimization.py:36] ++++++ warmup starts at step 0, for 10 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:32.748938 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:32.795387 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:32.845156 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:32.891551 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:32.940679 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:32.988019 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:33.040638 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:50:33.084911 140223194817984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:50:33.110234 140223194817984 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:50:33.128177 140223194817984 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:50:36.355057 140223194817984 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:50:36.472647 140223194817984 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:50:37.139219 140223194817984 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:50:37.187813 140223194817984 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:50:39.508934 140223194817984 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:50:50.180588 140223194817984 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:50:50.181396 140223194817984 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:50:50.181899: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:50:50.188663 140223194817984 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:50:50.207441 140223194817984 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:50:50.220192 140223194817984 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:51:05.022092 140223194817984 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:51:05.023174 140221958059776 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:51:05.023978 140221949667072 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:51:05.087106 140223194817984 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:51:05.087902 140223194817984 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.039420944, step = 35
I0404 01:51:17.800693 140223194817984 basic_session_run_hooks.py:249] loss = 0.039420944, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:51:17.803190 140223194817984 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:51:30.522319 140223194817984 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:51:30.522686 140223194817984 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:51:30.522924 140221958059776 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:51:30.523085 140221958059776 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:51:30.523271 140223194817984 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:51:30.523395 140223194817984 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:51:30.523457 140223194817984 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:51:30.523595 140221949667072 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:51:30.523680 140221949667072 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:51:30.523825 140223194817984 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:51:30.523917 140223194817984 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.039420944.
I0404 01:51:30.689479 140223194817984 estimator.py:359] Loss for final step: 0.039420944.
INFO:tensorflow:training_loop marked as finished
I0404 01:51:30.691637 140223194817984 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:51:31.618891 140223194817984 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:51:32.861401 140223194817984 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:51:33.090548 140223194817984 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:51:33Z
I0404 01:51:33.106379 140223194817984 evaluation.py:257] Starting evaluation at 2019-04-04T01:51:33Z
INFO:tensorflow:TPU job name worker
I0404 01:51:33.106666 140223194817984 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:51:33.188714 140223194817984 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:51:33.189544 140223194817984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:51:33.349989 140223194817984 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:51:35.783953 140223194817984 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:51:35.809072 140223194817984 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:51:35.856332 140223194817984 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:51:50.642884 140223194817984 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:51:50.643743 140221949667072 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:51:50.644248 140221941274368 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:51:50.697788 140223194817984 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:51:50.718635 140223194817984 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:51:50.719038 140223194817984 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:51:52.073889 140223194817984 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:51:52.074249 140223194817984 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:51:52.074345 140223194817984 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:51:52.074568 140221949667072 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:51:52.074706 140221949667072 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:51:52.074862 140223194817984 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:51:52.074975 140223194817984 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:51:52.075036 140223194817984 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:51:52.075162 140221941274368 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:51:52.075247 140221941274368 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:51:52.075381 140223194817984 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:51:52.075484 140223194817984 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:51:52
I0404 01:51:52.169373 140223194817984 evaluation.py:277] Finished evaluation at 2019-04-04-01:51:52
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9871, global_step = 35, loss = 0.046306934
I0404 01:51:52.169797 140223194817984 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9871, global_step = 35, loss = 0.046306934
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:51:55.788060 140223194817984 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:51:56.596596 140223194817984 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.046306934, 'global_step': 35, 'accuracy': 0.9871}

warmup 11, LR 0.001
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342687412166...
Removing gs://bert-pretrain-data/mnist_log3/#1554342683377483...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342634.yangyouucb#1554342690302150...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342639112103...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342645938044...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342649718952...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342645168307...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342684925987...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342685579553...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342689284203...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342713536244...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342713.yangyouucb#1554342716376498...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:51:59.981437 140682448614848 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:52:00.113373 140682448614848 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff312a65550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff3153ccad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:52:00.234234 140682448614848 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff312a65550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff3153ccad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:52:00.234745 140682448614848 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:52:00.580427 140682448614848 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:52:00.583444: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:52:00.597215 140682448614848 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:52:00.597578 140682448614848 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:52:00.597935 140682448614848 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:52:00.598006 140682448614848 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:52:00.598069 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:52:00.598298 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:52:00.598387 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:52:00.598454 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:52:00.598521 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:52:00.598587 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:52:00.598647 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:52:00.598707 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:52:00.598767 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:52:00.598825 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:52:00.598886 140682448614848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:52:00.603543 140682448614848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:52:00.615753 140682448614848 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:52:02.315151 140682448614848 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:52:02.378705 140682448614848 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:52:02.559072 140682448614848 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:52:02.639358 140682448614848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:52:02.665831 140682448614848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 01:52:02.670872 140682448614848 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:02.831020 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:02.876316 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:02.925875 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:02.971189 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:03.020014 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:03.065677 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:03.115161 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:52:03.158262 140682448614848 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:52:03.183330 140682448614848 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:52:03.200514 140682448614848 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:52:06.283824 140682448614848 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:52:06.391978 140682448614848 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:52:07.107959 140682448614848 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:52:07.157023 140682448614848 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:52:09.564052 140682448614848 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:52:20.280534 140682448614848 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:52:20.281236 140682448614848 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:52:20.281749: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:52:20.288722 140682448614848 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:52:20.307707 140682448614848 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:52:20.325061 140682448614848 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:52:35.037003 140682448614848 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:52:35.038007 140681494382336 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:52:35.038541 140681485989632 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:52:35.102914 140682448614848 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:52:35.103595 140682448614848 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.1310635, step = 35
I0404 01:52:47.093388 140682448614848 basic_session_run_hooks.py:249] loss = 2.1310635, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:52:47.095796 140682448614848 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:52:59.827521 140682448614848 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:52:59.827858 140682448614848 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:52:59.828174 140681494382336 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:52:59.828572 140681494382336 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:52:59.828831 140682448614848 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:52:59.829138 140682448614848 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:52:59.829217 140682448614848 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:52:59.829413 140681485989632 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:52:59.829663 140681485989632 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:52:59.829917 140682448614848 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:52:59.830117 140682448614848 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.1310635.
I0404 01:52:59.989181 140682448614848 estimator.py:359] Loss for final step: 2.1310635.
INFO:tensorflow:training_loop marked as finished
I0404 01:52:59.989931 140682448614848 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:53:00.929213 140682448614848 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:53:02.159768 140682448614848 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:53:02.388653 140682448614848 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:53:02Z
I0404 01:53:02.403922 140682448614848 evaluation.py:257] Starting evaluation at 2019-04-04T01:53:02Z
INFO:tensorflow:TPU job name worker
I0404 01:53:02.404226 140682448614848 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:53:02.486627 140682448614848 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:53:02.487442 140682448614848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:53:02.676367 140682448614848 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:53:05.138416 140682448614848 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:53:05.162717 140682448614848 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:53:05.211088 140682448614848 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 01:53:20.263149 140682448614848 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:53:20.264029 140681478145792 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:53:20.264609 140681469753088 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:53:20.318355 140682448614848 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:53:20.340204 140682448614848 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:53:20.340604 140682448614848 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:53:21.574331 140682448614848 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:53:21.574745 140682448614848 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:53:21.574834 140682448614848 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:53:21.575021 140681478145792 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:53:21.575145 140681478145792 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:53:21.575300 140682448614848 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:53:21.575408 140682448614848 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:53:21.575475 140682448614848 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:53:21.575608 140681469753088 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:53:21.575692 140681469753088 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:53:21.575818 140682448614848 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:53:21.575908 140682448614848 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:53:21
I0404 01:53:21.674328 140682448614848 evaluation.py:277] Finished evaluation at 2019-04-04-01:53:21
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.6595, global_step = 35, loss = 2.1240435
I0404 01:53:21.674688 140682448614848 estimator.py:1979] Saving dict for global step 35: accuracy = 0.6595, global_step = 35, loss = 2.1240435
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:53:25.235455 140682448614848 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:53:26.239372 140682448614848 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 2.1240435, 'global_step': 35, 'accuracy': 0.6595}

warmup 11, LR 0.002
Removing gs://bert-pretrain-data/mnist_log3/#1554342772363606...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342776452987...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342736024025...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342724.yangyouucb#1554342779604316...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342739830940...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342773938003...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342774624905...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342729159132...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342735317931...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342778434747...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342802982057...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342803.yangyouucb#1554342805997400...
/ [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:53:29.543395 140563992118720 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:53:29.659267 140563992118720 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd77e17a550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd780ae1ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:53:29.755686 140563992118720 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd77e17a550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd780ae1ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:53:29.756258 140563992118720 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:53:30.104768 140563992118720 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:53:30.107797: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:53:30.123253 140563992118720 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:53:30.123568 140563992118720 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:53:30.123903 140563992118720 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:53:30.123979 140563992118720 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:53:30.124042 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:53:30.124233 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:53:30.124315 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:53:30.124380 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:53:30.124443 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:53:30.124505 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:53:30.124583 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:53:30.124643 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:53:30.124701 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:53:30.124761 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:53:30.124819 140563992118720 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:53:30.129173 140563992118720 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:53:30.141302 140563992118720 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:53:31.762310 140563992118720 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:53:31.825956 140563992118720 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:53:32.001666 140563992118720 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:53:32.082801 140563992118720 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:53:32.109586 140563992118720 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 01:53:32.114670 140563992118720 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.278486 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.324803 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.378314 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.423583 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.472479 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.521168 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.571403 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:53:32.614269 140563992118720 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:53:32.639375 140563992118720 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:53:32.656734 140563992118720 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:53:35.749906 140563992118720 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:53:35.860476 140563992118720 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:53:36.525583 140563992118720 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:53:36.570971 140563992118720 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:53:38.938340 140563992118720 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:53:49.459325 140563992118720 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:53:49.460027 140563992118720 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:53:49.460411: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:53:49.466660 140563992118720 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:53:49.485712 140563992118720 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:53:49.498856 140563992118720 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 01:54:04.630769 140563992118720 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:54:04.631727 140563105953536 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:54:04.632323 140563097560832 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:54:04.694672 140563992118720 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:54:04.695707 140563992118720 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 1.9189358, step = 35
I0404 01:54:17.226829 140563992118720 basic_session_run_hooks.py:249] loss = 1.9189358, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:54:17.230648 140563992118720 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:54:29.108855 140563992118720 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:54:29.109172 140563992118720 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:54:29.109421 140563105953536 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:54:29.109617 140563105953536 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:54:29.109808 140563992118720 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:54:29.109970 140563992118720 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:54:29.110060 140563992118720 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:54:29.110214 140563097560832 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:54:29.110333 140563097560832 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:54:29.110486 140563992118720 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:54:29.110594 140563992118720 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 1.9189358.
I0404 01:54:29.285200 140563992118720 estimator.py:359] Loss for final step: 1.9189358.
INFO:tensorflow:training_loop marked as finished
I0404 01:54:29.285904 140563992118720 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:54:30.196453 140563992118720 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:54:31.423036 140563992118720 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:54:31.657763 140563992118720 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:54:31Z
I0404 01:54:31.673873 140563992118720 evaluation.py:257] Starting evaluation at 2019-04-04T01:54:31Z
INFO:tensorflow:TPU job name worker
I0404 01:54:31.674173 140563992118720 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:54:31.757956 140563992118720 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:54:31.758754 140563992118720 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:54:31.920691 140563992118720 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:54:34.385031 140563992118720 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:54:34.409256 140563992118720 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:54:34.455182 140563992118720 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:54:49.176114 140563992118720 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:54:49.176983 140563089716992 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:54:49.177445 140563081324288 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:54:49.232178 140563992118720 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:54:49.259912 140563992118720 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:54:49.260329 140563992118720 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:54:50.418899 140563992118720 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:54:50.419254 140563992118720 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:54:50.419353 140563992118720 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:54:50.419569 140563089716992 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:54:50.419732 140563089716992 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:54:50.419877 140563992118720 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:54:50.419996 140563992118720 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:54:50.420056 140563992118720 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:54:50.420180 140563081324288 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:54:50.420299 140563081324288 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:54:50.420433 140563992118720 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:54:50.420540 140563992118720 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:54:50
I0404 01:54:50.512343 140563992118720 evaluation.py:277] Finished evaluation at 2019-04-04-01:54:50
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.7343, global_step = 35, loss = 1.9029223
I0404 01:54:50.512703 140563992118720 estimator.py:1979] Saving dict for global step 35: accuracy = 0.7343, global_step = 35, loss = 1.9029223
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:54:54.351069 140563992118720 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:54:55.018764 140563992118720 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 1.9029223, 'global_step': 35, 'accuracy': 0.7343}

warmup 11, LR 0.005
Removing gs://bert-pretrain-data/mnist_log3/#1554342861874833...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342825277672...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342865815171...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342814.yangyouucb#1554342868801250...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342829019036...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342818488101...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342824530354...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342863399905...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342864093523...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342867724997...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342891893565...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342891.yangyouucb#1554342894793034...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:54:58.276180 140264840476096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:54:58.415560 140264840476096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f91d743d550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f91d9da4ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:54:58.520493 140264840476096 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f91d743d550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f91d9da4ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:54:58.520991 140264840476096 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:54:58.847750 140264840476096 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:54:58.850688: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:54:58.865166 140264840476096 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:54:58.865576 140264840476096 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:54:58.865922 140264840476096 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:54:58.866000 140264840476096 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:54:58.866077 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:54:58.866301 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:54:58.866370 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:54:58.866444 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:54:58.866549 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:54:58.866611 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:54:58.866672 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:54:58.866729 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:54:58.866789 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:54:58.866847 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:54:58.866906 140264840476096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:54:58.871237 140264840476096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:54:58.884215 140264840476096 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:55:00.502814 140264840476096 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:55:00.570389 140264840476096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:55:00.744509 140264840476096 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:55:00.824151 140264840476096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:55:00.850368 140264840476096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 01:55:00.855479 140264840476096 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.017117 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.066262 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.120335 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.164664 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.213326 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.259442 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.309861 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:55:01.353974 140264840476096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:55:01.379390 140264840476096 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:55:01.396773 140264840476096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:55:04.420720 140264840476096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:55:04.537839 140264840476096 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:55:05.220122 140264840476096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:55:05.279793 140264840476096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:55:07.543148 140264840476096 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:55:17.927412 140264840476096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:55:17.928128 140264840476096 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:55:17.928529: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:55:17.934788 140264840476096 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:55:17.951561 140264840476096 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:55:17.964472 140264840476096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 01:55:33.007667 140264840476096 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:55:33.008706 140263884314368 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:55:33.009191 140263875921664 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:55:33.067687 140264840476096 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:55:33.068392 140264840476096 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.923522, step = 35
I0404 01:55:45.337676 140264840476096 basic_session_run_hooks.py:249] loss = 0.923522, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:55:45.340203 140264840476096 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:55:57.335438 140264840476096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:55:57.335820 140264840476096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:55:57.336081 140263884314368 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:55:57.336211 140263884314368 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:55:57.336410 140264840476096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:55:57.336543 140264840476096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:55:57.336616 140264840476096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:55:57.336744 140263875921664 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:55:57.336838 140263875921664 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:55:57.336973 140264840476096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:55:57.337070 140264840476096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.923522.
I0404 01:55:57.502397 140264840476096 estimator.py:359] Loss for final step: 0.923522.
INFO:tensorflow:training_loop marked as finished
I0404 01:55:57.503077 140264840476096 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:55:58.402344 140264840476096 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:55:59.662362 140264840476096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:55:59.893959 140264840476096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:55:59Z
I0404 01:55:59.909446 140264840476096 evaluation.py:257] Starting evaluation at 2019-04-04T01:55:59Z
INFO:tensorflow:TPU job name worker
I0404 01:55:59.909765 140264840476096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:55:59.993124 140264840476096 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:55:59.993946 140264840476096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:56:00.160742 140264840476096 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:56:02.821723 140264840476096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:56:02.856264 140264840476096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:56:02.931616 140264840476096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:56:17.800035 140264840476096 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:56:17.801136 140263868077824 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:56:17.802257 140263859685120 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:56:17.854027 140264840476096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:56:17.875848 140264840476096 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:56:17.876239 140264840476096 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:56:19.086245 140264840476096 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:56:19.086630 140264840476096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:56:19.086711 140264840476096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:56:19.086918 140263868077824 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:56:19.087064 140263868077824 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:56:19.087223 140264840476096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:56:19.087347 140264840476096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:56:19.087409 140264840476096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:56:19.087599 140263859685120 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:56:19.087698 140263859685120 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:56:19.087822 140264840476096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:56:19.087914 140264840476096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:56:19
I0404 01:56:19.190350 140264840476096 evaluation.py:277] Finished evaluation at 2019-04-04-01:56:19
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.841, global_step = 35, loss = 0.85321313
I0404 01:56:19.190709 140264840476096 estimator.py:1979] Saving dict for global step 35: accuracy = 0.841, global_step = 35, loss = 0.85321313
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:56:22.771236 140264840476096 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:56:23.540815 140264840476096 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.85321313, 'global_step': 35, 'accuracy': 0.841}

warmup 11, LR 0.006
Removing gs://bert-pretrain-data/mnist_log3/#1554342949961938...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554342954027535...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554342913909642...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554342917456790...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342902.yangyouucb#1554342957064998...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342907138779...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554342951555107...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554342913214214...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554342952247997...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554342956025968...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554342980512193...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554342980.yangyouucb#1554342983314005...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:56:26.848946 140270316709312 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:56:26.955183 140270316709312 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f931dac8550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f932042fad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:56:27.068090 140270316709312 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f931dac8550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f932042fad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:56:27.068603 140270316709312 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:56:27.391208 140270316709312 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:56:27.394254: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:56:27.408518 140270316709312 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:56:27.408795 140270316709312 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:56:27.409111 140270316709312 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:56:27.409178 140270316709312 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:56:27.409240 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:56:27.409472 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:56:27.409605 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:56:27.409677 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:56:27.409756 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:56:27.409821 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:56:27.409882 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:56:27.409940 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:56:27.410000 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:56:27.410058 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:56:27.410115 140270316709312 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:56:27.414602 140270316709312 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:56:27.427180 140270316709312 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:56:29.009968 140270316709312 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:56:29.078887 140270316709312 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:56:29.254973 140270316709312 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:56:29.336117 140270316709312 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:56:29.362814 140270316709312 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 01:56:29.367938 140270316709312 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.538556 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.584696 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.635951 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.682102 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.732492 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.781147 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.834539 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:56:29.880450 140270316709312 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:56:29.906635 140270316709312 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:56:29.925153 140270316709312 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:56:32.958575 140270316709312 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:56:33.077852 140270316709312 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:56:33.740556 140270316709312 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:56:33.810962 140270316709312 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:56:36.431569 140270316709312 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:56:47.017127 140270316709312 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:56:47.018013 140270316709312 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:56:47.018441: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:56:47.025212 140270316709312 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:56:47.042376 140270316709312 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:56:47.054455 140270316709312 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:57:02.039416 140270316709312 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:57:02.040541 140269424191232 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:57:02.041465 140269415798528 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:57:02.101520 140270316709312 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:57:02.102252 140270316709312 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.8476496, step = 35
I0404 01:57:13.640166 140270316709312 basic_session_run_hooks.py:249] loss = 0.8476496, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:57:13.642390 140270316709312 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:57:25.396147 140270316709312 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:57:25.396513 140270316709312 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:57:25.396752 140269424191232 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:57:25.396883 140269424191232 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:57:25.397063 140270316709312 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:57:25.397181 140270316709312 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:57:25.397242 140270316709312 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:57:25.397408 140269415798528 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:57:25.397546 140269415798528 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:57:25.397691 140270316709312 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:57:25.397785 140270316709312 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.8476496.
I0404 01:57:25.569098 140270316709312 estimator.py:359] Loss for final step: 0.8476496.
INFO:tensorflow:training_loop marked as finished
I0404 01:57:25.569928 140270316709312 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:57:26.449213 140270316709312 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:57:27.723290 140270316709312 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:57:27.957329 140270316709312 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:57:27Z
I0404 01:57:27.973668 140270316709312 evaluation.py:257] Starting evaluation at 2019-04-04T01:57:27Z
INFO:tensorflow:TPU job name worker
I0404 01:57:27.973959 140270316709312 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:57:28.062918 140270316709312 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:57:28.063726 140270316709312 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:57:28.220200 140270316709312 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:57:31.700978 140270316709312 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:57:31.724258 140270316709312 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:57:31.800873 140270316709312 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:57:46.729007 140270316709312 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:57:46.729958 140269415274240 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:57:46.730314 140268934264576 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:57:46.798475 140270316709312 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:57:46.825387 140270316709312 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:57:46.826225 140270316709312 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:57:47.936172 140270316709312 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:57:47.936578 140270316709312 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:57:47.936665 140270316709312 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:57:47.936850 140269415274240 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:57:47.936976 140269415274240 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:57:47.937154 140270316709312 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:57:47.937266 140270316709312 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:57:47.937335 140270316709312 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:57:47.937460 140268934264576 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:57:47.937637 140268934264576 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:57:47.937763 140270316709312 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:57:47.937863 140270316709312 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:57:48
I0404 01:57:48.031560 140270316709312 evaluation.py:277] Finished evaluation at 2019-04-04-01:57:48
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8462, global_step = 35, loss = 0.7993326
I0404 01:57:48.031938 140270316709312 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8462, global_step = 35, loss = 0.7993326
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:57:51.647044 140270316709312 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:57:52.473083 140270316709312 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.7993326, 'global_step': 35, 'accuracy': 0.8462}

warmup 11, LR 0.008
Removing gs://bert-pretrain-data/mnist_log3/#1554343038085953...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554342991.yangyouucb#1554343045172822...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343042157431...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554342996031073...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343002811521...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343006557806...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343039638109...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343002105039...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343040296988...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343044090114...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343069271219...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343069.yangyouucb#1554343072245568...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:57:55.810767 139876861265344 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:57:55.928868 139876861265344 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f3781e6bf90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f37847d5ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:57:56.049576 139876861265344 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f3781e6bf90>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f37847d5ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:57:56.050081 139876861265344 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:57:56.367559 139876861265344 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:57:56.370496: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:57:56.385438 139876861265344 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:57:56.385770 139876861265344 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:57:56.386111 139876861265344 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:57:56.386178 139876861265344 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:57:56.386246 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:57:56.386466 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:57:56.386543 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:57:56.386606 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:57:56.386667 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:57:56.386728 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:57:56.386786 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:57:56.386845 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:57:56.386903 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:57:56.386960 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:57:56.387047 139876861265344 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:57:56.391453 139876861265344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:57:56.404114 139876861265344 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:57:57.823069 139876861265344 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:57:57.889367 139876861265344 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:57:58.067374 139876861265344 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:57:58.144571 139876861265344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:57:58.170149 139876861265344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 01:57:58.175115 139876861265344 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.340966 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.386292 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.437391 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.482697 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.532035 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.578382 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.628590 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:57:58.672045 139876861265344 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:57:58.697225 139876861265344 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:57:58.714792 139876861265344 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:58:01.994141 139876861265344 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:58:02.112824 139876861265344 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:58:02.822900 139876861265344 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:58:02.870352 139876861265344 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:58:05.101634 139876861265344 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:58:15.603298 139876861265344 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:58:15.604048 139876861265344 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:58:15.604461: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:58:15.610321 139876861265344 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:58:15.626257 139876861265344 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:58:15.637985 139876861265344 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:58:30.633382 139876861265344 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:58:30.634524 139875976984320 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:58:30.635358 139875968591616 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:58:30.695782 139876861265344 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:58:30.696583 139876861265344 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.65391195, step = 35
I0404 01:58:42.987157 139876861265344 basic_session_run_hooks.py:249] loss = 0.65391195, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:58:42.989234 139876861265344 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 01:58:54.984594 139876861265344 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:58:54.984898 139876861265344 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:58:54.985107 139875976984320 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:58:54.985222 139875976984320 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:58:54.985471 139876861265344 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:58:54.985635 139876861265344 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:58:54.985718 139876861265344 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:58:54.985840 139875968591616 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:58:54.985924 139875968591616 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:58:54.986042 139876861265344 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:58:54.986133 139876861265344 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.65391195.
I0404 01:58:55.150732 139876861265344 estimator.py:359] Loss for final step: 0.65391195.
INFO:tensorflow:training_loop marked as finished
I0404 01:58:55.151381 139876861265344 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 01:58:56.106026 139876861265344 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:58:57.388329 139876861265344 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 01:58:57.611566 139876861265344 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T01:58:57Z
I0404 01:58:57.626499 139876861265344 evaluation.py:257] Starting evaluation at 2019-04-04T01:58:57Z
INFO:tensorflow:TPU job name worker
I0404 01:58:57.626785 139876861265344 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:58:57.707081 139876861265344 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 01:58:57.707824 139876861265344 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:58:57.875173 139876861265344 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 01:59:00.331008 139876861265344 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:59:00.354696 139876861265344 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 01:59:00.402369 139876861265344 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 01:59:15.555412 139876861265344 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:59:15.556267 139875959699200 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:59:15.557375 139875609212672 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:59:15.612090 139876861265344 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 01:59:15.633091 139876861265344 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 01:59:15.633567 139876861265344 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 01:59:16.953615 139876861265344 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 01:59:16.954031 139876861265344 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 01:59:16.954113 139876861265344 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 01:59:16.954385 139875959699200 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 01:59:16.954721 139875959699200 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 01:59:16.954957 139876861265344 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 01:59:16.955214 139876861265344 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 01:59:16.955317 139876861265344 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 01:59:16.955529 139875609212672 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 01:59:16.955734 139875609212672 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 01:59:16.955909 139876861265344 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 01:59:16.956039 139876861265344 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-01:59:17
I0404 01:59:17.052175 139876861265344 evaluation.py:277] Finished evaluation at 2019-04-04-01:59:17
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8578, global_step = 35, loss = 0.6165401
I0404 01:59:17.052608 139876861265344 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8578, global_step = 35, loss = 0.6165401
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 01:59:20.695661 139876861265344 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 01:59:21.578685 139876861265344 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.6165401, 'global_step': 35, 'accuracy': 0.8578}

warmup 11, LR 0.01
Removing gs://bert-pretrain-data/mnist_log3/#1554343128202842...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343132144719...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343080.yangyouucb#1554343134765900...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343084712557...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343090644204...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343091336594...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343095150784...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343129717438...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343130386742...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343134027899...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343158.yangyouucb#1554343161333933...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343158284477...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 01:59:24.948385 140651993679296 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 01:59:25.083956 140651993679296 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7febfb64e5d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7febfdfb5ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 01:59:25.197359 140651993679296 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7febfb64e5d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7febfdfb5ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 01:59:25.197897 140651993679296 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 01:59:25.568092 140651993679296 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 01:59:25.571615: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 01:59:25.585139 140651993679296 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 01:59:25.585434 140651993679296 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 01:59:25.585855 140651993679296 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 01:59:25.585923 140651993679296 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 01:59:25.586024 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 01:59:25.586242 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 01:59:25.586323 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 01:59:25.586414 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 01:59:25.586484 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 01:59:25.586554 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 01:59:25.586612 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 01:59:25.586672 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 01:59:25.586730 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 01:59:25.586787 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 01:59:25.586844 140651993679296 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 01:59:25.591227 140651993679296 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 01:59:25.603494 140651993679296 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:59:27.012700 140651993679296 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 01:59:27.078645 140651993679296 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 01:59:27.259960 140651993679296 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 01:59:27.340488 140651993679296 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 01:59:27.366461 140651993679296 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 01:59:27.371541 140651993679296 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.539311 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.584073 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.632754 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.676876 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.725127 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.772149 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.823580 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 01:59:27.868114 140651993679296 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 01:59:27.893657 140651993679296 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 01:59:27.911056 140651993679296 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 01:59:31.161720 140651993679296 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 01:59:31.272142 140651993679296 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 01:59:31.930222 140651993679296 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 01:59:31.988722 140651993679296 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 01:59:34.291970 140651993679296 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 01:59:44.709719 140651993679296 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 01:59:44.710469 140651993679296 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 01:59:44.710836: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 01:59:44.717174 140651993679296 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 01:59:44.734707 140651993679296 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 01:59:44.748810 140651993679296 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 01:59:59.681859 140651993679296 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 01:59:59.682986 140651035350784 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 01:59:59.683718 140651026958080 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 01:59:59.741951 140651993679296 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 01:59:59.742732 140651993679296 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.4180761, step = 35
I0404 02:00:12.054429 140651993679296 basic_session_run_hooks.py:249] loss = 0.4180761, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:00:12.057331 140651993679296 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:00:24.250508 140651993679296 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:00:24.250843 140651993679296 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:00:24.251068 140651035350784 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:00:24.251180 140651035350784 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:00:24.251370 140651993679296 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:00:24.251490 140651993679296 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:00:24.251559 140651993679296 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:00:24.251702 140651026958080 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:00:24.251805 140651026958080 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:00:24.251945 140651993679296 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:00:24.252032 140651993679296 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.4180761.
I0404 02:00:24.419928 140651993679296 estimator.py:359] Loss for final step: 0.4180761.
INFO:tensorflow:training_loop marked as finished
I0404 02:00:24.420640 140651993679296 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:00:25.331252 140651993679296 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:00:26.593647 140651993679296 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:00:26.820003 140651993679296 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:00:26Z
I0404 02:00:26.835191 140651993679296 evaluation.py:257] Starting evaluation at 2019-04-04T02:00:26Z
INFO:tensorflow:TPU job name worker
I0404 02:00:26.835498 140651993679296 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:00:26.915762 140651993679296 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:00:26.916539 140651993679296 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:00:27.074687 140651993679296 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:00:29.540242 140651993679296 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:00:29.564644 140651993679296 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:00:29.616576 140651993679296 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 02:00:44.386429 140651993679296 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:00:44.387458 140651019114240 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:00:44.388164 140651010721536 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:00:44.439970 140651993679296 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:00:44.459669 140651993679296 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:00:44.460072 140651993679296 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:00:45.613451 140651993679296 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:00:45.614155 140651993679296 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:00:45.614237 140651993679296 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:00:45.614494 140651019114240 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:00:45.614808 140651019114240 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:00:45.614984 140651993679296 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:00:45.615149 140651993679296 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:00:45.615211 140651993679296 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:00:45.615389 140651010721536 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:00:45.615551 140651010721536 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:00:45.615693 140651993679296 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:00:45.615825 140651993679296 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:00:45
I0404 02:00:45.707940 140651993679296 evaluation.py:277] Finished evaluation at 2019-04-04-02:00:45
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.899, global_step = 35, loss = 0.40929422
I0404 02:00:45.708307 140651993679296 estimator.py:1979] Saving dict for global step 35: accuracy = 0.899, global_step = 35, loss = 0.40929422
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:00:49.531060 140651993679296 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:00:50.433979 140651993679296 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.40929422, 'global_step': 35, 'accuracy': 0.899}

warmup 11, LR 0.02
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343221373840...
Removing gs://bert-pretrain-data/mnist_log3/#1554343217415593...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343180517856...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343169.yangyouucb#1554343224022436...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343179809888...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343184277696...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343218942679...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343219632733...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343173924261...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343223225807...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343247027747...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343247.yangyouucb#1554343250199123...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:00:53.695013 140204342130112 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:00:53.843895 140204342130112 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f83c1485550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f83c3decad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:00:53.942819 140204342130112 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f83c1485550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f83c3decad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:00:53.943341 140204342130112 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:00:54.257993 140204342130112 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:00:54.261092: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:00:54.274780 140204342130112 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:00:54.275104 140204342130112 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:00:54.275451 140204342130112 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:00:54.275522 140204342130112 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:00:54.275584 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:00:54.275785 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:00:54.275854 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:00:54.275917 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:00:54.275988 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:00:54.276048 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:00:54.276108 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:00:54.276166 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:00:54.276243 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:00:54.276315 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:00:54.276376 140204342130112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:00:54.280730 140204342130112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:00:54.293173 140204342130112 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:00:55.715153 140204342130112 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:00:55.780879 140204342130112 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:00:55.964392 140204342130112 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:00:56.048310 140204342130112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:00:56.075766 140204342130112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 02:00:56.080979 140204342130112 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.246095 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.292402 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.344120 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.389934 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.439083 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.485460 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.536495 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:00:56.581068 140204342130112 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:00:56.606688 140204342130112 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:00:56.624104 140204342130112 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:00:59.566598 140204342130112 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:00:59.682704 140204342130112 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:01:00.374475 140204342130112 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:01:00.430031 140204342130112 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:01:02.776072 140204342130112 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:01:13.399658 140204342130112 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:01:13.400394 140204342130112 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:01:13.400787: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:01:13.406960 140204342130112 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:01:13.422683 140204342130112 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:01:13.435336 140204342130112 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 02:01:28.559297 140204342130112 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:01:28.560369 140203321857792 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:01:28.560892 140203313465088 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:01:28.618972 140204342130112 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:01:28.619683 140204342130112 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.18931793, step = 35
I0404 02:01:41.075851 140204342130112 basic_session_run_hooks.py:249] loss = 0.18931793, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:01:41.078663 140204342130112 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:01:53.476933 140204342130112 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:01:53.477243 140204342130112 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:01:53.477673 140203321857792 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:01:53.478193 140203321857792 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:01:53.478600 140204342130112 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:01:53.478871 140204342130112 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:01:53.478951 140204342130112 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:01:53.479135 140203313465088 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:01:53.479331 140203313465088 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:01:53.479499 140204342130112 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:01:53.479643 140204342130112 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.18931793.
I0404 02:01:53.644855 140204342130112 estimator.py:359] Loss for final step: 0.18931793.
INFO:tensorflow:training_loop marked as finished
I0404 02:01:53.645605 140204342130112 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:01:54.613687 140204342130112 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:01:55.892456 140204342130112 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:01:56.118267 140204342130112 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:01:56Z
I0404 02:01:56.133544 140204342130112 evaluation.py:257] Starting evaluation at 2019-04-04T02:01:56Z
INFO:tensorflow:TPU job name worker
I0404 02:01:56.133831 140204342130112 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:01:56.215528 140204342130112 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:01:56.216337 140204342130112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:01:56.374232 140204342130112 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:01:58.743884 140204342130112 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:01:58.766941 140204342130112 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:01:58.859252 140204342130112 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 02:02:13.871175 140204342130112 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:02:13.872267 140203100468992 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:02:13.872982 140203092076288 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:02:13.926143 140204342130112 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:02:13.946676 140204342130112 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:02:13.947084 140204342130112 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:02:15.060333 140204342130112 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:02:15.060766 140204342130112 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:02:15.060857 140204342130112 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:02:15.061162 140203100468992 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:02:15.061558 140203100468992 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:02:15.061795 140204342130112 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:02:15.062028 140204342130112 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:02:15.062094 140204342130112 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:02:15.062259 140203092076288 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:02:15.062453 140203092076288 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:02:15.062608 140204342130112 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:02:15.062774 140204342130112 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:02:15
I0404 02:02:15.170701 140204342130112 evaluation.py:277] Finished evaluation at 2019-04-04-02:02:15
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9482, global_step = 35, loss = 0.18767008
I0404 02:02:15.171078 140204342130112 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9482, global_step = 35, loss = 0.18767008
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:02:19.106192 140204342130112 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:02:19.823416 140204342130112 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.18767008, 'global_step': 35, 'accuracy': 0.9482}

warmup 11, LR 0.04
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343310521001...
Removing gs://bert-pretrain-data/mnist_log3/#1554343306445551...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343269184179...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343258.yangyouucb#1554343313253962...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343272918891...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343308032110...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343308727068...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343262367551...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343268484724...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343312408270...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343336525688...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343336.yangyouucb#1554343339597821...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:02:23.146270 140539262842304 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:02:23.262629 140539262842304 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd1bc1ca810>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd1beb34ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:02:23.380527 140539262842304 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd1bc1ca810>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd1beb34ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:02:23.381005 140539262842304 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:02:23.700376 140539262842304 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:02:23.703200: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:02:23.716466 140539262842304 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:02:23.716772 140539262842304 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:02:23.717106 140539262842304 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:02:23.717173 140539262842304 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:02:23.717237 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:02:23.717475 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:02:23.717597 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:02:23.717668 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:02:23.717737 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:02:23.717798 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:02:23.717859 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:02:23.717920 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:02:23.717979 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:02:23.718039 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:02:23.718099 140539262842304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:02:23.722158 140539262842304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:02:23.733894 140539262842304 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:02:25.207616 140539262842304 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:02:25.275441 140539262842304 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:02:25.451776 140539262842304 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:02:25.535478 140539262842304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:02:25.562586 140539262842304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 02:02:25.567840 140539262842304 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:25.735480 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:25.782676 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:25.835052 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:25.882100 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:25.933166 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:25.982568 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:26.035594 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:02:26.080732 140539262842304 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:02:26.107142 140539262842304 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:02:26.125211 140539262842304 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:02:29.420265 140539262842304 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:02:29.543210 140539262842304 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:02:30.231921 140539262842304 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:02:30.295486 140539262842304 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:02:32.828598 140539262842304 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:02:44.482465 140539262842304 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:02:44.485030 140539262842304 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:02:44.485632: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:02:44.491974 140539262842304 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:02:44.511357 140539262842304 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:02:44.524166 140539262842304 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 02:02:59.514013 140539262842304 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:02:59.514978 140538175026944 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:02:59.515592 140538166634240 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:02:59.574982 140539262842304 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:02:59.575659 140539262842304 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.11615725, step = 35
I0404 02:03:11.618258 140539262842304 basic_session_run_hooks.py:249] loss = 0.11615725, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:03:11.620568 140539262842304 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:03:24.192533 140539262842304 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:03:24.192876 140539262842304 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:03:24.193105 140538175026944 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:03:24.193242 140538175026944 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:03:24.193484 140539262842304 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:03:24.193655 140539262842304 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:03:24.193731 140539262842304 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:03:24.193856 140538166634240 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:03:24.193948 140538166634240 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:03:24.194080 140539262842304 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:03:24.194173 140539262842304 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.11615725.
I0404 02:03:24.361439 140539262842304 estimator.py:359] Loss for final step: 0.11615725.
INFO:tensorflow:training_loop marked as finished
I0404 02:03:24.362184 140539262842304 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:03:25.257050 140539262842304 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:03:26.486826 140539262842304 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:03:26.714858 140539262842304 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:03:26Z
I0404 02:03:26.730151 140539262842304 evaluation.py:257] Starting evaluation at 2019-04-04T02:03:26Z
INFO:tensorflow:TPU job name worker
I0404 02:03:26.730449 140539262842304 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:03:26.810909 140539262842304 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:03:26.811707 140539262842304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:03:26.970189 140539262842304 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:03:31.221879 140539262842304 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:03:31.245656 140539262842304 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:03:31.292619 140539262842304 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 02:03:46.282393 140539262842304 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:03:46.283231 140538158241536 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:03:46.283560 140538149848832 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:03:46.341070 140539262842304 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:03:46.366014 140539262842304 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:03:46.366415 140539262842304 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:03:47.542016 140539262842304 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:03:47.542387 140539262842304 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:03:47.542469 140539262842304 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:03:47.542711 140538158241536 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:03:47.542835 140538158241536 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:03:47.542989 140539262842304 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:03:47.543095 140539262842304 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:03:47.543154 140539262842304 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:03:47.543270 140538149848832 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:03:47.543364 140538149848832 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:03:47.543489 140539262842304 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:03:47.543581 140539262842304 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:03:47
I0404 02:03:47.632375 140539262842304 evaluation.py:277] Finished evaluation at 2019-04-04-02:03:47
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9664, global_step = 35, loss = 0.13036962
I0404 02:03:47.632797 140539262842304 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9664, global_step = 35, loss = 0.13036962
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:03:51.281343 140539262842304 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:03:52.023132 140539262842304 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.13036962, 'global_step': 35, 'accuracy': 0.9664}

warmup 11, LR 0.06
Removing gs://bert-pretrain-data/mnist_log3/#1554343397119967...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343360230664...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343401208948...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343347.yangyouucb#1554343403961698...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343359589012...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343352425559...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343364016595...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343398705261...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343399436428...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343403267170...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343428870165...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343428.yangyouucb#1554343431788668...
/ [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:03:55.375058 140705608975808 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:03:55.495105 140705608975808 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff8771d6550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff879b3dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:03:55.603889 140705608975808 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff8771d6550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff879b3dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:03:55.604444 140705608975808 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:03:55.923156 140705608975808 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:03:55.926263: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:03:55.939738 140705608975808 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:03:55.940030 140705608975808 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:03:55.940416 140705608975808 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:03:55.940495 140705608975808 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:03:55.940560 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:03:55.940773 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:03:55.940840 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:03:55.940907 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:03:55.940967 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:03:55.941025 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:03:55.941112 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:03:55.941170 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:03:55.941229 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:03:55.941298 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:03:55.941364 140705608975808 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:03:55.946346 140705608975808 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:03:55.959903 140705608975808 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:03:57.394210 140705608975808 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:03:57.458827 140705608975808 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:03:57.635458 140705608975808 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:03:57.718101 140705608975808 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:03:57.745534 140705608975808 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 02:03:57.750701 140705608975808 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:57.916980 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:57.963596 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:58.014777 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:58.061140 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:58.111881 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:58.159805 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:58.211754 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:03:58.257025 140705608975808 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:03:58.282924 140705608975808 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:03:58.300611 140705608975808 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:04:01.356190 140705608975808 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:04:01.475759 140705608975808 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:04:02.153584 140705608975808 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:04:02.215395 140705608975808 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:04:04.619071 140705608975808 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:04:15.502482 140705608975808 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:04:15.503196 140705608975808 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:04:15.503577: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:04:15.509927 140705608975808 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:04:15.527784 140705608975808 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:04:15.540138 140705608975808 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 02:04:30.875041 140705608975808 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:04:30.876010 140704655333120 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:04:30.876514 140704646940416 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:04:30.934287 140705608975808 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:04:30.934925 140705608975808 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.086221114, step = 35
I0404 02:04:43.132597 140705608975808 basic_session_run_hooks.py:249] loss = 0.086221114, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:04:43.135560 140705608975808 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:04:55.891094 140705608975808 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:04:55.891433 140705608975808 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:04:55.891694 140704655333120 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:04:55.891829 140704655333120 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:04:55.892011 140705608975808 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:04:55.892153 140705608975808 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:04:55.892231 140705608975808 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:04:55.892378 140704646940416 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:04:55.892465 140704646940416 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:04:55.892610 140705608975808 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:04:55.892705 140705608975808 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.086221114.
I0404 02:04:56.061394 140705608975808 estimator.py:359] Loss for final step: 0.086221114.
INFO:tensorflow:training_loop marked as finished
I0404 02:04:56.062119 140705608975808 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:04:56.956996 140705608975808 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:04:58.188265 140705608975808 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:04:58.424882 140705608975808 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:04:58Z
I0404 02:04:58.441018 140705608975808 evaluation.py:257] Starting evaluation at 2019-04-04T02:04:58Z
INFO:tensorflow:TPU job name worker
I0404 02:04:58.441309 140705608975808 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:04:58.527606 140705608975808 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:04:58.528377 140705608975808 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:04:58.685403 140705608975808 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:05:01.149108 140705608975808 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:05:01.173051 140705608975808 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:05:01.222480 140705608975808 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 15 seconds
I0404 02:05:16.298209 140705608975808 tpu_estimator.py:510] Initialized TPU in 15 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:05:16.299245 140704639096576 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:05:16.299971 140704630703872 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:05:16.356570 140705608975808 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:05:16.380352 140705608975808 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:05:16.380760 140705608975808 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:05:17.586348 140705608975808 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:05:17.586745 140705608975808 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:05:17.586826 140705608975808 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:05:17.587050 140704639096576 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:05:17.587199 140704639096576 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:05:17.587361 140705608975808 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:05:17.587475 140705608975808 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:05:17.587536 140705608975808 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:05:17.587665 140704630703872 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:05:17.587770 140704630703872 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:05:17.587893 140705608975808 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:05:17.587994 140705608975808 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:05:17
I0404 02:05:17.684647 140705608975808 evaluation.py:277] Finished evaluation at 2019-04-04-02:05:17
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9796, global_step = 35, loss = 0.07151265
I0404 02:05:17.685003 140705608975808 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9796, global_step = 35, loss = 0.07151265
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:05:21.449604 140705608975808 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:05:22.219758 140705608975808 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.07151265, 'global_step': 35, 'accuracy': 0.9796}

warmup 11, LR 0.08
Removing gs://bert-pretrain-data/mnist_log3/#1554343488558992...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343492541278...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343439.yangyouucb#1554343495667899...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343451168195...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343444212298...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343455053607...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343450513398...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343490112613...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343490814301...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343494570111...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343518974678...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343519.yangyouucb#1554343521987250...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:05:25.592108 140263003563456 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:05:25.736340 140263003563456 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9169c6c550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f916c5d3ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:05:25.839049 140263003563456 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f9169c6c550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f916c5d3ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:05:25.839572 140263003563456 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:05:26.168742 140263003563456 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:05:26.171697: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:05:26.186589 140263003563456 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:05:26.186880 140263003563456 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:05:26.187230 140263003563456 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:05:26.187315 140263003563456 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:05:26.187381 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:05:26.187589 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:05:26.187659 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:05:26.187722 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:05:26.187783 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:05:26.187844 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:05:26.187902 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:05:26.187963 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:05:26.188021 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:05:26.188080 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:05:26.188138 140263003563456 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:05:26.192399 140263003563456 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:05:26.204457 140263003563456 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:05:27.573252 140263003563456 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:05:27.637789 140263003563456 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:05:27.813632 140263003563456 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:05:27.893412 140263003563456 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:05:27.919393 140263003563456 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 02:05:27.924485 140263003563456 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.085262 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.130157 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.179899 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.225286 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.275213 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.323570 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.377574 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:05:28.421515 140263003563456 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:05:28.447163 140263003563456 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:05:28.464732 140263003563456 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:05:31.568474 140263003563456 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:05:31.685055 140263003563456 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:05:32.420557 140263003563456 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:05:32.467547 140263003563456 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:05:34.757086 140263003563456 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:05:46.366799 140263003563456 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:05:46.367532 140263003563456 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:05:46.367913: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:05:46.374824 140263003563456 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:05:46.393451 140263003563456 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:05:46.405927 140263003563456 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 02:06:01.402072 140263003563456 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:06:01.403098 140262119290624 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:06:01.403785 140262110897920 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:06:01.467155 140263003563456 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:06:01.467863 140263003563456 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.071558006, step = 35
I0404 02:06:13.648571 140263003563456 basic_session_run_hooks.py:249] loss = 0.071558006, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:06:13.650511 140263003563456 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:06:25.807063 140263003563456 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:06:25.807426 140263003563456 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:06:25.808120 140262119290624 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:06:25.808485 140262119290624 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:06:25.808744 140263003563456 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:06:25.809043 140263003563456 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:06:25.809119 140263003563456 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:06:25.809355 140262110897920 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:06:25.809602 140262110897920 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:06:25.809892 140263003563456 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:06:25.810123 140263003563456 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.071558006.
I0404 02:06:25.979044 140263003563456 estimator.py:359] Loss for final step: 0.071558006.
INFO:tensorflow:training_loop marked as finished
I0404 02:06:25.979700 140263003563456 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:06:26.856957 140263003563456 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:06:28.105287 140263003563456 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:06:28.334595 140263003563456 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:06:28Z
I0404 02:06:28.350020 140263003563456 evaluation.py:257] Starting evaluation at 2019-04-04T02:06:28Z
INFO:tensorflow:TPU job name worker
I0404 02:06:28.350316 140263003563456 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:06:28.432523 140263003563456 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:06:28.433301 140263003563456 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:06:28.589099 140263003563456 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:06:31.082844 140263003563456 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:06:31.109158 140263003563456 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:06:31.159213 140263003563456 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 14 seconds
I0404 02:06:46.118052 140263003563456 tpu_estimator.py:510] Initialized TPU in 14 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:06:46.118977 140262102005504 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:06:46.119944 140261753616128 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:06:46.180150 140263003563456 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:06:46.203367 140263003563456 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:06:46.205055 140263003563456 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:06:47.419954 140263003563456 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:06:47.420331 140263003563456 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:06:47.420413 140263003563456 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:06:47.420654 140262102005504 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:06:47.420990 140262102005504 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:06:47.421173 140263003563456 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:06:47.421372 140263003563456 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:06:47.421441 140263003563456 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:06:47.421675 140261753616128 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:06:47.421902 140261753616128 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:06:47.422080 140263003563456 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:06:47.422234 140263003563456 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:06:47
I0404 02:06:47.512010 140263003563456 evaluation.py:277] Finished evaluation at 2019-04-04-02:06:47
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9833, global_step = 35, loss = 0.046480924
I0404 02:06:47.512407 140263003563456 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9833, global_step = 35, loss = 0.046480924
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:06:51.569417 140263003563456 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:06:52.230653 140263003563456 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.046480924, 'global_step': 35, 'accuracy': 0.9833}

warmup 11, LR 0.1
Removing gs://bert-pretrain-data/mnist_log3/#1554343578434200...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343582408093...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343542068117...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343530.yangyouucb#1554343585584479...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343545924072...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343579964021...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343534323570...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343580647976...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343541407554...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343584515976...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343608917893...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343609.yangyouucb#1554343612008054...
/ [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:06:55.580178 140204426057152 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:06:55.707310 140204426057152 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f83c648cd50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f83c8df6a90>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:06:55.813395 140204426057152 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f83c648cd50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f83c8df6a90>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:06:55.813966 140204426057152 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:06:56.140901 140204426057152 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:06:56.143731: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:06:56.158024 140204426057152 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:06:56.158361 140204426057152 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:06:56.158689 140204426057152 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:06:56.158755 140204426057152 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:06:56.158824 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:06:56.159018 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:06:56.159086 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:06:56.159151 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:06:56.159236 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:06:56.159347 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:06:56.159411 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:06:56.159471 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:06:56.159529 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:06:56.159586 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:06:56.159645 140204426057152 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:06:56.163847 140204426057152 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:06:56.175944 140204426057152 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:06:57.614379 140204426057152 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:06:57.680335 140204426057152 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:06:57.860685 140204426057152 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:06:57.943850 140204426057152 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:06:57.971329 140204426057152 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 11 steps ++++++
I0404 02:06:57.976564 140204426057152 optimization.py:36] ++++++ warmup starts at step 0, for 11 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.142976 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.188889 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.238475 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.284257 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.334009 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.382133 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.436537 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:06:58.481734 140204426057152 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:06:58.508115 140204426057152 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:06:58.526401 140204426057152 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:07:01.573559 140204426057152 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:07:01.690926 140204426057152 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:07:02.391858 140204426057152 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:07:02.439666 140204426057152 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:07:05.066983 140204426057152 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:07:16.741630 140204426057152 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:07:16.742307 140204426057152 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:07:16.742684: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:07:16.749617 140204426057152 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:07:16.766541 140204426057152 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:07:16.779222 140204426057152 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 52 seconds
I0404 02:08:09.020773 140204426057152 tpu_estimator.py:510] Initialized TPU in 52 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:08:09.021879 140203536660224 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:08:09.022411 140203528267520 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:08:09.083292 140204426057152 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:08:09.083983 140204426057152 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.041858044, step = 35
I0404 02:08:20.590590 140204426057152 basic_session_run_hooks.py:249] loss = 0.041858044, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:08:20.593225 140204426057152 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:08:31.996234 140204426057152 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:08:31.996593 140204426057152 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:08:31.996825 140203536660224 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:08:31.996967 140203536660224 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:08:31.997199 140204426057152 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:08:31.997350 140204426057152 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:08:31.997412 140204426057152 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:08:31.997606 140203528267520 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:08:31.997721 140203528267520 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:08:31.997844 140204426057152 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:08:31.997948 140204426057152 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.041858044.
I0404 02:08:32.170169 140204426057152 estimator.py:359] Loss for final step: 0.041858044.
INFO:tensorflow:training_loop marked as finished
I0404 02:08:32.170922 140204426057152 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:08:32.959208 140204426057152 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:08:34.199150 140204426057152 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:08:34.435406 140204426057152 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:08:34Z
I0404 02:08:34.451462 140204426057152 evaluation.py:257] Starting evaluation at 2019-04-04T02:08:34Z
INFO:tensorflow:TPU job name worker
I0404 02:08:34.451761 140204426057152 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:08:34.536735 140204426057152 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:08:34.537574 140204426057152 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:08:34.701252 140204426057152 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:08:37.619930 140204426057152 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:08:37.648376 140204426057152 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:08:37.696568 140204426057152 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 75 seconds
I0404 02:09:53.023973 140204426057152 tpu_estimator.py:510] Initialized TPU in 75 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:09:53.024992 140203520423680 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:09:53.025439 140203512030976 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:09:53.077058 140204426057152 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:09:53.101052 140204426057152 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:09:53.101648 140204426057152 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:09:54.178067 140204426057152 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:09:54.178534 140204426057152 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:09:54.178626 140204426057152 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:09:54.178822 140203520423680 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:09:54.178965 140203520423680 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:09:54.179182 140204426057152 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:09:54.179399 140204426057152 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:09:54.179472 140204426057152 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:09:54.179621 140203512030976 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:09:54.179719 140203512030976 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:09:54.179944 140204426057152 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:09:54.180097 140204426057152 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:09:54
I0404 02:09:54.270001 140204426057152 evaluation.py:277] Finished evaluation at 2019-04-04-02:09:54
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9879, global_step = 35, loss = 0.036154035
I0404 02:09:54.270490 140204426057152 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9879, global_step = 35, loss = 0.036154035
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:09:58.255676 140204426057152 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:09:59.003717 140204426057152 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.036154035, 'global_step': 35, 'accuracy': 0.9879}

warmup 12, LR 0.001
Removing gs://bert-pretrain-data/mnist_log3/#1554343705074539...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343708873371...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343632569208...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343620.yangyouucb#1554343711772350...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343636293789...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343624654661...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343706623732...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343631856161...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343707221485...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343710769543...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554343795656687...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554343795.yangyouucb#1554343798747472...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:10:02.320583 140340724757952 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:10:02.560376 140340724757952 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa382521550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fa384e88ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:10:02.686321 140340724757952 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa382521550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fa384e88ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:10:02.686836 140340724757952 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:10:03.028752 140340724757952 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:10:03.031907: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:10:03.045593 140340724757952 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:10:03.045878 140340724757952 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:10:03.046191 140340724757952 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:10:03.046258 140340724757952 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:10:03.046369 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:10:03.046567 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:10:03.046636 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:10:03.046701 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:10:03.046766 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:10:03.046838 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:10:03.046897 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:10:03.046957 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:10:03.047015 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:10:03.047074 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:10:03.047149 140340724757952 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:10:03.051235 140340724757952 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:10:03.063359 140340724757952 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:10:04.529767 140340724757952 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:10:04.597157 140340724757952 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:10:04.774108 140340724757952 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:10:04.856064 140340724757952 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:10:04.882661 140340724757952 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:10:04.887785 140340724757952 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.053982 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.099570 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.149941 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.195827 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.245249 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.292179 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.342875 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:10:05.386342 140340724757952 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:10:05.413758 140340724757952 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:10:05.431042 140340724757952 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:10:08.687345 140340724757952 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:10:08.801080 140340724757952 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:10:09.499351 140340724757952 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:10:09.558500 140340724757952 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:10:12.129442 140340724757952 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:10:23.428706 140340724757952 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:10:23.429446 140340724757952 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:10:23.429908: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:10:23.436861 140340724757952 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:10:23.456127 140340724757952 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:10:23.468400 140340724757952 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:11:37.046730 140340724757952 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:11:37.048104 140339834763008 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:11:37.049515 140339826370304 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:11:37.108439 140340724757952 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:11:37.109189 140340724757952 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.1595962, step = 35
I0404 02:11:49.603846 140340724757952 basic_session_run_hooks.py:249] loss = 2.1595962, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:11:49.607737 140340724757952 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:12:01.093723 140340724757952 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:12:01.094041 140340724757952 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:12:01.094346 140339834763008 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:12:01.094655 140339834763008 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:12:01.094947 140340724757952 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:12:01.095212 140340724757952 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:12:01.095298 140340724757952 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:12:01.095462 140339826370304 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:12:01.095616 140339826370304 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:12:01.095845 140340724757952 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:12:01.096033 140340724757952 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.1595962.
I0404 02:12:01.266417 140340724757952 estimator.py:359] Loss for final step: 2.1595962.
INFO:tensorflow:training_loop marked as finished
I0404 02:12:01.267426 140340724757952 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:12:02.071516 140340724757952 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:12:03.305809 140340724757952 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:12:03.535206 140340724757952 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:12:03Z
I0404 02:12:03.550707 140340724757952 evaluation.py:257] Starting evaluation at 2019-04-04T02:12:03Z
INFO:tensorflow:TPU job name worker
I0404 02:12:03.551006 140340724757952 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:12:03.632878 140340724757952 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:12:03.633677 140340724757952 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:12:03.807109 140340724757952 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:12:06.301729 140340724757952 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:12:06.326132 140340724757952 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:12:06.380306 140340724757952 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:13:21.054202 140340724757952 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:13:21.055360 140339818526464 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:13:21.055964 140339810133760 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:13:21.109467 140340724757952 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:13:21.133965 140340724757952 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:13:21.135154 140340724757952 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:13:22.556435 140340724757952 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:13:22.556842 140340724757952 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:13:22.556921 140340724757952 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:13:22.557121 140339818526464 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:13:22.557246 140339818526464 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:13:22.557414 140340724757952 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:13:22.557580 140340724757952 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:13:22.557645 140340724757952 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:13:22.557765 140339810133760 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:13:22.557859 140339810133760 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:13:22.557986 140340724757952 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:13:22.558084 140340724757952 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:13:22
I0404 02:13:22.646780 140340724757952 evaluation.py:277] Finished evaluation at 2019-04-04-02:13:22
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.6253, global_step = 35, loss = 2.1557152
I0404 02:13:22.647145 140340724757952 estimator.py:1979] Saving dict for global step 35: accuracy = 0.6253, global_step = 35, loss = 2.1557152
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:13:26.258915 140340724757952 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:13:26.901115 140340724757952 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 2.1557152, 'global_step': 35, 'accuracy': 0.6253}

warmup 12, LR 0.002
Removing gs://bert-pretrain-data/mnist_log3/#1554343914202416...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554343918289117...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554343807.yangyouucb#1554343920859512...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554343915832198...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554343811684467...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554343819189323...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554343916541470...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554343822967407...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554343818544192...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554343920074882...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554344004067548...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554344004.yangyouucb#1554344006674749...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:13:30.298290 140672369853888 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:13:30.430974 140672369853888 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff0b9e8a550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff0bc7f1ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:13:30.525919 140672369853888 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff0b9e8a550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff0bc7f1ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:13:30.526418 140672369853888 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:13:30.845613 140672369853888 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:13:30.848646: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:13:30.863573 140672369853888 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:13:30.863854 140672369853888 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:13:30.864180 140672369853888 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:13:30.864245 140672369853888 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:13:30.864367 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:13:30.864582 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:13:30.864650 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:13:30.864734 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:13:30.864798 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:13:30.864861 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:13:30.864931 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:13:30.864989 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:13:30.865051 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:13:30.865108 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:13:30.865166 140672369853888 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:13:30.869522 140672369853888 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:13:30.881417 140672369853888 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:13:32.433195 140672369853888 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:13:32.497876 140672369853888 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:13:32.671969 140672369853888 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:13:32.751468 140672369853888 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:13:32.777398 140672369853888 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:13:32.782474 140672369853888 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:32.946628 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:32.993352 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:33.043210 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:33.089255 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:33.140366 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:33.188196 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:33.240178 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:13:33.284941 140672369853888 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:13:33.310817 140672369853888 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:13:33.328773 140672369853888 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:13:36.420845 140672369853888 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:13:36.538055 140672369853888 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:13:37.220752 140672369853888 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:13:37.286576 140672369853888 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:13:39.890188 140672369853888 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:13:50.339021 140672369853888 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:13:50.341278 140672369853888 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:13:50.341893: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:13:50.349862 140672369853888 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:13:50.367419 140672369853888 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:13:50.381635 140672369853888 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:15:05.020407 140672369853888 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:15:05.021416 140671485720320 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:15:05.021992 140671477327616 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:15:05.079651 140672369853888 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:15:05.080337 140672369853888 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 1.91859, step = 35
I0404 02:15:16.256709 140672369853888 basic_session_run_hooks.py:249] loss = 1.91859, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:15:16.259279 140672369853888 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:15:29.692389 140672369853888 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:15:29.692728 140672369853888 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:15:29.692953 140671485720320 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:15:29.693089 140671485720320 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:15:29.693285 140672369853888 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:15:29.693424 140672369853888 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:15:29.693577 140672369853888 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:15:29.693751 140671477327616 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:15:29.693862 140671477327616 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:15:29.693996 140672369853888 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:15:29.694097 140672369853888 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 1.91859.
I0404 02:15:29.863610 140672369853888 estimator.py:359] Loss for final step: 1.91859.
INFO:tensorflow:training_loop marked as finished
I0404 02:15:29.864300 140672369853888 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:15:30.761182 140672369853888 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:15:32.060774 140672369853888 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:15:32.300045 140672369853888 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:15:32Z
I0404 02:15:32.316339 140672369853888 evaluation.py:257] Starting evaluation at 2019-04-04T02:15:32Z
INFO:tensorflow:TPU job name worker
I0404 02:15:32.316634 140672369853888 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:15:32.404071 140672369853888 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:15:32.404932 140672369853888 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:15:32.571737 140672369853888 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:15:35.182642 140672369853888 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:15:35.210644 140672369853888 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:15:35.261209 140672369853888 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:16:48.990675 140672369853888 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:16:48.991652 140671468435200 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:16:48.992217 140671117686528 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:16:49.043318 140672369853888 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:16:49.063750 140672369853888 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:16:49.064155 140672369853888 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:16:50.378165 140672369853888 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:16:50.378604 140672369853888 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:16:50.378699 140672369853888 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:16:50.378974 140671468435200 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:16:50.379354 140671468435200 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:16:50.379555 140672369853888 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:16:50.379782 140672369853888 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:16:50.379848 140672369853888 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:16:50.380014 140671117686528 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:16:50.380215 140671117686528 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:16:50.380454 140672369853888 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:16:50.380661 140672369853888 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:16:50
I0404 02:16:50.469176 140672369853888 evaluation.py:277] Finished evaluation at 2019-04-04-02:16:50
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.7545, global_step = 35, loss = 1.9070247
I0404 02:16:50.469599 140672369853888 estimator.py:1979] Saving dict for global step 35: accuracy = 0.7545, global_step = 35, loss = 1.9070247
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:16:54.247885 140672369853888 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:16:54.996507 140672369853888 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 1.9070247, 'global_step': 35, 'accuracy': 0.7545}

warmup 12, LR 0.005
Removing gs://bert-pretrain-data/mnist_log3/#1554344122702460...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554344026194685...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554344126754162...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554344014.yangyouucb#1554344129458540...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554344029882249...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554344019483970...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554344124231827...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554344025556140...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554344124916125...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554344128628554...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554344211843692...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554344211.yangyouucb#1554344214755091...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:16:58.287592 140067462882752 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:16:58.440821 140067462882752 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f63e2a4c550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f63e53b3ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:16:58.562906 140067462882752 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f63e2a4c550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f63e53b3ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:16:58.563400 140067462882752 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:16:58.895366 140067462882752 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:16:58.898278: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:16:58.916795 140067462882752 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:16:58.917098 140067462882752 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:16:58.917440 140067462882752 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:16:58.917556 140067462882752 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:16:58.917620 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:16:58.917820 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:16:58.917889 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:16:58.917953 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:16:58.918018 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:16:58.918087 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:16:58.918148 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:16:58.918205 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:16:58.918297 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:16:58.918358 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:16:58.918416 140067462882752 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:16:58.922780 140067462882752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:16:58.935183 140067462882752 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:17:00.359627 140067462882752 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:17:00.425642 140067462882752 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:17:00.606956 140067462882752 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:17:00.688394 140067462882752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:17:00.714663 140067462882752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:17:00.719696 140067462882752 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:00.883573 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:00.929783 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:00.979530 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:01.025124 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:01.075846 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:01.123749 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:01.175925 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:17:01.220700 140067462882752 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:17:01.246515 140067462882752 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:17:01.264106 140067462882752 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:17:04.247585 140067462882752 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:17:04.362349 140067462882752 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:17:05.029160 140067462882752 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:17:05.089310 140067462882752 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:17:07.473206 140067462882752 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:17:19.227592 140067462882752 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:17:19.228353 140067462882752 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:17:19.228734: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:17:19.234535 140067462882752 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:17:19.250607 140067462882752 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:17:19.263014 140067462882752 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:18:33.014692 140067462882752 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:18:33.017225 140066508752640 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:18:33.019170 140066500359936 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:18:33.078308 140067462882752 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:18:33.079058 140067462882752 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 1.1071889, step = 35
I0404 02:18:45.415313 140067462882752 basic_session_run_hooks.py:249] loss = 1.1071889, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:18:45.417912 140067462882752 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:18:58.057868 140067462882752 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:18:58.058203 140067462882752 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:18:58.058428 140066508752640 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:18:58.058545 140066508752640 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:18:58.058727 140067462882752 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:18:58.058842 140067462882752 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:18:58.058903 140067462882752 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:18:58.059036 140066500359936 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:18:58.059120 140066500359936 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:18:58.059252 140067462882752 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:18:58.059376 140067462882752 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 1.1071889.
I0404 02:18:58.232877 140067462882752 estimator.py:359] Loss for final step: 1.1071889.
INFO:tensorflow:training_loop marked as finished
I0404 02:18:58.233628 140067462882752 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:18:59.016998 140067462882752 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:19:00.254991 140067462882752 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:19:00.481911 140067462882752 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:19:00Z
I0404 02:19:00.497339 140067462882752 evaluation.py:257] Starting evaluation at 2019-04-04T02:19:00Z
INFO:tensorflow:TPU job name worker
I0404 02:19:00.497653 140067462882752 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:19:00.580955 140067462882752 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:19:00.581793 140067462882752 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:19:00.746912 140067462882752 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:19:03.224605 140067462882752 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:19:03.248369 140067462882752 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:19:03.304605 140067462882752 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:20:17.022191 140067462882752 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:20:17.023435 140066492516096 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:20:17.024162 140066484123392 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:20:17.076472 140067462882752 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:20:17.096632 140067462882752 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:20:17.097048 140067462882752 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:20:18.167960 140067462882752 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:20:18.168313 140067462882752 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:20:18.168392 140067462882752 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:20:18.168567 140066492516096 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:20:18.168692 140066492516096 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:20:18.168838 140067462882752 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:20:18.168941 140067462882752 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:20:18.169002 140067462882752 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:20:18.176033 140066484123392 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:20:18.176323 140066484123392 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:20:18.176738 140067462882752 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:20:18.176892 140067462882752 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:20:18
I0404 02:20:18.269730 140067462882752 evaluation.py:277] Finished evaluation at 2019-04-04-02:20:18
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8331, global_step = 35, loss = 1.0552733
I0404 02:20:18.270133 140067462882752 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8331, global_step = 35, loss = 1.0552733
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:20:21.963745 140067462882752 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:20:22.803900 140067462882752 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 1.0552733, 'global_step': 35, 'accuracy': 0.8331}

warmup 12, LR 0.006
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554344334740525...
Removing gs://bert-pretrain-data/mnist_log3/#1554344330780102...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554344222.yangyouucb#1554344337834914...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554344227052752...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554344332931574...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554344234768842...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554344332294928...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554344238766204...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554344234031963...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554344336700539...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554344419611914...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554344419.yangyouucb#1554344422582605...
/ [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:20:26.202244 140421494859200 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:20:26.332182 140421494859200 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fb65097db10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fb6532e7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:20:26.470824 140421494859200 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fb65097db10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fb6532e7ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:20:26.471330 140421494859200 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:20:26.794553 140421494859200 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:20:26.797596: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:20:26.812720 140421494859200 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:20:26.813016 140421494859200 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:20:26.813364 140421494859200 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:20:26.813442 140421494859200 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:20:26.813560 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:20:26.813821 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:20:26.813890 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:20:26.813960 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:20:26.814021 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:20:26.814080 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:20:26.814138 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:20:26.814204 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:20:26.814275 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:20:26.814336 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:20:26.814393 140421494859200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:20:26.818610 140421494859200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:20:26.830507 140421494859200 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:20:28.233036 140421494859200 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:20:28.299988 140421494859200 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:20:28.484446 140421494859200 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:20:28.565316 140421494859200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:20:28.591758 140421494859200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:20:28.596805 140421494859200 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:28.760770 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:28.807725 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:28.859606 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:28.905988 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:28.956515 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:29.004441 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:29.057972 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:20:29.104068 140421494859200 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:20:29.130424 140421494859200 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:20:29.148363 140421494859200 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:20:32.518220 140421494859200 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:20:32.650661 140421494859200 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:20:33.354378 140421494859200 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:20:33.404135 140421494859200 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:20:35.854599 140421494859200 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:20:46.399158 140421494859200 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:20:46.399902 140421494859200 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:20:46.400292: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:20:46.406234 140421494859200 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:20:46.423880 140421494859200 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:20:46.435198 140421494859200 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:22:00.986099 140421494859200 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:22:00.987152 140420678031104 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:22:00.987669 140420264752896 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:22:01.048266 140421494859200 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:22:01.049391 140421494859200 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.8443408, step = 35
I0404 02:22:13.574515 140421494859200 basic_session_run_hooks.py:249] loss = 0.8443408, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:22:13.576658 140421494859200 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:22:25.843581 140421494859200 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:22:25.843899 140421494859200 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:22:25.844134 140420678031104 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:22:25.844342 140420678031104 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:22:25.844547 140421494859200 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:22:25.844692 140421494859200 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:22:25.844768 140421494859200 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:22:25.844902 140420264752896 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:22:25.845002 140420264752896 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:22:25.845124 140421494859200 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:22:25.845221 140421494859200 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.8443408.
I0404 02:22:26.019701 140421494859200 estimator.py:359] Loss for final step: 0.8443408.
INFO:tensorflow:training_loop marked as finished
I0404 02:22:26.020381 140421494859200 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:22:26.788229 140421494859200 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:22:28.005686 140421494859200 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:22:28.235182 140421494859200 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:22:28Z
I0404 02:22:28.250597 140421494859200 evaluation.py:257] Starting evaluation at 2019-04-04T02:22:28Z
INFO:tensorflow:TPU job name worker
I0404 02:22:28.250885 140421494859200 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:22:28.332776 140421494859200 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:22:28.333640 140421494859200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:22:28.487898 140421494859200 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:22:30.914333 140421494859200 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:22:30.939583 140421494859200 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:22:30.985703 140421494859200 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:23:45.026988 140421494859200 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:23:45.028764 140420247967488 tpu_estimator.py:482] Starting outfeed thread controller.
I0404 02:23:45.028153 140420256360192 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:23:45.080563 140421494859200 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:23:45.106885 140421494859200 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:23:45.107285 140421494859200 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:23:46.301069 140421494859200 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:23:46.301445 140421494859200 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:23:46.301556 140421494859200 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:23:46.301826 140420256360192 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:23:46.302149 140420256360192 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:23:46.302361 140421494859200 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:23:46.302540 140421494859200 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:23:46.302603 140421494859200 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:23:46.302761 140420247967488 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:23:46.302927 140420247967488 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:23:46.303076 140421494859200 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:23:46.303205 140421494859200 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:23:46
I0404 02:23:46.397522 140421494859200 evaluation.py:277] Finished evaluation at 2019-04-04-02:23:46
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8303, global_step = 35, loss = 0.78707016
I0404 02:23:46.397885 140421494859200 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8303, global_step = 35, loss = 0.78707016
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:23:50.106604 140421494859200 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:23:50.960743 140421494859200 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.78707016, 'global_step': 35, 'accuracy': 0.8303}

warmup 12, LR 0.008
Removing gs://bert-pretrain-data/mnist_log3/#1554344538402485...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554344542467827...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554344430.yangyouucb#1554344545623340...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554344435418974...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554344441372364...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554344442054536...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554344445910001...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554344539957347...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554344540671844...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554344544545699...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554344627759368...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554344627.yangyouucb#1554344630732444...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:23:54.293354 140187473102272 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:23:54.403814 140187473102272 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7fd3cf3e10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7fd665dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:23:54.506659 140187473102272 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7fd3cf3e10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7fd665dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:23:54.507190 140187473102272 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:23:54.871526 140187473102272 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:23:54.874561: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:23:54.889158 140187473102272 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:23:54.889461 140187473102272 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:23:54.889874 140187473102272 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:23:54.889950 140187473102272 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:23:54.890033 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:23:54.890283 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:23:54.890361 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:23:54.890434 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:23:54.890502 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:23:54.890582 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:23:54.890666 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:23:54.890733 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:23:54.890799 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:23:54.890873 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:23:54.890945 140187473102272 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:23:54.895462 140187473102272 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:23:54.908035 140187473102272 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:23:57.385909 140187473102272 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:23:57.450716 140187473102272 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:23:57.633570 140187473102272 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:23:57.715761 140187473102272 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:23:57.742160 140187473102272 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:23:57.747199 140187473102272 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:57.910988 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:57.956645 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:58.006882 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:58.052635 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:58.103286 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:58.150193 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:58.200654 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:23:58.244827 140187473102272 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:23:58.270478 140187473102272 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:23:58.287798 140187473102272 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:24:01.654885 140187473102272 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:24:01.775350 140187473102272 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:24:02.498558 140187473102272 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:24:02.547326 140187473102272 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:24:05.140966 140187473102272 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:24:15.814501 140187473102272 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:24:15.815195 140187473102272 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:24:15.815596: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:24:15.821883 140187473102272 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:24:15.841355 140187473102272 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:24:15.853892 140187473102272 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:25:29.013076 140187473102272 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:25:29.014123 140186373576448 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:25:29.014624 140186365183744 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:25:29.075787 140187473102272 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:25:29.076550 140187473102272 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.54399383, step = 35
I0404 02:25:40.552092 140187473102272 basic_session_run_hooks.py:249] loss = 0.54399383, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:25:40.554481 140187473102272 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:25:53.002022 140187473102272 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:25:53.002357 140187473102272 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:25:53.002587 140186373576448 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:25:53.002712 140186373576448 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:25:53.002883 140187473102272 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:25:53.003014 140187473102272 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:25:53.003077 140187473102272 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:25:53.003201 140186365183744 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:25:53.003298 140186365183744 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:25:53.003447 140187473102272 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:25:53.003535 140187473102272 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.54399383.
I0404 02:25:53.169805 140187473102272 estimator.py:359] Loss for final step: 0.54399383.
INFO:tensorflow:training_loop marked as finished
I0404 02:25:53.170478 140187473102272 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:25:54.132875 140187473102272 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:25:55.409224 140187473102272 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:25:55.642865 140187473102272 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:25:55Z
I0404 02:25:55.658679 140187473102272 evaluation.py:257] Starting evaluation at 2019-04-04T02:25:55Z
INFO:tensorflow:TPU job name worker
I0404 02:25:55.658978 140187473102272 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:25:55.743416 140187473102272 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:25:55.744229 140187473102272 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:25:55.902507 140187473102272 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:25:59.085170 140187473102272 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:25:59.109819 140187473102272 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:25:59.163820 140187473102272 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:27:13.011306 140187473102272 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:27:13.012216 140186365732608 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:27:13.012593 140186357339904 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:27:13.063643 140187473102272 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:27:13.088479 140187473102272 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:27:13.088882 140187473102272 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:27:14.243644 140187473102272 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:27:14.244030 140187473102272 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:27:14.244188 140187473102272 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:27:14.244410 140186365732608 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:27:14.244555 140186365732608 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:27:14.244716 140187473102272 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:27:14.244838 140187473102272 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:27:14.244899 140187473102272 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:27:14.245031 140186357339904 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:27:14.245275 140186357339904 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:27:14.245445 140187473102272 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:27:14.245605 140187473102272 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:27:14
I0404 02:27:14.334666 140187473102272 evaluation.py:277] Finished evaluation at 2019-04-04-02:27:14
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.874, global_step = 35, loss = 0.51346123
I0404 02:27:14.335040 140187473102272 estimator.py:1979] Saving dict for global step 35: accuracy = 0.874, global_step = 35, loss = 0.51346123
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:27:18.214106 140187473102272 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:27:18.946944 140187473102272 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.51346123, 'global_step': 35, 'accuracy': 0.874}

warmup 12, LR 0.01
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554344651699402...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554344639.yangyouucb#1554344752781553...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554344644737979...
Removing gs://bert-pretrain-data/mnist_log3/#1554344745790465...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554344749981132...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554344747352345...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554344655348702...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554344748041049...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554344651021901...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554344752009300...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554344835724511...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554344835.yangyouucb#1554344838723273...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:27:22.367944 140183041820096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:27:22.499912 140183041820096 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7ecbaf6550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7ece45dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:27:22.653589 140183041820096 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7ecbaf6550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7ece45dad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:27:22.654071 140183041820096 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:27:22.971461 140183041820096 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:27:22.974334: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:27:22.988571 140183041820096 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:27:22.988873 140183041820096 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:27:22.989231 140183041820096 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:27:22.989314 140183041820096 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:27:22.989378 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:27:22.989675 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:27:22.989749 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:27:22.989814 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:27:22.989876 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:27:22.989937 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:27:22.990005 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:27:22.990065 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:27:22.990124 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:27:22.990184 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:27:22.990242 140183041820096 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:27:22.994678 140183041820096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:27:23.007481 140183041820096 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:27:24.415014 140183041820096 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:27:24.478497 140183041820096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:27:24.652762 140183041820096 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:27:24.735182 140183041820096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:27:24.761221 140183041820096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:27:24.766366 140183041820096 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:24.928601 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:24.973613 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:25.023217 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:25.068840 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:25.118597 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:25.165364 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:25.216763 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:27:25.260936 140183041820096 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:27:25.286571 140183041820096 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:27:25.304841 140183041820096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:27:28.357207 140183041820096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:27:28.474200 140183041820096 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:27:29.172439 140183041820096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:27:29.232367 140183041820096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:27:31.630887 140183041820096 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:27:43.212584 140183041820096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:27:43.213311 140183041820096 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:27:43.213713: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:27:43.220541 140183041820096 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:27:43.238337 140183041820096 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:27:43.266012 140183041820096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:28:57.042728 140183041820096 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:28:57.043728 140181952784128 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:28:57.044168 140181944391424 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:28:57.106096 140183041820096 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:28:57.106775 140183041820096 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.5218933, step = 35
I0404 02:29:08.873980 140183041820096 basic_session_run_hooks.py:249] loss = 0.5218933, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:29:08.876070 140183041820096 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:29:20.383418 140183041820096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:29:20.383748 140183041820096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:29:20.384069 140181952784128 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:29:20.384423 140181952784128 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:29:20.384721 140183041820096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:29:20.385015 140183041820096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:29:20.385128 140183041820096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:29:20.385349 140181944391424 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:29:20.385607 140181944391424 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:29:20.385854 140183041820096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:29:20.386073 140183041820096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.5218933.
I0404 02:29:20.553637 140183041820096 estimator.py:359] Loss for final step: 0.5218933.
INFO:tensorflow:training_loop marked as finished
I0404 02:29:20.554277 140183041820096 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:29:21.349479 140183041820096 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:29:22.586669 140183041820096 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:29:22.815299 140183041820096 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:29:22Z
I0404 02:29:22.831033 140183041820096 evaluation.py:257] Starting evaluation at 2019-04-04T02:29:22Z
INFO:tensorflow:TPU job name worker
I0404 02:29:22.831331 140183041820096 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:29:22.914144 140183041820096 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:29:22.914913 140183041820096 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:29:23.081747 140183041820096 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:29:25.427920 140183041820096 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:29:25.451489 140183041820096 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:29:25.508213 140183041820096 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 75 seconds
I0404 02:30:41.046389 140183041820096 tpu_estimator.py:510] Initialized TPU in 75 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:30:41.047353 140181936547584 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:30:41.047868 140181928154880 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:30:41.104155 140183041820096 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:30:41.127696 140183041820096 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:30:41.128087 140183041820096 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:30:42.432152 140183041820096 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:30:42.432526 140183041820096 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:30:42.432604 140183041820096 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:30:42.432820 140181936547584 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:30:42.432955 140181936547584 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:30:42.433113 140183041820096 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:30:42.433221 140183041820096 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:30:42.433295 140183041820096 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:30:42.433458 140181928154880 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:30:42.433600 140181928154880 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:30:42.433723 140183041820096 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:30:42.433820 140183041820096 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:30:42
I0404 02:30:42.532250 140183041820096 evaluation.py:277] Finished evaluation at 2019-04-04-02:30:42
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8779, global_step = 35, loss = 0.48990077
I0404 02:30:42.532655 140183041820096 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8779, global_step = 35, loss = 0.48990077
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:30:46.144871 140183041820096 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:30:46.966108 140183041820096 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.48990077, 'global_step': 35, 'accuracy': 0.8779}

warmup 12, LR 0.02
Removing gs://bert-pretrain-data/mnist_log3/#1554344953671707...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554344957517706...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554344846.yangyouucb#1554344960144775...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554344851223719...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554344862768164...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554344858371798...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554344859100306...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554344955100400...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554344955777131...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554344959444170...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554345043845354...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554345043.yangyouucb#1554345046753725...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:30:50.434331 140666211780032 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:30:50.564488 140666211780032 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fef4adbe550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fef4d725ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:30:50.690316 140666211780032 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fef4adbe550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fef4d725ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:30:50.690820 140666211780032 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:30:51.017184 140666211780032 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:30:51.019160: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:30:51.034054 140666211780032 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:30:51.034369 140666211780032 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:30:51.034691 140666211780032 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:30:51.034758 140666211780032 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:30:51.034820 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:30:51.035024 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:30:51.035092 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:30:51.035156 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:30:51.035235 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:30:51.035325 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:30:51.035386 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:30:51.035448 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:30:51.035505 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:30:51.035562 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:30:51.035619 140666211780032 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:30:51.040029 140666211780032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:30:51.052320 140666211780032 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:30:52.510983 140666211780032 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:30:52.580943 140666211780032 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:30:52.763748 140666211780032 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:30:52.848884 140666211780032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:30:52.877753 140666211780032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:30:52.883148 140666211780032 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.057993 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.106048 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.160468 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.210211 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.263750 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.311853 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.364279 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:30:53.409120 140666211780032 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:30:53.435185 140666211780032 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:30:53.452831 140666211780032 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:30:56.923415 140666211780032 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:30:57.039832 140666211780032 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:30:57.722445 140666211780032 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:30:57.779266 140666211780032 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:31:00.011787 140666211780032 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:31:10.814440 140666211780032 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:31:10.815138 140666211780032 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:31:10.815532: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:31:10.822052 140666211780032 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:31:10.840816 140666211780032 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:31:10.853530 140666211780032 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:32:25.086014 140666211780032 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:32:25.087338 140665260594944 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:32:25.088135 140665252202240 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:32:25.149101 140666211780032 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:32:25.149916 140666211780032 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.2315579, step = 35
I0404 02:32:37.014770 140666211780032 basic_session_run_hooks.py:249] loss = 0.2315579, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:32:37.017292 140666211780032 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:32:48.821737 140666211780032 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:32:48.822091 140666211780032 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:32:48.822454 140665260594944 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:32:48.822808 140665260594944 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:32:48.823067 140666211780032 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:32:48.823331 140666211780032 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:32:48.823434 140666211780032 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:32:48.823626 140665252202240 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:32:48.823827 140665252202240 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:32:48.824067 140666211780032 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:32:48.824290 140666211780032 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.2315579.
I0404 02:32:48.995944 140666211780032 estimator.py:359] Loss for final step: 0.2315579.
INFO:tensorflow:training_loop marked as finished
I0404 02:32:48.996614 140666211780032 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:32:49.893060 140666211780032 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:32:51.104623 140666211780032 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:32:51.332752 140666211780032 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:32:51Z
I0404 02:32:51.350210 140666211780032 evaluation.py:257] Starting evaluation at 2019-04-04T02:32:51Z
INFO:tensorflow:TPU job name worker
I0404 02:32:51.350523 140666211780032 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:32:51.433413 140666211780032 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:32:51.434221 140666211780032 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:32:51.589704 140666211780032 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:32:54.007281 140666211780032 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:32:54.031336 140666211780032 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:32:54.077763 140666211780032 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:34:09.027623 140666211780032 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:34:09.028839 140665243309824 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:34:09.029812 140665234917120 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:34:09.083015 140666211780032 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:34:09.104762 140666211780032 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:34:09.105143 140666211780032 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:34:10.431664 140666211780032 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:34:10.432075 140666211780032 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:34:10.432156 140666211780032 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:34:10.432465 140665243309824 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:34:10.432857 140665243309824 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:34:10.433191 140666211780032 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:34:10.433423 140666211780032 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:34:10.433522 140666211780032 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:34:10.433729 140665234917120 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:34:10.433929 140665234917120 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:34:10.434109 140666211780032 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:34:10.434278 140666211780032 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:34:10
I0404 02:34:10.528990 140666211780032 evaluation.py:277] Finished evaluation at 2019-04-04-02:34:10
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9428, global_step = 35, loss = 0.21213222
I0404 02:34:10.529377 140666211780032 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9428, global_step = 35, loss = 0.21213222
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:34:14.060918 140666211780032 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:34:14.754200 140666211780032 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.21213222, 'global_step': 35, 'accuracy': 0.9428}

warmup 12, LR 0.04
Removing gs://bert-pretrain-data/mnist_log3/#1554345161592177...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554345165639544...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554345066590543...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554345055.yangyouucb#1554345168600216...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554345059620245...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554345070353727...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554345065947996...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554345163146330...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554345163852336...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554345167828027...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554345251804106...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554345251.yangyouucb#1554345254533335...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:34:18.094063 140562149995968 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:34:18.227354 140562149995968 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd7104b1550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd712e18ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:34:18.422092 140562149995968 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fd7104b1550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fd712e18ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:34:18.422581 140562149995968 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:34:18.759038 140562149995968 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:34:18.761894: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:34:18.780915 140562149995968 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:34:18.781229 140562149995968 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:34:18.781629 140562149995968 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:34:18.781704 140562149995968 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:34:18.781769 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:34:18.781960 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:34:18.782033 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:34:18.782099 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:34:18.782159 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:34:18.782221 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:34:18.782294 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:34:18.782355 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:34:18.782413 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:34:18.782470 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:34:18.782545 140562149995968 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:34:18.787128 140562149995968 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:34:18.799273 140562149995968 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:34:20.232564 140562149995968 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:34:20.298551 140562149995968 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:34:20.480232 140562149995968 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:34:20.563100 140562149995968 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:34:20.588908 140562149995968 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:34:20.593986 140562149995968 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:20.754375 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:20.799154 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:20.848000 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:20.892209 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:20.941056 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:20.987127 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:21.037357 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:34:21.080912 140562149995968 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:34:21.106214 140562149995968 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:34:21.124063 140562149995968 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:34:24.348809 140562149995968 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:34:24.466394 140562149995968 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:34:25.141397 140562149995968 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:34:25.203217 140562149995968 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:34:27.515806 140562149995968 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:34:38.719142 140562149995968 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:34:38.719950 140562149995968 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:34:38.720363: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:34:38.726234 140562149995968 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:34:38.744064 140562149995968 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:34:38.757411 140562149995968 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:35:53.001979 140562149995968 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:35:53.003262 140561059149568 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:35:53.004961 140561050756864 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:35:53.067760 140562149995968 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:35:53.068511 140562149995968 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.14889807, step = 35
I0404 02:36:05.227550 140562149995968 basic_session_run_hooks.py:249] loss = 0.14889807, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:36:05.229608 140562149995968 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:36:17.603244 140562149995968 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:36:17.603615 140562149995968 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:36:17.603965 140561059149568 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:36:17.604305 140561059149568 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:36:17.604566 140562149995968 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:36:17.604826 140562149995968 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:36:17.604902 140562149995968 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:36:17.605087 140561050756864 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:36:17.605272 140561050756864 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:36:17.605458 140562149995968 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:36:17.605695 140562149995968 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.14889807.
I0404 02:36:17.782275 140562149995968 estimator.py:359] Loss for final step: 0.14889807.
INFO:tensorflow:training_loop marked as finished
I0404 02:36:17.784287 140562149995968 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:36:18.778239 140562149995968 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:36:19.991297 140562149995968 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:36:20.213371 140562149995968 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:36:20Z
I0404 02:36:20.228393 140562149995968 evaluation.py:257] Starting evaluation at 2019-04-04T02:36:20Z
INFO:tensorflow:TPU job name worker
I0404 02:36:20.228683 140562149995968 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:36:20.309376 140562149995968 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:36:20.310154 140562149995968 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:36:20.485601 140562149995968 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:36:22.992207 140562149995968 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:36:23.016246 140562149995968 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:36:23.064002 140562149995968 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:37:37.033104 140562149995968 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:37:37.034338 140561042364160 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:37:37.034657 140561033971456 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:37:37.092557 140562149995968 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:37:37.115819 140562149995968 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:37:37.116209 140562149995968 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:37:38.236764 140562149995968 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:37:38.237114 140562149995968 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:37:38.237194 140562149995968 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:37:38.237394 140561042364160 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:37:38.237546 140561042364160 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:37:38.237696 140562149995968 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:37:38.237812 140562149995968 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:37:38.237871 140562149995968 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:37:38.237993 140561033971456 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:37:38.238079 140561033971456 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:37:38.238199 140562149995968 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:37:38.238303 140562149995968 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:37:38
I0404 02:37:38.327621 140562149995968 evaluation.py:277] Finished evaluation at 2019-04-04-02:37:38
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9635, global_step = 35, loss = 0.1168855
I0404 02:37:38.327989 140562149995968 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9635, global_step = 35, loss = 0.1168855
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:37:41.929698 140562149995968 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:37:42.741648 140562149995968 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.1168855, 'global_step': 35, 'accuracy': 0.9635}

warmup 12, LR 0.06
Removing gs://bert-pretrain-data/mnist_log3/#1554345370077723...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554345274632360...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554345278273001...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554345374044281...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554345262.yangyouucb#1554345377367564...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554345371610588...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554345267117894...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554345273936401...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554345372220403...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554345375961032...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554345459676294...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554345459.yangyouucb#1554345462518815...
/ [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:37:46.109798 139703363040704 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:37:46.229973 139703363040704 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0f1c9a1550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0f1f308ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:37:46.335521 139703363040704 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0f1c9a1550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0f1f308ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:37:46.336047 139703363040704 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:37:46.663861 139703363040704 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:37:46.666878: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:37:46.681056 139703363040704 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:37:46.681380 139703363040704 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:37:46.681822 139703363040704 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:37:46.681894 139703363040704 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:37:46.681957 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:37:46.682157 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:37:46.682225 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:37:46.682322 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:37:46.682389 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:37:46.682451 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:37:46.682509 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:37:46.682569 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:37:46.682626 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:37:46.682683 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:37:46.682749 139703363040704 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:37:46.687561 139703363040704 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:37:46.700098 139703363040704 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:37:48.128113 139703363040704 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:37:48.198483 139703363040704 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:37:48.373984 139703363040704 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:37:48.454566 139703363040704 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:37:48.480520 139703363040704 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:37:48.485656 139703363040704 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:48.665149 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:48.715385 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:48.770762 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:48.820475 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:48.875125 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:48.928174 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:48.984580 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:37:49.033595 139703363040704 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:37:49.062248 139703363040704 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:37:49.082174 139703363040704 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:37:52.243732 139703363040704 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:37:52.368897 139703363040704 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:37:53.043246 139703363040704 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:37:53.087833 139703363040704 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:37:55.663659 139703363040704 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:38:07.208661 139703363040704 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:38:07.209372 139703363040704 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:38:07.209772: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:38:07.216012 139703363040704 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:38:07.234085 139703363040704 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:38:07.246985 139703363040704 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 73 seconds
I0404 02:39:21.033615 139703363040704 tpu_estimator.py:510] Initialized TPU in 73 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:39:21.034543 139702546077440 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:39:21.035079 139702132799232 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:39:21.096164 139703363040704 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:39:21.096824 139703363040704 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.078146525, step = 35
I0404 02:39:32.803848 139703363040704 basic_session_run_hooks.py:249] loss = 0.078146525, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:39:32.806740 139703363040704 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:39:44.350656 139703363040704 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:39:44.350987 139703363040704 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:39:44.351214 139702546077440 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:39:44.351356 139702546077440 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:39:44.351594 139703363040704 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:39:44.351741 139703363040704 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:39:44.351825 139703363040704 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:39:44.351962 139702132799232 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:39:44.352075 139702132799232 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:39:44.352204 139703363040704 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:39:44.352318 139703363040704 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.078146525.
I0404 02:39:44.516057 139703363040704 estimator.py:359] Loss for final step: 0.078146525.
INFO:tensorflow:training_loop marked as finished
I0404 02:39:44.516741 139703363040704 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:39:45.435508 139703363040704 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:39:46.740220 139703363040704 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:39:46.975153 139703363040704 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:39:46Z
I0404 02:39:46.990959 139703363040704 evaluation.py:257] Starting evaluation at 2019-04-04T02:39:46Z
INFO:tensorflow:TPU job name worker
I0404 02:39:46.991254 139703363040704 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:39:47.075037 139703363040704 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:39:47.075829 139703363040704 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:39:47.233650 139703363040704 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:39:49.825166 139703363040704 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:39:49.849004 139703363040704 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:39:49.906243 139703363040704 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 75 seconds
I0404 02:41:04.997730 139703363040704 tpu_estimator.py:510] Initialized TPU in 75 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:41:04.998791 139702124406528 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:41:04.999658 139702116013824 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:41:05.053303 139703363040704 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:41:05.074508 139703363040704 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:41:05.074888 139703363040704 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:41:06.261420 139703363040704 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:41:06.261842 139703363040704 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:41:06.261951 139703363040704 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:41:06.262233 139702124406528 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:41:06.262556 139702124406528 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:41:06.262898 139703363040704 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:41:06.263137 139703363040704 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:41:06.263210 139703363040704 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:41:06.263401 139702116013824 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:41:06.263571 139702116013824 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:41:06.263730 139703363040704 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:41:06.263875 139703363040704 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:41:06
I0404 02:41:06.364424 139703363040704 evaluation.py:277] Finished evaluation at 2019-04-04-02:41:06
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9814, global_step = 35, loss = 0.06796048
I0404 02:41:06.364824 139703363040704 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9814, global_step = 35, loss = 0.06796048
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:41:10.216849 139703363040704 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:41:10.962948 139703363040704 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.06796048, 'global_step': 35, 'accuracy': 0.9814}

warmup 12, LR 0.08
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554345482749649...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554345578999386...
Removing gs://bert-pretrain-data/mnist_log3/#1554345577456392...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554345581437197...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554345470.yangyouucb#1554345584120286...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554345486756470...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554345579631405...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554345482099650...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554345475262365...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554345583364861...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554345667895974...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554345667.yangyouucb#1554345670741844...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:41:14.342132 139828600722880 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:41:14.466572 139828600722880 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2c45597550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2c47efead0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:41:14.573955 139828600722880 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2c45597550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2c47efead0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:41:14.574460 139828600722880 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:41:14.900496 139828600722880 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:41:14.903732: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:41:14.918109 139828600722880 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:41:14.918412 139828600722880 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:41:14.918797 139828600722880 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:41:14.918865 139828600722880 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:41:14.918931 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:41:14.919147 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:41:14.919222 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:41:14.919298 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:41:14.919363 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:41:14.919424 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:41:14.919482 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:41:14.919540 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:41:14.919615 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:41:14.919675 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:41:14.919764 139828600722880 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:41:14.924161 139828600722880 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:41:14.936516 139828600722880 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:41:17.014369 139828600722880 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:41:17.080518 139828600722880 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:41:17.260456 139828600722880 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:41:17.344945 139828600722880 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:41:17.373035 139828600722880 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:41:17.378385 139828600722880 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.552401 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.604178 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.655910 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.703229 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.755841 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.804550 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.856951 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:41:17.901479 139828600722880 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:41:17.927355 139828600722880 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:41:17.945374 139828600722880 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:41:21.120095 139828600722880 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:41:21.239492 139828600722880 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:41:21.960503 139828600722880 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:41:22.011293 139828600722880 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:41:24.455751 139828600722880 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:41:36.266400 139828600722880 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:41:36.267141 139828600722880 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:41:36.267530: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:41:36.274035 139828600722880 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:41:36.290157 139828600722880 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:41:36.302504 139828600722880 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0404 02:42:49.020042 139828600722880 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:42:49.021054 139827579328256 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:42:49.021446 139827570935552 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:42:49.086067 139828600722880 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:42:49.086766 139828600722880 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.06751959, step = 35
I0404 02:43:00.982517 139828600722880 basic_session_run_hooks.py:249] loss = 0.06751959, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:43:00.985227 139828600722880 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:43:12.734545 139828600722880 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:43:12.734899 139828600722880 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:43:12.735244 139827579328256 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:43:12.735582 139827579328256 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:43:12.735867 139828600722880 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:43:12.736146 139828600722880 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:43:12.736219 139828600722880 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:43:12.736438 139827570935552 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:43:12.736619 139827570935552 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:43:12.736923 139828600722880 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:43:12.737390 139828600722880 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.06751959.
I0404 02:43:12.905420 139828600722880 estimator.py:359] Loss for final step: 0.06751959.
INFO:tensorflow:training_loop marked as finished
I0404 02:43:12.906095 139828600722880 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:43:13.774041 139828600722880 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:43:15.034981 139828600722880 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:43:15.268095 139828600722880 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:43:15Z
I0404 02:43:15.283971 139828600722880 evaluation.py:257] Starting evaluation at 2019-04-04T02:43:15Z
INFO:tensorflow:TPU job name worker
I0404 02:43:15.284248 139828600722880 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:43:15.368134 139828600722880 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:43:15.368967 139828600722880 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:43:15.527797 139828600722880 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:43:18.365873 139828600722880 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:43:18.395906 139828600722880 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:43:18.447283 139828600722880 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:44:32.996818 139828600722880 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:44:32.998122 139827357939456 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:44:32.998874 139827349546752 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:44:33.062429 139828600722880 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:44:33.083571 139828600722880 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:44:33.083950 139828600722880 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:44:34.359230 139828600722880 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:44:34.359623 139828600722880 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:44:34.359713 139828600722880 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:44:34.359915 139827357939456 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:44:34.360049 139827357939456 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:44:34.360202 139828600722880 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:44:34.360331 139828600722880 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:44:34.360388 139828600722880 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:44:34.360558 139827349546752 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:44:34.360649 139827349546752 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:44:34.360775 139828600722880 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:44:34.360869 139828600722880 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:44:34
I0404 02:44:34.449529 139828600722880 evaluation.py:277] Finished evaluation at 2019-04-04-02:44:34
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9846, global_step = 35, loss = 0.049550045
I0404 02:44:34.449943 139828600722880 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9846, global_step = 35, loss = 0.049550045
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:44:37.979664 139828600722880 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:44:38.973478 139828600722880 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.049550045, 'global_step': 35, 'accuracy': 0.9846}

warmup 12, LR 0.1
Removing gs://bert-pretrain-data/mnist_log3/#1554345785642686...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554345789804836...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554345691907170...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554345679.yangyouucb#1554345792509167...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554345695811383...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554345684050367...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554345787211646...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554345691159501...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554345788005017...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554345791734128...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554345875773573...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554345875.yangyouucb#1554345878749202...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:44:42.432343 140377610802624 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:44:42.551629 140377610802624 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fac18e67510>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fac1b7cea90>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:44:42.659291 140377610802624 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fac18e67510>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fac1b7cea90>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:44:42.659800 140377610802624 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:44:42.992919 140377610802624 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:44:42.995977: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:44:43.010060 140377610802624 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:44:43.010382 140377610802624 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:44:43.010710 140377610802624 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:44:43.010792 140377610802624 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:44:43.010855 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:44:43.011071 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:44:43.011142 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:44:43.011207 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:44:43.011281 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:44:43.011343 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:44:43.011404 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:44:43.011462 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:44:43.011521 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:44:43.011579 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:44:43.011639 140377610802624 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:44:43.016063 140377610802624 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:44:43.028450 140377610802624 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:44:44.416986 140377610802624 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:44:44.483473 140377610802624 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:44:44.659199 140377610802624 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:44:44.740031 140377610802624 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:44:44.766036 140377610802624 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 12 steps ++++++
I0404 02:44:44.771085 140377610802624 optimization.py:36] ++++++ warmup starts at step 0, for 12 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:44.935301 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:44.981755 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:45.031913 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:45.078102 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:45.127896 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:45.174396 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:45.225728 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:44:45.269347 140377610802624 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:44:45.294845 140377610802624 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:44:45.312316 140377610802624 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:44:48.464776 140377610802624 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:44:48.580049 140377610802624 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:44:49.263982 140377610802624 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:44:49.325879 140377610802624 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:44:51.818634 140377610802624 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:45:02.100177 140377610802624 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:45:02.100941 140377610802624 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:45:02.101339: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:45:02.107779 140377610802624 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:45:02.125365 140377610802624 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:45:02.137907 140377610802624 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:46:17.013096 140377610802624 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:46:17.014568 140376588551936 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:46:17.015348 140376375555840 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:46:17.090804 140377610802624 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:46:17.091499 140377610802624 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.046729058, step = 35
I0404 02:46:28.682575 140377610802624 basic_session_run_hooks.py:249] loss = 0.046729058, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:46:28.686769 140377610802624 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:46:40.291028 140377610802624 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:46:40.291388 140377610802624 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:46:40.291600 140376588551936 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:46:40.291717 140376588551936 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:46:40.291927 140377610802624 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:46:40.292042 140377610802624 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:46:40.292119 140377610802624 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:46:40.292257 140376375555840 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:46:40.292346 140376375555840 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:46:40.292471 140377610802624 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:46:40.292567 140377610802624 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.046729058.
I0404 02:46:40.461322 140377610802624 estimator.py:359] Loss for final step: 0.046729058.
INFO:tensorflow:training_loop marked as finished
I0404 02:46:40.462059 140377610802624 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:46:41.394553 140377610802624 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:46:42.596745 140377610802624 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:46:42.819849 140377610802624 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:46:42Z
I0404 02:46:42.835268 140377610802624 evaluation.py:257] Starting evaluation at 2019-04-04T02:46:42Z
INFO:tensorflow:TPU job name worker
I0404 02:46:42.835562 140377610802624 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:46:42.918217 140377610802624 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:46:42.919022 140377610802624 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:46:43.075685 140377610802624 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:46:45.763478 140377610802624 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:46:45.788614 140377610802624 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:46:45.835716 140377610802624 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 75 seconds
I0404 02:48:01.032737 140377610802624 tpu_estimator.py:510] Initialized TPU in 75 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:48:01.033788 140376367163136 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:48:01.034104 140376358770432 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:48:01.101139 140377610802624 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:48:01.124187 140377610802624 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:48:01.124635 140377610802624 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:48:02.303982 140377610802624 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:48:02.304356 140377610802624 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:48:02.304436 140377610802624 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:48:02.304656 140376367163136 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:48:02.304791 140376367163136 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:48:02.304934 140377610802624 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:48:02.305073 140377610802624 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:48:02.305138 140377610802624 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:48:02.305269 140376358770432 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:48:02.305358 140376358770432 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:48:02.305516 140377610802624 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:48:02.305634 140377610802624 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:48:02
I0404 02:48:02.429202 140377610802624 evaluation.py:277] Finished evaluation at 2019-04-04-02:48:02
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9875, global_step = 35, loss = 0.03270885
I0404 02:48:02.429639 140377610802624 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9875, global_step = 35, loss = 0.03270885
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:48:06.183031 140377610802624 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:48:06.958381 140377610802624 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.03270885, 'global_step': 35, 'accuracy': 0.9875}

warmup 13, LR 0.001
Removing gs://bert-pretrain-data/mnist_log3/#1554345993345738...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554345997376240...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554345886.yangyouucb#1554346000061089...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554345891425250...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554345898044418...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554345901657164...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554345897448317...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554345995491851...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554345994765259...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554345999366695...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554346083.yangyouucb#1554346086740891...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554346083829215...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:48:10.268733 140607544833472 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:48:10.394716 140607544833472 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fe1a2092f10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fe1a49fcad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:48:10.522387 140607544833472 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fe1a2092f10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fe1a49fcad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:48:10.522903 140607544833472 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:48:10.841588 140607544833472 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:48:10.844440: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:48:10.856184 140607544833472 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:48:10.856473 140607544833472 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:48:10.856798 140607544833472 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:48:10.856870 140607544833472 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:48:10.856935 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:48:10.857126 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:48:10.857192 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:48:10.857315 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:48:10.857381 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:48:10.857440 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:48:10.857578 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:48:10.857652 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:48:10.857712 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:48:10.857774 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:48:10.857834 140607544833472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:48:10.862179 140607544833472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:48:10.874541 140607544833472 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:48:12.451001 140607544833472 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:48:12.516191 140607544833472 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:48:12.690125 140607544833472 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:48:12.769933 140607544833472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:48:12.795800 140607544833472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 13 steps ++++++
I0404 02:48:12.800820 140607544833472 optimization.py:36] ++++++ warmup starts at step 0, for 13 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:12.963701 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:13.010366 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:13.061764 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:13.107537 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:13.157579 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:13.205193 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:13.257378 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:48:13.302575 140607544833472 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:48:13.328413 140607544833472 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:48:13.347143 140607544833472 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:48:16.447664 140607544833472 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:48:16.570225 140607544833472 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:48:17.251723 140607544833472 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:48:17.298839 140607544833472 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:48:19.839623 140607544833472 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:48:30.354511 140607544833472 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:48:30.355314 140607544833472 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:48:30.355739: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:48:30.361897 140607544833472 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:48:30.379483 140607544833472 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:48:30.390913 140607544833472 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:49:45.018743 140607544833472 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:49:45.019841 140606659606272 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:49:45.020211 140606651213568 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:49:45.081428 140607544833472 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:49:45.082163 140607544833472 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.1563945, step = 35
I0404 02:49:56.530922 140607544833472 basic_session_run_hooks.py:249] loss = 2.1563945, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:49:56.533560 140607544833472 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:50:09.476177 140607544833472 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:50:09.476501 140607544833472 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:50:09.476710 140606659606272 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:50:09.476835 140606659606272 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:50:09.477005 140607544833472 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:50:09.477129 140607544833472 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:50:09.477206 140607544833472 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:50:09.477348 140606651213568 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:50:09.477441 140606651213568 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:50:09.477617 140607544833472 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:50:09.477718 140607544833472 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.1563945.
I0404 02:50:09.639223 140607544833472 estimator.py:359] Loss for final step: 2.1563945.
INFO:tensorflow:training_loop marked as finished
I0404 02:50:09.639869 140607544833472 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:50:10.528680 140607544833472 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:50:11.770920 140607544833472 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:50:11.998455 140607544833472 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:50:12Z
I0404 02:50:12.014358 140607544833472 evaluation.py:257] Starting evaluation at 2019-04-04T02:50:12Z
INFO:tensorflow:TPU job name worker
I0404 02:50:12.014650 140607544833472 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:50:12.098463 140607544833472 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:50:12.099234 140607544833472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:50:12.260448 140607544833472 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:50:14.875125 140607544833472 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:50:14.900605 140607544833472 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:50:14.947536 140607544833472 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:51:29.006880 140607544833472 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:51:29.007869 140606643369728 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:51:29.008441 140606634977024 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:51:29.073156 140607544833472 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:51:29.099412 140607544833472 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:51:29.099839 140607544833472 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:51:30.504232 140607544833472 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:51:30.504800 140607544833472 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:51:30.504949 140607544833472 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:51:30.505156 140606643369728 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:51:30.505316 140606643369728 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:51:30.505475 140607544833472 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:51:30.505644 140607544833472 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:51:30.505707 140607544833472 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:51:30.505836 140606634977024 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:51:30.505947 140606634977024 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:51:30.506072 140607544833472 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:51:30.506172 140607544833472 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:51:30
I0404 02:51:30.595765 140607544833472 evaluation.py:277] Finished evaluation at 2019-04-04-02:51:30
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.5949, global_step = 35, loss = 2.1519523
I0404 02:51:30.596163 140607544833472 estimator.py:1979] Saving dict for global step 35: accuracy = 0.5949, global_step = 35, loss = 2.1519523
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:51:34.315165 140607544833472 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:51:35.185708 140607544833472 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 2.1519523, 'global_step': 35, 'accuracy': 0.5949}

warmup 13, LR 0.002
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554346106097462...
Removing gs://bert-pretrain-data/mnist_log3/#1554346202182302...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554346099422998...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554346109921882...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554346094.yangyouucb#1554346209247672...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554346206387746...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554346105463793...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554346203723114...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554346204496165...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554346208188091...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log3/eval/#1554346291952693...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554346292.yangyouucb#1554346294926595...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:51:38.498815 140133736641984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:51:38.665976 140133736641984 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7350de1550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7353748ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:51:38.796010 140133736641984 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7350de1550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7353748ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:51:38.796539 140133736641984 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:51:39.160445 140133736641984 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:51:39.163353: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:51:39.177644 140133736641984 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:51:39.177989 140133736641984 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:51:39.178339 140133736641984 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:51:39.178411 140133736641984 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:51:39.178474 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:51:39.178674 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:51:39.178741 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:51:39.178814 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:51:39.178874 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:51:39.178937 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:51:39.179004 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:51:39.179064 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:51:39.179137 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:51:39.179198 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:51:39.179269 140133736641984 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:51:39.183669 140133736641984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:51:39.196384 140133736641984 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:51:40.607594 140133736641984 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:51:40.672249 140133736641984 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:51:40.849631 140133736641984 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:51:40.929892 140133736641984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:51:40.955895 140133736641984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 13 steps ++++++
I0404 02:51:40.960896 140133736641984 optimization.py:36] ++++++ warmup starts at step 0, for 13 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.122040 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.167323 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.216447 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.261477 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.310605 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.358330 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.409985 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:51:41.454885 140133736641984 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:51:41.480844 140133736641984 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:51:41.499298 140133736641984 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:51:44.671536 140133736641984 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:51:44.786819 140133736641984 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:51:45.466728 140133736641984 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:51:45.518516 140133736641984 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:51:47.814537 140133736641984 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:51:58.073734 140133736641984 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:51:58.074461 140133736641984 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:51:58.074843: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:51:58.081381 140133736641984 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:51:58.097651 140133736641984 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:51:58.110230 140133736641984 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:53:13.082026 140133736641984 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:53:13.083216 140132916270848 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:53:13.083787 140132501944064 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:53:13.145457 140133736641984 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:53:13.146153 140133736641984 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 1.9989663, step = 35
I0404 02:53:25.296044 140133736641984 basic_session_run_hooks.py:249] loss = 1.9989663, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:53:25.298660 140133736641984 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:53:37.011096 140133736641984 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:53:37.011424 140133736641984 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:53:37.011635 140132916270848 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:53:37.011744 140132916270848 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:53:37.011914 140133736641984 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:53:37.012048 140133736641984 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:53:37.012108 140133736641984 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:53:37.012232 140132501944064 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:53:37.012335 140132501944064 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:53:37.012453 140133736641984 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:53:37.012542 140133736641984 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 1.9989663.
I0404 02:53:37.189912 140133736641984 estimator.py:359] Loss for final step: 1.9989663.
INFO:tensorflow:training_loop marked as finished
I0404 02:53:37.190663 140133736641984 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:53:37.977185 140133736641984 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:53:39.225961 140133736641984 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:53:39.455792 140133736641984 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:53:39Z
I0404 02:53:39.471798 140133736641984 evaluation.py:257] Starting evaluation at 2019-04-04T02:53:39Z
INFO:tensorflow:TPU job name worker
I0404 02:53:39.472080 140133736641984 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:53:39.559422 140133736641984 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:53:39.560210 140133736641984 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:53:39.722723 140133736641984 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:53:42.184840 140133736641984 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:53:42.214658 140133736641984 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:53:42.262027 140133736641984 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:54:57.007016 140133736641984 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:54:57.007986 140132493551360 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:54:57.008531 140132485158656 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:54:57.061886 140133736641984 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:54:57.090468 140133736641984 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:54:57.090890 140133736641984 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:54:58.494223 140133736641984 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:54:58.494612 140133736641984 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:54:58.494692 140133736641984 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:54:58.494883 140132493551360 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:54:58.495023 140132493551360 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:54:58.495170 140133736641984 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:54:58.495295 140133736641984 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:54:58.495352 140133736641984 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:54:58.495515 140132485158656 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:54:58.495609 140132485158656 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:54:58.495743 140133736641984 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:54:58.495841 140133736641984 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:54:58
I0404 02:54:58.584974 140133736641984 evaluation.py:277] Finished evaluation at 2019-04-04-02:54:58
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.7232, global_step = 35, loss = 1.990411
I0404 02:54:58.585361 140133736641984 estimator.py:1979] Saving dict for global step 35: accuracy = 0.7232, global_step = 35, loss = 1.990411
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:55:02.445657 140133736641984 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:55:03.382287 140133736641984 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 1.990411, 'global_step': 35, 'accuracy': 0.7232}

warmup 13, LR 0.005
Removing gs://bert-pretrain-data/mnist_log3/#1554346409953001...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554346414002281...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554346303.yangyouucb#1554346416771272...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554346307410122...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554346317632224...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554346313995911...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554346411490232...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554346313258554...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554346412219373...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554346415985431...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554346500029697...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554346500.yangyouucb#1554346503140769...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:55:06.729100 140039597139392 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:55:06.851831 140039597139392 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f5d65b71e50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f5d684dbad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:55:06.959495 140039597139392 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f5d65b71e50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f5d684dbad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:55:06.960026 140039597139392 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:55:07.278459 140039597139392 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:55:07.281394: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:55:07.295099 140039597139392 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:55:07.295388 140039597139392 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:55:07.295721 140039597139392 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:55:07.295797 140039597139392 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:55:07.295864 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:55:07.296058 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:55:07.296125 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:55:07.296190 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:55:07.296289 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:55:07.296356 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:55:07.296416 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:55:07.296474 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:55:07.296533 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:55:07.296591 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:55:07.296648 140039597139392 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:55:07.300915 140039597139392 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:55:07.313062 140039597139392 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:55:08.712704 140039597139392 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:55:08.779448 140039597139392 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:55:08.957165 140039597139392 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:55:09.040445 140039597139392 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:55:09.067797 140039597139392 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 13 steps ++++++
I0404 02:55:09.072953 140039597139392 optimization.py:36] ++++++ warmup starts at step 0, for 13 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.240389 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.286577 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.337387 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.383626 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.434724 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.482218 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.537136 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:55:09.582798 140039597139392 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:55:09.608905 140039597139392 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:55:09.626980 140039597139392 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:55:12.831021 140039597139392 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:55:12.947067 140039597139392 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:55:13.668354 140039597139392 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:55:13.718992 140039597139392 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:55:16.194565 140039597139392 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:55:26.781847 140039597139392 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:55:26.782557 140039597139392 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:55:26.782952: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:55:26.789560 140039597139392 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:55:26.806679 140039597139392 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:55:26.819070 140039597139392 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:56:41.040940 140039597139392 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:56:41.042061 140038713095936 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:56:41.042576 140038704703232 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 02:56:41.108576 140039597139392 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 02:56:41.109232 140039597139392 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 1.164899, step = 35
I0404 02:56:52.882643 140039597139392 basic_session_run_hooks.py:249] loss = 1.164899, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:56:52.885050 140039597139392 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 02:57:04.955569 140039597139392 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:57:04.955921 140039597139392 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:57:04.956290 140038713095936 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:57:04.956655 140038713095936 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:57:04.956906 140039597139392 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:57:04.957166 140039597139392 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:57:04.957247 140039597139392 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:57:04.957519 140038704703232 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:57:04.957727 140038704703232 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:57:04.957952 140039597139392 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:57:04.958143 140039597139392 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 1.164899.
I0404 02:57:05.119694 140039597139392 estimator.py:359] Loss for final step: 1.164899.
INFO:tensorflow:training_loop marked as finished
I0404 02:57:05.120516 140039597139392 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 02:57:06.023603 140039597139392 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:57:07.267045 140039597139392 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 02:57:07.499558 140039597139392 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T02:57:07Z
I0404 02:57:07.514607 140039597139392 evaluation.py:257] Starting evaluation at 2019-04-04T02:57:07Z
INFO:tensorflow:TPU job name worker
I0404 02:57:07.514895 140039597139392 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:57:07.595347 140039597139392 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 02:57:07.596127 140039597139392 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:57:07.766235 140039597139392 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 02:57:10.422549 140039597139392 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:57:10.447120 140039597139392 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 02:57:10.493293 140039597139392 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 02:58:25.017374 140039597139392 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 02:58:25.018368 140038695810816 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 02:58:25.018846 140038348207872 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:58:25.072752 140039597139392 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 02:58:25.124907 140039597139392 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 02:58:25.125325 140039597139392 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 02:58:26.269865 140039597139392 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 02:58:26.270239 140039597139392 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 02:58:26.270349 140039597139392 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 02:58:26.270639 140038695810816 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 02:58:26.270986 140038695810816 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 02:58:26.271210 140039597139392 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 02:58:26.271400 140039597139392 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 02:58:26.271465 140039597139392 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 02:58:26.271672 140038348207872 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 02:58:26.271888 140038348207872 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 02:58:26.272054 140039597139392 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 02:58:26.272195 140039597139392 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-02:58:26
I0404 02:58:26.360863 140039597139392 evaluation.py:277] Finished evaluation at 2019-04-04-02:58:26
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8196, global_step = 35, loss = 1.1158231
I0404 02:58:26.361268 140039597139392 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8196, global_step = 35, loss = 1.1158231
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 02:58:29.924665 140039597139392 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 02:58:30.647245 140039597139392 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 1.1158231, 'global_step': 35, 'accuracy': 0.8196}

warmup 13, LR 0.006
Removing gs://bert-pretrain-data/mnist_log3/#1554346617469312...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554346511.yangyouucb#1554346624733208...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554346621634435...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554346515785727...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554346619001917...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554346522644860...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554346526300393...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554346521983654...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554346619741687...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554346623709065...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554346707681173...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554346707.yangyouucb#1554346710421323...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 02:58:33.983935 139749999138240 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 02:58:34.099020 139749999138240 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f19f85475d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f19faeaead0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 02:58:34.528606 139749999138240 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f19f85475d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f19faeaead0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 02:58:34.529093 139749999138240 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 02:58:34.845630 139749999138240 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 02:58:34.848352: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 02:58:34.865683 139749999138240 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 02:58:34.865991 139749999138240 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 02:58:34.866364 139749999138240 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 02:58:34.866440 139749999138240 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 02:58:34.866503 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 02:58:34.866705 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 02:58:34.866781 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 02:58:34.866847 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 02:58:34.866914 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 02:58:34.866976 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 02:58:34.867036 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 02:58:34.867099 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 02:58:34.867157 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 02:58:34.867219 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 02:58:34.867311 139749999138240 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 02:58:34.871727 139749999138240 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 02:58:34.883662 139749999138240 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:58:36.286348 139749999138240 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 02:58:36.354542 139749999138240 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 02:58:36.542902 139749999138240 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 02:58:36.624639 139749999138240 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 02:58:36.651411 139749999138240 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 13 steps ++++++
I0404 02:58:36.656477 139749999138240 optimization.py:36] ++++++ warmup starts at step 0, for 13 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:36.823539 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:36.869035 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:36.918709 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:36.963489 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:37.012912 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:37.059782 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:37.110342 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 02:58:37.154031 139749999138240 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 02:58:37.179635 139749999138240 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 02:58:37.197140 139749999138240 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 02:58:40.472002 139749999138240 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 02:58:40.590403 139749999138240 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 02:58:41.266936 139749999138240 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 02:58:41.331120 139749999138240 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 02:58:43.746510 139749999138240 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 02:58:54.503680 139749999138240 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 02:58:54.504410 139749999138240 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 02:58:54.504793: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 02:58:54.511177 139749999138240 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 02:58:54.527981 139749999138240 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 02:58:54.539200 139749999138240 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 03:00:08.950943 139749999138240 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 03:00:08.951961 139748899284736 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 03:00:08.952444 139748890892032 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 03:00:09.015295 139749999138240 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 03:00:09.016015 139749999138240 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.87216705, step = 35
I0404 03:00:21.947457 139749999138240 basic_session_run_hooks.py:249] loss = 0.87216705, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 03:00:21.949775 139749999138240 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 03:00:34.667068 139749999138240 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 03:00:34.667428 139749999138240 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 03:00:34.667634 139748899284736 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 03:00:34.667753 139748899284736 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 03:00:34.667927 139749999138240 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 03:00:34.668077 139749999138240 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 03:00:34.668138 139749999138240 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 03:00:34.668276 139748890892032 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 03:00:34.668371 139748890892032 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 03:00:34.668499 139749999138240 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 03:00:34.668596 139749999138240 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.87216705.
I0404 03:00:34.927623 139749999138240 estimator.py:359] Loss for final step: 0.87216705.
INFO:tensorflow:training_loop marked as finished
I0404 03:00:34.928284 139749999138240 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 03:00:35.868554 139749999138240 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 03:00:37.066431 139749999138240 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 03:00:37.296782 139749999138240 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T03:00:37Z
I0404 03:00:37.312242 139749999138240 evaluation.py:257] Starting evaluation at 2019-04-04T03:00:37Z
INFO:tensorflow:TPU job name worker
I0404 03:00:37.312552 139749999138240 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 03:00:37.397692 139749999138240 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 03:00:37.398461 139749999138240 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 03:00:37.569443 139749999138240 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 03:00:40.267025 139749999138240 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 03:00:40.292526 139749999138240 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 03:00:40.341120 139749999138240 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 72 seconds
I0404 03:01:53.022505 139749999138240 tpu_estimator.py:510] Initialized TPU in 72 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 03:01:53.024980 139748890892032 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 03:01:53.025578 139748882499328 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 03:01:53.079484 139749999138240 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 03:01:53.104302 139749999138240 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 03:01:53.104737 139749999138240 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 03:01:54.230479 139749999138240 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 03:01:54.230830 139749999138240 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 03:01:54.230909 139749999138240 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 03:01:54.231122 139748890892032 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 03:01:54.231272 139748890892032 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 03:01:54.231466 139749999138240 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 03:01:54.231590 139749999138240 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 03:01:54.231650 139749999138240 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 03:01:54.231775 139748882499328 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 03:01:54.231859 139748882499328 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 03:01:54.231993 139749999138240 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 03:01:54.232095 139749999138240 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-03:01:54
I0404 03:01:54.326406 139749999138240 evaluation.py:277] Finished evaluation at 2019-04-04-03:01:54
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8296, global_step = 35, loss = 0.80041474
I0404 03:01:54.326772 139749999138240 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8296, global_step = 35, loss = 0.80041474
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 03:01:58.039280 139749999138240 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 03:01:58.980911 139749999138240 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.80041474, 'global_step': 35, 'accuracy': 0.8296}

warmup 13, LR 0.008
Removing gs://bert-pretrain-data/mnist_log3/#1554346827393822...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554346831554728...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554346718.yangyouucb#1554346834432944...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554346730195021...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554346723339859...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554346734037293...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554346828964931...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554346829704002...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554346729552352...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554346833415595...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554346915732483...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554346915.yangyouucb#1554346918741402...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 03:02:02.355757 140327009289664 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 03:02:02.480885 140327009289664 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa050d0a550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fa053671ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 03:02:02.611032 140327009289664 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fa050d0a550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fa053671ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 03:02:02.611543 140327009289664 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 03:02:02.944536 140327009289664 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 03:02:02.947783: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 03:02:02.962908 140327009289664 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 03:02:02.963228 140327009289664 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 03:02:02.963593 140327009289664 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 03:02:02.963664 140327009289664 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 03:02:02.963730 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 03:02:02.963938 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 03:02:02.964009 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 03:02:02.964108 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 03:02:02.964170 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 03:02:02.964231 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 03:02:02.964303 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 03:02:02.964364 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 03:02:02.964422 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 03:02:02.964489 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 03:02:02.964553 140327009289664 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 03:02:02.969104 140327009289664 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 03:02:02.981893 140327009289664 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 03:02:04.441854 140327009289664 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 03:02:04.506625 140327009289664 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 03:02:04.683105 140327009289664 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 03:02:04.765703 140327009289664 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 03:02:04.792054 140327009289664 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 13 steps ++++++
I0404 03:02:04.797113 140327009289664 optimization.py:36] ++++++ warmup starts at step 0, for 13 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:04.958396 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:05.003241 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:05.052200 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:05.096702 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:05.145272 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:05.190938 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:05.240982 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:02:05.284239 140327009289664 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 03:02:05.309362 140327009289664 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 03:02:05.326936 140327009289664 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 03:02:08.501122 140327009289664 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 03:02:08.616384 140327009289664 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 03:02:09.311780 140327009289664 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 03:02:09.372596 140327009289664 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 03:02:11.775739 140327009289664 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 03:02:22.709636 140327009289664 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 03:02:22.710371 140327009289664 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 03:02:22.710770: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 03:02:22.717219 140327009289664 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 03:02:22.735135 140327009289664 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 03:02:22.757169 140327009289664 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 03:03:37.016964 140327009289664 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 03:03:37.018309 140326189799168 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 03:03:37.018501 140325775472384 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 03:03:37.082216 140327009289664 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 03:03:37.082914 140327009289664 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.5650599, step = 35
I0404 03:03:49.151304 140327009289664 basic_session_run_hooks.py:249] loss = 0.5650599, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 03:03:49.153692 140327009289664 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 03:04:00.960510 140327009289664 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 03:04:00.960839 140327009289664 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 03:04:00.961218 140326189799168 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 03:04:00.961668 140326189799168 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 03:04:00.961942 140327009289664 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 03:04:00.962250 140327009289664 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 03:04:00.962371 140327009289664 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 03:04:00.962587 140325775472384 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 03:04:00.962806 140325775472384 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 03:04:00.963028 140327009289664 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 03:04:00.963238 140327009289664 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.5650599.
I0404 03:04:01.141680 140327009289664 estimator.py:359] Loss for final step: 0.5650599.
INFO:tensorflow:training_loop marked as finished
I0404 03:04:01.142362 140327009289664 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 03:04:02.033062 140327009289664 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 03:04:03.512299 140327009289664 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 03:04:03.740765 140327009289664 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T03:04:03Z
I0404 03:04:03.755939 140327009289664 evaluation.py:257] Starting evaluation at 2019-04-04T03:04:03Z
INFO:tensorflow:TPU job name worker
I0404 03:04:03.756220 140327009289664 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 03:04:03.837229 140327009289664 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 03:04:03.838015 140327009289664 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 03:04:03.999425 140327009289664 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 03:04:06.646296 140327009289664 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 03:04:06.670274 140327009289664 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 03:04:06.725344 140327009289664 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 03:05:21.011838 140327009289664 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 03:05:21.012790 140325767079680 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 03:05:21.013290 140325758686976 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 03:05:21.065335 140327009289664 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0404 03:05:21.086170 140327009289664 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0404 03:05:21.086564 140327009289664 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0404 03:05:22.281816 140327009289664 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0404 03:05:22.282221 140327009289664 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 03:05:22.282383 140327009289664 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 03:05:22.282670 140325767079680 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 03:05:22.282993 140325767079680 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 03:05:22.283188 140327009289664 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 03:05:22.283411 140327009289664 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 03:05:22.283498 140327009289664 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 03:05:22.283689 140325758686976 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 03:05:22.283902 140325758686976 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 03:05:22.284080 140327009289664 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 03:05:22.284231 140327009289664 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-04-04-03:05:22
I0404 03:05:22.374728 140327009289664 evaluation.py:277] Finished evaluation at 2019-04-04-03:05:22
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.8742, global_step = 35, loss = 0.52530694
I0404 03:05:22.375092 140327009289664 estimator.py:1979] Saving dict for global step 35: accuracy = 0.8742, global_step = 35, loss = 0.52530694
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 03:05:26.138453 140327009289664 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0404 03:05:26.983916 140327009289664 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.


Evaluation results:
	{'loss': 0.52530694, 'global_step': 35, 'accuracy': 0.8742}

warmup 13, LR 0.01
Removing gs://bert-pretrain-data/mnist_log3/#1554347033920314...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.index#1554346938516574...
Removing gs://bert-pretrain-data/mnist_log3/checkpoint#1554347037919961...
Removing gs://bert-pretrain-data/mnist_log3/events.out.tfevents.1554346926.yangyouucb#1554347040717941...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.data-00000-of-00001#1554347035467383...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.meta#1554346942259788...
Removing gs://bert-pretrain-data/mnist_log3/graph.pbtxt#1554346931364725...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-0.data-00000-of-00001#1554346937774372...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.index#1554347036107658...
Removing gs://bert-pretrain-data/mnist_log3/model.ckpt-35.meta#1554347039997970...
Removing gs://bert-pretrain-data/mnist_log3/eval/#1554347123734676...
Removing gs://bert-pretrain-data/mnist_log3/eval/events.out.tfevents.1554347123.yangyouucb#1554347126757641...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0404 03:05:30.271779 139946530362816 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0404 03:05:30.418766 139946530362816 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f47ba80f550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f47bd176ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
I0404 03:05:30.549959 139946530362816 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.20:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f47ba80f550>, '_model_dir': 'gs://bert-pretrain-data/mnist_log3/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f47bd176ad0>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.20:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.20:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0404 03:05:30.550467 139946530362816 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
I0404 03:05:30.854682 139946530362816 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.20:8470) for TPU system metadata.
2019-04-04 03:05:30.857545: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0404 03:05:30.869306 139946530362816 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0404 03:05:30.869605 139946530362816 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0404 03:05:30.869976 139946530362816 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0404 03:05:30.870047 139946530362816 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
I0404 03:05:30.870110 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 11489354590383575959)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
I0404 03:05:30.870327 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 12030694275847931587)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
I0404 03:05:30.870397 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 5440774359443783579)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
I0404 03:05:30.870476 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 6835016804061548578)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
I0404 03:05:30.870537 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 10452160124112740922)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
I0404 03:05:30.870601 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 15659714225302749919)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
I0404 03:05:30.870661 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 9738151983637843051)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
I0404 03:05:30.870721 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 17131822685375429637)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
I0404 03:05:30.870796 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 14685912261538055072)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
I0404 03:05:30.870857 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 9706921028628160382)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
I0404 03:05:30.870923 139946530362816 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 16576097964458494997)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0404 03:05:30.875024 139946530362816 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0404 03:05:30.886811 139946530362816 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 03:05:32.349869 139946530362816 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 03:05:32.418606 139946530362816 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0404 03:05:32.597069 139946530362816 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0404 03:05:32.677974 139946530362816 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0404 03:05:32.704356 139946530362816 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:++++++ warmup starts at step 0, for 13 steps ++++++
I0404 03:05:32.709417 139946530362816 optimization.py:36] ++++++ warmup starts at step 0, for 13 steps ++++++
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:32.872739 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:32.918647 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:32.968632 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:33.014035 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:33.063954 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:33.111773 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:33.162904 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:*********** I'm using LAMB correction ***********
I0404 03:05:33.207477 139946530362816 optimization.py:160] *********** I'm using LAMB correction ***********
INFO:tensorflow:Create CheckpointSaverHook.
I0404 03:05:33.233445 139946530362816 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0404 03:05:33.250858 139946530362816 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0404 03:05:36.633243 139946530362816 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 03:05:36.749440 139946530362816 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0404 03:05:37.443984 139946530362816 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 03:05:37.511569 139946530362816 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 03:05:39.899009 139946530362816 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0404 03:05:50.357072 139946530362816 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0404 03:05:50.359375 139946530362816 session_support.py:345] Installing graceful shutdown hook.
2019-04-04 03:05:50.359958: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0404 03:05:50.366528 139946530362816 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0404 03:05:50.382646 139946530362816 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0404 03:05:50.394794 139946530362816 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 74 seconds
I0404 03:07:05.078318 139946530362816 tpu_estimator.py:510] Initialized TPU in 74 seconds
INFO:tensorflow:Starting infeed thread controller.
I0404 03:07:05.079289 139945578579712 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0404 03:07:05.079727 139945570187008 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0404 03:07:05.142374 139946530362816 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0404 03:07:05.143043 139946530362816 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.43330896, step = 35
I0404 03:07:17.313057 139946530362816 basic_session_run_hooks.py:249] loss = 0.43330896, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
I0404 03:07:17.315563 139946530362816 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log3/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0404 03:07:30.209428 139946530362816 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0404 03:07:30.209817 139946530362816 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0404 03:07:30.210031 139945578579712 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0404 03:07:30.210164 139945578579712 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0404 03:07:30.210371 139946530362816 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0404 03:07:30.210489 139946530362816 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0404 03:07:30.210558 139946530362816 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0404 03:07:30.210688 139945570187008 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0404 03:07:30.210777 139945570187008 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0404 03:07:30.210902 139946530362816 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0404 03:07:30.210994 139946530362816 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.43330896.
I0404 03:07:30.377044 139946530362816 estimator.py:359] Loss for final step: 0.43330896.
INFO:tensorflow:training_loop marked as finished
I0404 03:07:30.377794 139946530362816 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0404 03:07:31.332828 139946530362816 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0404 03:07:32.598184 139946530362816 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0404 03:07:32.830159 139946530362816 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-04-04T03:07:32Z
I0404 03:07:32.846040 139946530362816 evaluation.py:257] Starting evaluation at 2019-04-04T03:07:32Z
INFO:tensorflow:TPU job name worker
I0404 03:07:32.846340 139946530362816 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0404 03:07:32.929047 139946530362816 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0404 03:07:32.929858 139946530362816 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
I0404 03:07:33.090939 139946530362816 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log3/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0404 03:07:35.543642 139946530362816 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0404 03:07:35.573915 139946530362816 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0404 03:07:35.623096 139946530362816 tpu_estimator.py:504] Init TPU system
