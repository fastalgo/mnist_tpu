warmup 10, LR 0.05
CommandException: 1 files/objects could not be removed.
W0305 08:31:44.217206 139692178945472 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:31:44.404392 139692178945472 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0c81ff4950>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0c8490e810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:31:44.548358 139692178945472 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0c81ff4950>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0c8490e810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:31:44.548871 139692178945472 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:31:44.663182 139692178945472 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:31:44.666113: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:31:44.679765 139692178945472 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:31:44.680129 139692178945472 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:31:44.680474 139692178945472 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:31:44.680542 139692178945472 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:31:44.680604 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:31:44.680880 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:31:44.680951 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:31:44.681016 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:31:44.681077 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:31:44.681137 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:31:44.681195 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:31:44.681278 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:31:44.681340 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:31:44.681411 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:31:44.681483 139692178945472 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:31:44.685847 139692178945472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:31:44.698749 139692178945472 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:31:45.328633 139692178945472 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:31:45.396199 139692178945472 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:31:45.582186 139692178945472 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:31:45.665229 139692178945472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:31:45.707937 139692178945472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:31:45.913889 139692178945472 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:31:45.931205 139692178945472 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:31:47.141724 139692178945472 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:31:47.254395 139692178945472 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:31:47.589054 139692178945472 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:31:47.615331 139692178945472 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:31:48.499906 139692178945472 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:31:52.106827 139692178945472 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:31:52.107588 139692178945472 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:31:52.108059: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:31:52.114218 139692178945472 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:31:52.131084 139692178945472 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:31:52.142177 139692178945472 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 9 seconds
I0305 08:32:02.105040 139692178945472 tpu_estimator.py:510] Initialized TPU in 9 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:32:02.105964 139691294701312 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:32:02.106524 139691286308608 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:32:02.142992 139692178945472 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:32:02.143670 139692178945472 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.33890003, step = 35
I0305 08:32:13.451616 139692178945472 basic_session_run_hooks.py:249] loss = 0.33890003, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:32:13.454240 139692178945472 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:32:17.108786 139692178945472 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:32:17.109114 139692178945472 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:32:17.109333 139691294701312 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:32:17.109479 139691294701312 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:32:17.109659 139692178945472 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:32:17.109786 139692178945472 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:32:17.109855 139692178945472 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:32:17.109997 139691286308608 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:32:17.110101 139691286308608 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:32:17.110248 139692178945472 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:32:17.110352 139692178945472 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.33890003.
I0305 08:32:17.231815 139692178945472 estimator.py:359] Loss for final step: 0.33890003.
INFO:tensorflow:training_loop marked as finished
I0305 08:32:17.232486 139692178945472 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:32:17.537086 139692178945472 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:32:18.039077 139692178945472 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:32:18.406531 139692178945472 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:32:18Z
I0305 08:32:18.422677 139692178945472 evaluation.py:257] Starting evaluation at 2019-03-05T08:32:18Z
INFO:tensorflow:TPU job name worker
I0305 08:32:18.422983 139692178945472 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:32:18.510540 139692178945472 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:32:18.512792 139692178945472 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:32:18.574738 139692178945472 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:32:19.221137 139692178945472 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:32:19.249218 139692178945472 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:32:19.297959 139692178945472 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 10 seconds
I0305 08:32:29.404644 139692178945472 tpu_estimator.py:510] Initialized TPU in 10 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:32:29.405574 139691286857472 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:32:29.406245 139691278464768 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:32:29.462857 139692178945472 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:32:29.485367 139692178945472 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:32:29.485810 139692178945472 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:32:30.506519 139692178945472 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:32:30.506880 139692178945472 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:32:30.506982 139692178945472 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:32:30.507154 139691286857472 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:32:30.507271 139691286857472 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:32:30.507463 139692178945472 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:32:30.507630 139692178945472 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:32:30.507702 139692178945472 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:32:30.516275 139691278464768 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:32:30.516536 139691278464768 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:32:30.516751 139692178945472 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:32:30.516886 139692178945472 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:32:30
I0305 08:32:30.605586 139692178945472 evaluation.py:277] Finished evaluation at 2019-03-05-08:32:30
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9161, global_step = 35, loss = 0.3156372
I0305 08:32:30.605943 139692178945472 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9161, global_step = 35, loss = 0.3156372
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:32:31.841828 139692178945472 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:32:32.072571 139692178945472 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 0.3156372, 'global_step': 35, 'accuracy': 0.9161}

warmup 10, LR 0.06
Removing gs://bert-pretrain-data/mnist_log/#1551774734798291...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551774736136547...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551774735360254...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551774711896494...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551774708314968...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551774706.infer#1551774737039874...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551774735631889...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551774710795977...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551774710587963...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551774736795528...
/ [1/12 objects]   8% Done                                                      Removing gs://bert-pretrain-data/mnist_log/eval/#1551774751081190...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551774751.infer#1551774752008681...
/ [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:32:35.008075 139834237457856 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:32:35.310784 139834237457856 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2d95582a10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2d97e9c810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:32:35.514192 139834237457856 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f2d95582a10>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f2d97e9c810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:32:35.514698 139834237457856 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:32:35.628022 139834237457856 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:32:35.630769: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:32:35.641036 139834237457856 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:32:35.641323 139834237457856 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:32:35.641660 139834237457856 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:32:35.641729 139834237457856 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:32:35.641804 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:32:35.642085 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:32:35.642154 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:32:35.642219 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:32:35.642280 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:32:35.642358 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:32:35.642419 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:32:35.642477 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:32:35.642550 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:32:35.642610 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:32:35.642668 139834237457856 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:32:35.646821 139834237457856 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:32:35.659049 139834237457856 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:32:36.275161 139834237457856 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:32:36.340636 139834237457856 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:32:36.516144 139834237457856 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:32:36.598045 139834237457856 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:32:36.639894 139834237457856 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:32:36.840631 139834237457856 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:32:36.857932 139834237457856 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:32:37.948153 139834237457856 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:32:38.050968 139834237457856 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:32:38.381403 139834237457856 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:32:38.409881 139834237457856 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:32:39.272324 139834237457856 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:32:42.996134 139834237457856 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:32:42.996967 139834237457856 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:32:42.997391: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:32:43.002883 139834237457856 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:32:43.019078 139834237457856 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:32:43.031075 139834237457856 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 13 seconds
I0305 08:32:56.428596 139834237457856 tpu_estimator.py:510] Initialized TPU in 13 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:32:56.429672 139833216472832 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:32:56.430290 139833208080128 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:32:56.466917 139834237457856 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:32:56.467673 139834237457856 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 0.44574267, step = 35
I0305 08:33:07.377757 139834237457856 basic_session_run_hooks.py:249] loss = 0.44574267, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:33:07.380146 139834237457856 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:33:11.009449 139834237457856 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:33:11.009783 139834237457856 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:33:11.010066 139833216472832 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:33:11.010237 139833216472832 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:33:11.010457 139834237457856 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:33:11.010596 139834237457856 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:33:11.010660 139834237457856 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:33:11.010797 139833208080128 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:33:11.010894 139833208080128 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:33:11.011023 139834237457856 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:33:11.011126 139834237457856 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 0.44574267.
I0305 08:33:11.141494 139834237457856 estimator.py:359] Loss for final step: 0.44574267.
INFO:tensorflow:training_loop marked as finished
I0305 08:33:11.142139 139834237457856 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:33:11.442553 139834237457856 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:33:11.953710 139834237457856 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:33:12.304744 139834237457856 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:33:12Z
I0305 08:33:12.320715 139834237457856 evaluation.py:257] Starting evaluation at 2019-03-05T08:33:12Z
INFO:tensorflow:TPU job name worker
I0305 08:33:12.321017 139834237457856 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:33:12.406541 139834237457856 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:33:12.407310 139834237457856 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:33:12.459618 139834237457856 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:33:13.288039 139834237457856 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:33:13.311021 139834237457856 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:33:13.357904 139834237457856 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 16 seconds
I0305 08:33:30.182919 139834237457856 tpu_estimator.py:510] Initialized TPU in 16 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:33:30.183859 139833208080128 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:33:30.184427 139832995084032 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:33:30.239397 139834237457856 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:33:30.260957 139834237457856 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:33:30.261399 139834237457856 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:33:31.260885 139834237457856 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:33:31.261265 139834237457856 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:33:31.261393 139834237457856 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:33:31.262026 139833208080128 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:33:31.262259 139833208080128 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:33:31.262480 139834237457856 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:33:31.262603 139834237457856 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:33:31.262664 139834237457856 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:33:31.271264 139832995084032 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:33:31.271580 139832995084032 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:33:31.271811 139834237457856 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:33:31.271960 139834237457856 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:33:31
I0305 08:33:31.357198 139834237457856 evaluation.py:277] Finished evaluation at 2019-03-05-08:33:31
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.9004, global_step = 35, loss = 0.38298178
I0305 08:33:31.357582 139834237457856 estimator.py:1979] Saving dict for global step 35: accuracy = 0.9004, global_step = 35, loss = 0.38298178
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:33:32.667959 139834237457856 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:33:32.888288 139834237457856 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 0.38298178, 'global_step': 35, 'accuracy': 0.9004}

warmup 10, LR 0.07
Removing gs://bert-pretrain-data/mnist_log/#1551774788795294...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551774761739516...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551774790092616...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551774759093547...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551774757.infer#1551774790945574...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551774762776941...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551774789367763...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551774761535506...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551774789562010...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551774790710280...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551774811839680...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551774811.infer#1551774812823995...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:33:35.847938 140186141476288 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.08
CommandException: 1 files/objects could not be removed.
W0305 08:33:38.639781 139839983715776 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.09
CommandException: 1 files/objects could not be removed.
W0305 08:33:41.402290 139948388668864 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.10
CommandException: 1 files/objects could not be removed.
W0305 08:33:44.233726 140704232191424 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.11
CommandException: 1 files/objects could not be removed.
W0305 08:33:46.960163 139797821715904 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.12
CommandException: 1 files/objects could not be removed.
W0305 08:33:49.743097 139884651648448 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.13
CommandException: 1 files/objects could not be removed.
W0305 08:33:52.511589 140458240185792 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.14
CommandException: 1 files/objects could not be removed.
W0305 08:33:55.222963 139941546022336 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.15
CommandException: 1 files/objects could not be removed.
W0305 08:33:57.980529 140334135055808 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.16
CommandException: 1 files/objects could not be removed.
W0305 08:34:00.749011 139673490683328 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.17
CommandException: 1 files/objects could not be removed.
W0305 08:34:03.563137 140285773358528 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.18
CommandException: 1 files/objects could not be removed.
W0305 08:34:06.341542 140527206036928 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.19
CommandException: 1 files/objects could not be removed.
W0305 08:34:09.154043 140298527819200 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.20
CommandException: 1 files/objects could not be removed.
W0305 08:34:11.881947 140690480436672 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.21
CommandException: 1 files/objects could not be removed.
W0305 08:34:14.759262 139729665459648 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.22
CommandException: 1 files/objects could not be removed.
W0305 08:34:17.489720 139895417038272 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.23
CommandException: 1 files/objects could not be removed.
W0305 08:34:20.245110 140324887143872 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.24
CommandException: 1 files/objects could not be removed.
W0305 08:34:23.001923 140110758471104 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.25
CommandException: 1 files/objects could not be removed.
W0305 08:34:25.825247 140682483885504 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.26
CommandException: 1 files/objects could not be removed.
W0305 08:34:28.667510 140153685198272 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.27
CommandException: 1 files/objects could not be removed.
W0305 08:34:31.467111 140171150742976 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.28
CommandException: 1 files/objects could not be removed.
W0305 08:34:34.323061 140216686568896 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.29
CommandException: 1 files/objects could not be removed.
W0305 08:34:37.089118 140288092243392 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.30
CommandException: 1 files/objects could not be removed.
W0305 08:34:39.846070 139681963423168 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:34:39.987759 139681963423168 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0a2115b390>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0a23ac6810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:34:40.156550 139681963423168 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f0a2115b390>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f0a23ac6810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:34:40.157196 139681963423168 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:34:40.278964 139681963423168 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:34:40.282178: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:34:40.299566 139681963423168 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:34:40.299962 139681963423168 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:34:40.300328 139681963423168 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:34:40.300421 139681963423168 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:34:40.300492 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:34:40.300735 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:34:40.300848 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:34:40.300920 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:34:40.300988 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:34:40.301055 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:34:40.301122 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:34:40.301187 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:34:40.301256 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:34:40.301340 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:34:40.301423 139681963423168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:34:40.305985 139681963423168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:34:40.319152 139681963423168 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:34:41.016316 139681963423168 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:34:41.082047 139681963423168 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:34:41.260926 139681963423168 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:34:41.345356 139681963423168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:34:41.389314 139681963423168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:34:41.591142 139681963423168 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:34:41.608714 139681963423168 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:34:42.853843 139681963423168 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:34:42.955410 139681963423168 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:34:43.294243 139681963423168 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:34:43.325047 139681963423168 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:34:44.260251 139681963423168 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:34:47.841967 139681963423168 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:34:47.842854 139681963423168 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:34:47.843265: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:34:47.848881 139681963423168 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:34:47.865577 139681963423168 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:34:47.878205 139681963423168 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 11 seconds
I0305 08:34:59.747668 139681963423168 tpu_estimator.py:510] Initialized TPU in 11 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:34:59.748680 139680946460416 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:34:59.749238 139680938067712 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:34:59.785898 139681963423168 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:34:59.786616 139681963423168 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.303638, step = 35
I0305 08:35:11.280014 139681963423168 basic_session_run_hooks.py:249] loss = 2.303638, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:35:11.282891 139681963423168 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:35:14.877104 139681963423168 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:35:14.877492 139681963423168 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:35:14.877737 139680946460416 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:35:14.877876 139680946460416 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:35:14.878087 139681963423168 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:35:14.878227 139681963423168 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:35:14.878304 139681963423168 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:35:14.878465 139680938067712 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:35:14.878566 139680938067712 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:35:14.878740 139681963423168 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:35:14.878842 139681963423168 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.303638.
I0305 08:35:15.017877 139681963423168 estimator.py:359] Loss for final step: 2.303638.
INFO:tensorflow:training_loop marked as finished
I0305 08:35:15.018544 139681963423168 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:35:15.285985 139681963423168 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:35:15.799004 139681963423168 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:35:16.158749 139681963423168 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:35:16Z
I0305 08:35:16.174978 139681963423168 evaluation.py:257] Starting evaluation at 2019-03-05T08:35:16Z
INFO:tensorflow:TPU job name worker
I0305 08:35:16.175549 139681963423168 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:35:16.263560 139681963423168 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:35:16.264336 139681963423168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:35:16.329996 139681963423168 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:35:16.948479 139681963423168 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:35:16.975136 139681963423168 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:35:17.030909 139681963423168 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 13 seconds
I0305 08:35:30.105861 139681963423168 tpu_estimator.py:510] Initialized TPU in 13 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:35:30.107109 139680725071616 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:35:30.107990 139680716678912 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:35:30.164726 139681963423168 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:35:30.186708 139681963423168 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:35:30.187153 139681963423168 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:35:31.185662 139681963423168 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:35:31.186117 139681963423168 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:35:31.186269 139681963423168 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:35:31.186647 139680725071616 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:35:31.187473 139680725071616 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:35:31.187712 139681963423168 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:35:31.188052 139681963423168 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:35:31.188127 139681963423168 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:35:31.191087 139680716678912 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:35:31.191327 139680716678912 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:35:31.191570 139681963423168 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:35:31.191831 139681963423168 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:35:31
I0305 08:35:31.279135 139681963423168 evaluation.py:277] Finished evaluation at 2019-03-05-08:35:31
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.2988343
I0305 08:35:31.279558 139681963423168 estimator.py:1979] Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.2988343
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:35:32.575278 139681963423168 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:35:32.812277 139681963423168 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.2988343, 'global_step': 35, 'accuracy': 0.1135}

warmup 10, LR 0.31
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551774886488922...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551774887616674...
Removing gs://bert-pretrain-data/mnist_log/#1551774912591544...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551774913907782...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551774913175201...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551774884068788...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551774882.infer#1551774914782680...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551774886307870...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551774913390721...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551774914530365...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551774931763175...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551774931.infer#1551774932735620...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:35:35.880590 140377724319168 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:35:36.062370 140377724319168 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fac1faa7050>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fac22412810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:35:36.283767 140377724319168 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fac1faa7050>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fac22412810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:35:36.284255 140377724319168 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:35:36.386807 140377724319168 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:35:36.389586: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:35:36.400975 140377724319168 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:35:36.401382 140377724319168 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:35:36.401710 140377724319168 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:35:36.401814 140377724319168 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:35:36.401881 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:35:36.402111 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:35:36.402179 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:35:36.402254 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:35:36.402316 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:35:36.402386 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:35:36.402462 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:35:36.402522 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:35:36.402580 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:35:36.402638 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:35:36.402697 140377724319168 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:35:36.407099 140377724319168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:35:36.419605 140377724319168 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:35:37.035777 140377724319168 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:35:37.101958 140377724319168 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:35:37.285815 140377724319168 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:35:37.367891 140377724319168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:35:37.410111 140377724319168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:35:37.613203 140377724319168 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:35:37.630475 140377724319168 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:35:38.739779 140377724319168 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:35:38.842199 140377724319168 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:35:39.163482 140377724319168 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:35:39.190814 140377724319168 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:35:40.031007 140377724319168 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:35:43.612914 140377724319168 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:35:43.613667 140377724319168 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:35:43.614053: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:35:43.619913 140377724319168 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:35:43.636590 140377724319168 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:35:43.648406 140377724319168 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 12 seconds
I0305 08:35:56.646595 140377724319168 tpu_estimator.py:510] Initialized TPU in 12 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:35:56.647593 140376627205888 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:35:56.648077 140376618813184 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:35:56.684303 140377724319168 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:35:56.685025 140377724319168 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.4059193, step = 35
I0305 08:36:07.532562 140377724319168 basic_session_run_hooks.py:249] loss = 2.4059193, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:36:07.534888 140377724319168 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:36:11.324712 140377724319168 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:36:11.325052 140377724319168 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:36:11.325248 140376627205888 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:36:11.325515 140376627205888 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:36:11.325696 140377724319168 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:36:11.325815 140377724319168 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:36:11.325876 140377724319168 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:36:11.326004 140376618813184 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:36:11.326087 140376618813184 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:36:11.326222 140377724319168 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:36:11.326320 140377724319168 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.4059193.
I0305 08:36:11.458762 140377724319168 estimator.py:359] Loss for final step: 2.4059193.
INFO:tensorflow:training_loop marked as finished
I0305 08:36:11.459429 140377724319168 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:36:11.766467 140377724319168 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:36:12.239178 140377724319168 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:36:12.612624 140377724319168 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:36:12Z
I0305 08:36:12.628866 140377724319168 evaluation.py:257] Starting evaluation at 2019-03-05T08:36:12Z
INFO:tensorflow:TPU job name worker
I0305 08:36:12.629189 140377724319168 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:36:12.718938 140377724319168 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:36:12.719764 140377724319168 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:36:12.784002 140377724319168 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:36:13.388489 140377724319168 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:36:13.412436 140377724319168 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:36:13.464150 140377724319168 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 16 seconds
I0305 08:36:30.158998 140377724319168 tpu_estimator.py:510] Initialized TPU in 16 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:36:30.160087 140376627754752 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:36:30.161022 140376619362048 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:36:30.211097 140377724319168 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:36:30.235857 140377724319168 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:36:30.236306 140377724319168 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:36:31.213118 140377724319168 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:36:31.213635 140377724319168 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:36:31.213742 140377724319168 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:36:31.214138 140376627754752 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:36:31.214479 140376627754752 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:36:31.215048 140377724319168 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:36:31.215481 140377724319168 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:36:31.215564 140377724319168 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:36:31.223159 140376619362048 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:36:31.223464 140376619362048 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:36:31.223772 140377724319168 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:36:31.224212 140377724319168 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:36:31
I0305 08:36:31.309861 140377724319168 evaluation.py:277] Finished evaluation at 2019-03-05-08:36:31
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.101, global_step = 35, loss = 2.4374356
I0305 08:36:31.310276 140377724319168 estimator.py:1979] Saving dict for global step 35: accuracy = 0.101, global_step = 35, loss = 2.4374356
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:36:32.643826 140377724319168 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:36:32.870609 140377724319168 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.4374356, 'global_step': 35, 'accuracy': 0.101}

warmup 10, LR 0.32
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551774942279321...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551774943392957...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551774938.infer#1551774971263579...
Removing gs://bert-pretrain-data/mnist_log/#1551774969084835...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551774939855293...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551774969641554...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551774970386519...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551774969865599...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551774942060126...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551774971008821...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551774991790997...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551774991.infer#1551774992804180...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:36:35.863950 140395213653440 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

Traceback (most recent call last):
  File "mnist_tpu.py", line 278, in <module>
    tf.app.run()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 125, in run
    _sys.exit(main(argv))
  File "mnist_tpu.py", line 241, in main
    tpu_config=tf.contrib.tpu.TPUConfig(FLAGS.iterations, FLAGS.num_shards),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/tpu/python/tpu/tpu_config.py", line 206, in __init__
    self._master = cluster.master()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 333, in master
    cluster_spec = self.cluster_spec()
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/distribute/cluster_resolver/tpu_cluster_resolver.py", line 398, in cluster_spec
    (compat.as_text(self._tpu), response['health']))
RuntimeError: TPU "infer" is unhealthy: "UNHEALTHY_TENSORFLOW"
warmup 10, LR 0.33
CommandException: 1 files/objects could not be removed.
W0305 08:36:38.753767 140681902970304 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:36:38.917947 140681902970304 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff2f2256a50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff2f4b70810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:36:39.116466 140681902970304 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7ff2f2256a50>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7ff2f4b70810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:36:39.117021 140681902970304 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:36:39.235337 140681902970304 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:36:39.238323: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:36:39.250586 140681902970304 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:36:39.250889 140681902970304 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:36:39.251235 140681902970304 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:36:39.251305 140681902970304 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:36:39.251382 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:36:39.251580 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:36:39.251647 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:36:39.251712 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:36:39.251774 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:36:39.251833 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:36:39.251893 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:36:39.251950 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:36:39.252008 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:36:39.252067 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:36:39.252140 140681902970304 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:36:39.256283 140681902970304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:36:39.268620 140681902970304 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:36:39.890585 140681902970304 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:36:39.956255 140681902970304 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:36:40.133467 140681902970304 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:36:40.217159 140681902970304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:36:40.258734 140681902970304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:36:40.465413 140681902970304 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:36:40.482501 140681902970304 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:36:41.608930 140681902970304 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:36:41.710038 140681902970304 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:36:42.050753 140681902970304 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:36:42.089202 140681902970304 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:36:42.931096 140681902970304 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:36:46.391119 140681902970304 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:36:46.391921 140681902970304 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:36:46.392298: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:36:46.398658 140681902970304 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:36:46.415676 140681902970304 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:36:46.427772 140681902970304 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 25 seconds
I0305 08:37:11.578645 140681902970304 tpu_estimator.py:510] Initialized TPU in 25 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:37:11.579659 140681015179008 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:37:11.580821 140681006786304 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:37:11.617327 140681902970304 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:37:11.618052 140681902970304 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.2902424, step = 35
I0305 08:37:22.894741 140681902970304 basic_session_run_hooks.py:249] loss = 2.2902424, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:37:22.896956 140681902970304 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:37:26.522213 140681902970304 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:37:26.522569 140681902970304 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:37:26.522907 140681015179008 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:37:26.523276 140681015179008 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:37:26.523721 140681902970304 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:37:26.524079 140681902970304 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:37:26.524151 140681902970304 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:37:26.524350 140681006786304 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:37:26.524605 140681006786304 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:37:26.524876 140681902970304 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:37:26.525069 140681902970304 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.2902424.
I0305 08:37:26.657403 140681902970304 estimator.py:359] Loss for final step: 2.2902424.
INFO:tensorflow:training_loop marked as finished
I0305 08:37:26.658042 140681902970304 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:37:26.929054 140681902970304 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:37:27.485726 140681902970304 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:37:27.848303 140681902970304 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:37:27Z
I0305 08:37:27.864171 140681902970304 evaluation.py:257] Starting evaluation at 2019-03-05T08:37:27Z
INFO:tensorflow:TPU job name worker
I0305 08:37:27.864480 140681902970304 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:37:27.949385 140681902970304 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:37:27.950165 140681902970304 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:37:28.019536 140681902970304 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:37:28.681868 140681902970304 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:37:28.710983 140681902970304 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:37:28.757570 140681902970304 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 17 seconds
I0305 08:37:46.051043 140681902970304 tpu_estimator.py:510] Initialized TPU in 17 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:37:46.052225 140681013606144 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:37:46.053122 140681005213440 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:37:46.105153 140681902970304 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:37:46.129992 140681902970304 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:37:46.130456 140681902970304 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:37:47.163959 140681902970304 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:37:47.164355 140681902970304 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:37:47.164457 140681902970304 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:37:47.164611 140681013606144 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:37:47.164750 140681013606144 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:37:47.165465 140681902970304 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:37:47.165648 140681902970304 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:37:47.165716 140681902970304 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:37:47.166476 140681005213440 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:37:47.166752 140681005213440 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:37:47.166954 140681902970304 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:37:47.167148 140681902970304 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:37:47
I0305 08:37:47.259246 140681902970304 evaluation.py:277] Finished evaluation at 2019-03-05-08:37:47
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.2147, global_step = 35, loss = 2.2842453
I0305 08:37:47.259718 140681902970304 estimator.py:1979] Saving dict for global step 35: accuracy = 0.2147, global_step = 35, loss = 2.2842453
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:37:48.728168 140681902970304 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:37:48.966733 140681902970304 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.2842453, 'global_step': 35, 'accuracy': 0.2147}

warmup 10, LR 0.34
Removing gs://bert-pretrain-data/mnist_log/#1551775044292810...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775002748644...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775045596275...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775004911739...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775001.infer#1551775046455345...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775044858517...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775046210288...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775045060821...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775006177995...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775005099608...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775067904652...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775067.infer#1551775068894260...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:37:52.010926 139876046484928 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:37:52.153839 139876046484928 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f3751563250>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f3753ece810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:37:52.390984 139876046484928 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f3751563250>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f3753ece810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:37:52.391539 139876046484928 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:37:52.494590 139876046484928 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:37:52.497520: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:37:52.510713 139876046484928 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:37:52.511008 139876046484928 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:37:52.511385 139876046484928 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:37:52.511465 139876046484928 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:37:52.511538 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:37:52.511792 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:37:52.511881 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:37:52.511955 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:37:52.512027 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:37:52.512094 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:37:52.512161 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:37:52.512237 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:37:52.512319 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:37:52.512398 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:37:52.512465 139876046484928 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:37:52.517232 139876046484928 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:37:52.529687 139876046484928 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:37:53.140602 139876046484928 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:37:53.205738 139876046484928 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:37:53.387871 139876046484928 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:37:53.469377 139876046484928 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:37:53.510996 139876046484928 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:37:53.713376 139876046484928 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:37:53.730371 139876046484928 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:37:54.836827 139876046484928 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:37:54.949404 139876046484928 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:37:55.268762 139876046484928 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:37:55.304128 139876046484928 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:37:56.172478 139876046484928 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:37:59.636356 139876046484928 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:37:59.637106 139876046484928 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:37:59.637493: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:37:59.646784 139876046484928 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:37:59.662154 139876046484928 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:37:59.673764 139876046484928 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 17 seconds
I0305 08:38:17.018563 139876046484928 tpu_estimator.py:510] Initialized TPU in 17 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:38:17.019599 139875025295104 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:38:17.020179 139875016902400 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:38:17.079401 139876046484928 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:38:17.080152 139876046484928 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.3010898, step = 35
I0305 08:38:27.872208 139876046484928 basic_session_run_hooks.py:249] loss = 2.3010898, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:38:27.874973 139876046484928 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:38:31.481057 139876046484928 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:38:31.481462 139876046484928 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:38:31.481753 139875025295104 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:38:31.481898 139875025295104 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:38:31.482108 139876046484928 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:38:31.482251 139876046484928 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:38:31.482326 139876046484928 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:38:31.482551 139875016902400 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:38:31.482656 139875016902400 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:38:31.482836 139876046484928 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:38:31.482959 139876046484928 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.3010898.
I0305 08:38:31.620131 139876046484928 estimator.py:359] Loss for final step: 2.3010898.
INFO:tensorflow:training_loop marked as finished
I0305 08:38:31.620907 139876046484928 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:38:31.904319 139876046484928 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:38:32.436125 139876046484928 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:38:32.819565 139876046484928 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:38:32Z
I0305 08:38:32.838320 139876046484928 evaluation.py:257] Starting evaluation at 2019-03-05T08:38:32Z
INFO:tensorflow:TPU job name worker
I0305 08:38:32.838686 139876046484928 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:38:32.933954 139876046484928 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:38:32.934782 139876046484928 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:38:32.999826 139876046484928 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:38:33.635416 139876046484928 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:38:33.658384 139876046484928 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:38:33.703722 139876046484928 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 18 seconds
I0305 08:38:52.596672 139876046484928 tpu_estimator.py:510] Initialized TPU in 18 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:38:52.597821 139875016902400 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:38:52.598593 139874803906304 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:38:52.650974 139876046484928 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:38:52.675656 139876046484928 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:38:52.676110 139876046484928 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:38:53.674094 139876046484928 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:38:53.675040 139876046484928 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:38:53.675143 139876046484928 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:38:53.675410 139875016902400 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:38:53.675745 139875016902400 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:38:53.675961 139876046484928 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:38:53.676182 139876046484928 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:38:53.676259 139876046484928 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:38:53.684185 139874803906304 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:38:53.684489 139874803906304 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:38:53.684753 139876046484928 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:38:53.685050 139876046484928 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:38:53
I0305 08:38:53.779642 139876046484928 evaluation.py:277] Finished evaluation at 2019-03-05-08:38:53
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3000405
I0305 08:38:53.780061 139876046484928 estimator.py:1979] Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3000405
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:38:55.097598 139876046484928 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:38:55.331340 139876046484928 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.3000405, 'global_step': 35, 'accuracy': 0.1135}

warmup 10, LR 0.35
Removing gs://bert-pretrain-data/mnist_log/#1551775109142294...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775109730963...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775078334802...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775110478838...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775074.infer#1551775111407905...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775079399193...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775109928488...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775075981911...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775111139138...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775078165963...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775134272148...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775134.infer#1551775135266785...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:38:58.360366 140658876786112 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:38:58.653795 140658876786112 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed95a8a2d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fed983f5810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:38:58.941490 140658876786112 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fed95a8a2d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fed983f5810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:38:58.941996 140658876786112 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:38:59.042026 140658876786112 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:38:59.044951: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:38:59.058670 140658876786112 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:38:59.058971 140658876786112 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:38:59.059314 140658876786112 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:38:59.059396 140658876786112 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:38:59.059465 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:38:59.059678 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:38:59.059756 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:38:59.059823 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:38:59.059884 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:38:59.059958 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:38:59.060019 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:38:59.060079 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:38:59.060137 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:38:59.060194 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:38:59.060256 140658876786112 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:38:59.064661 140658876786112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:38:59.077424 140658876786112 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:38:59.701169 140658876786112 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:38:59.773147 140658876786112 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:38:59.962234 140658876786112 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:39:00.055675 140658876786112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:39:00.108788 140658876786112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:39:00.310026 140658876786112 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:39:00.327203 140658876786112 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:39:01.395142 140658876786112 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:39:01.497520 140658876786112 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:39:01.824080 140658876786112 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:39:01.855950 140658876786112 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:39:02.723917 140658876786112 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:39:06.275207 140658876786112 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:39:06.276016 140658876786112 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:39:06.276476: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:39:06.282160 140658876786112 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:39:06.300163 140658876786112 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:39:06.311527 140658876786112 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 19 seconds
I0305 08:39:25.681122 140658876786112 tpu_estimator.py:510] Initialized TPU in 19 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:39:25.682250 140657997362944 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:39:25.682862 140657988970240 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:39:25.721451 140658876786112 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:39:25.722155 140658876786112 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.3054154, step = 35
I0305 08:39:36.671700 140658876786112 basic_session_run_hooks.py:249] loss = 2.3054154, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:39:36.674011 140658876786112 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:39:40.319530 140658876786112 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:39:40.319869 140658876786112 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:39:40.320122 140657997362944 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:39:40.320287 140657997362944 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:39:40.320481 140658876786112 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:39:40.320605 140658876786112 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:39:40.320673 140658876786112 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:39:40.320868 140657988970240 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:39:40.320960 140657988970240 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:39:40.321101 140658876786112 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:39:40.321196 140658876786112 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.3054154.
I0305 08:39:40.446319 140658876786112 estimator.py:359] Loss for final step: 2.3054154.
INFO:tensorflow:training_loop marked as finished
I0305 08:39:40.446990 140658876786112 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:39:40.720798 140658876786112 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:39:41.230247 140658876786112 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:39:41.618701 140658876786112 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:39:41Z
I0305 08:39:41.637000 140658876786112 evaluation.py:257] Starting evaluation at 2019-03-05T08:39:41Z
INFO:tensorflow:TPU job name worker
I0305 08:39:41.637305 140658876786112 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:39:41.733177 140658876786112 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:39:41.733999 140658876786112 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:39:41.810887 140658876786112 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:39:42.392323 140658876786112 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:39:42.415908 140658876786112 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:39:42.460134 140658876786112 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 19 seconds
I0305 08:40:01.881844 140658876786112 tpu_estimator.py:510] Initialized TPU in 19 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:40:01.882905 140657987421952 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:40:01.883454 140657979029248 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:40:01.934767 140658876786112 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:40:01.962317 140658876786112 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:40:01.962769 140658876786112 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:40:02.958698 140658876786112 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:40:02.959068 140658876786112 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:40:02.959158 140658876786112 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:40:02.959394 140657987421952 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:40:02.959534 140657987421952 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:40:02.959702 140658876786112 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:40:02.959821 140658876786112 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:40:02.959887 140658876786112 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:40:02.968040 140657979029248 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:40:02.968355 140657979029248 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:40:02.968595 140658876786112 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:40:02.968780 140658876786112 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:40:03
I0305 08:40:03.061285 140658876786112 evaluation.py:277] Finished evaluation at 2019-03-05-08:40:03
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.098, global_step = 35, loss = 2.304987
I0305 08:40:03.061670 140658876786112 estimator.py:1979] Saving dict for global step 35: accuracy = 0.098, global_step = 35, loss = 2.304987
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:40:04.380877 140658876786112 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:40:04.655821 140658876786112 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.304987, 'global_step': 35, 'accuracy': 0.098}

warmup 10, LR 0.36
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775144969844...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775146057170...
Removing gs://bert-pretrain-data/mnist_log/#1551775178003680...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775179367134...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775178577929...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775140.infer#1551775180249381...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775178821337...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775179993112...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775142550711...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775144762936...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775203563617...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775203.infer#1551775204574569...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:40:07.681792 140489561863616 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:40:07.838732 140489561863616 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fc629b3f150>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fc62c4aa810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:40:08.132055 140489561863616 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fc629b3f150>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fc62c4aa810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:40:08.132579 140489561863616 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:40:08.243977 140489561863616 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:40:08.246825: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:40:08.260611 140489561863616 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:40:08.260946 140489561863616 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:40:08.261286 140489561863616 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:40:08.261368 140489561863616 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:40:08.261432 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:40:08.261632 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:40:08.261699 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:40:08.261924 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:40:08.261992 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:40:08.262053 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:40:08.262114 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:40:08.262172 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:40:08.262234 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:40:08.262300 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:40:08.262368 140489561863616 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:40:08.266530 140489561863616 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:40:08.278678 140489561863616 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:40:08.887238 140489561863616 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:40:08.952430 140489561863616 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:40:09.131999 140489561863616 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:40:09.213789 140489561863616 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:40:09.255568 140489561863616 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:40:09.456515 140489561863616 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:40:09.473685 140489561863616 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:40:10.622648 140489561863616 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:40:10.724332 140489561863616 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:40:11.045538 140489561863616 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:40:11.074990 140489561863616 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:40:11.958889 140489561863616 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:40:15.534454 140489561863616 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:40:15.535207 140489561863616 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:40:15.535615: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:40:15.541517 140489561863616 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:40:15.558161 140489561863616 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:40:15.570122 140489561863616 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 18 seconds
I0305 08:40:33.616156 140489561863616 tpu_estimator.py:510] Initialized TPU in 18 seconds
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:40:33.617491 140488682223360 tpu_estimator.py:463] Starting infeed thread controller.
I0305 08:40:33.617872 140488673830656 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:40:33.655224 140489561863616 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:40:33.655996 140489561863616 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.2892947, step = 35
I0305 08:40:45.797928 140489561863616 basic_session_run_hooks.py:249] loss = 2.2892947, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:40:45.800059 140489561863616 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:40:49.829893 140489561863616 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:40:49.830224 140489561863616 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:40:49.830495 140488682223360 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:40:49.830651 140488682223360 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:40:49.830977 140489561863616 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:40:49.831208 140489561863616 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:40:49.831300 140489561863616 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:40:49.831511 140488673830656 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:40:49.831628 140488673830656 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:40:49.831876 140489561863616 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:40:49.832010 140489561863616 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.2892947.
I0305 08:40:49.966078 140489561863616 estimator.py:359] Loss for final step: 2.2892947.
INFO:tensorflow:training_loop marked as finished
I0305 08:40:49.966752 140489561863616 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:40:50.250519 140489561863616 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:40:50.783557 140489561863616 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:40:51.153642 140489561863616 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:40:51Z
I0305 08:40:51.169574 140489561863616 evaluation.py:257] Starting evaluation at 2019-03-05T08:40:51Z
INFO:tensorflow:TPU job name worker
I0305 08:40:51.169883 140489561863616 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:40:51.254868 140489561863616 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:40:51.255693 140489561863616 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:40:51.319747 140489561863616 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:40:51.990223 140489561863616 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:40:52.014139 140489561863616 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:40:52.066565 140489561863616 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 18 seconds
I0305 08:41:10.321868 140489561863616 tpu_estimator.py:510] Initialized TPU in 18 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:41:10.322967 140488664151808 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:41:10.323848 140488313140992 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:41:10.373193 140489561863616 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:41:10.396217 140489561863616 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:41:10.396658 140489561863616 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:41:11.438724 140489561863616 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:41:11.439198 140489561863616 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:41:11.439295 140489561863616 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:41:11.439647 140488664151808 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:41:11.439974 140488664151808 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:41:11.440217 140489561863616 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:41:11.440499 140489561863616 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:41:11.440582 140489561863616 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:41:11.440771 140488313140992 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:41:11.440954 140488313140992 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:41:11.441205 140489561863616 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:41:11.441426 140489561863616 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:41:11
I0305 08:41:11.535177 140489561863616 evaluation.py:277] Finished evaluation at 2019-03-05-08:41:11
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.2052, global_step = 35, loss = 2.2834315
I0305 08:41:11.535700 140489561863616 estimator.py:1979] Saving dict for global step 35: accuracy = 0.2052, global_step = 35, loss = 2.2834315
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:41:12.727369 140489561863616 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:41:12.961865 140489561863616 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.2834315, 'global_step': 35, 'accuracy': 0.2052}

warmup 10, LR 0.40
Removing gs://bert-pretrain-data/mnist_log/#1551775247295247...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775248794727...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775210.infer#1551775249759176...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775211775829...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775213983374...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775215313324...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775214190375...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775248164202...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775247890842...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775249497618...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775271963801...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775272.infer#1551775272893560...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:41:16.063417 140408514037184 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:41:16.217086 140408514037184 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fb34ae04250>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fb34d76f810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:41:16.417881 140408514037184 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fb34ae04250>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fb34d76f810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:41:16.418381 140408514037184 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:41:16.529905 140408514037184 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:41:16.532584: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:41:16.546119 140408514037184 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:41:16.546498 140408514037184 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:41:16.546850 140408514037184 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:41:16.546926 140408514037184 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:41:16.546999 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:41:16.547256 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:41:16.547334 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:41:16.547420 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:41:16.547487 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:41:16.547554 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:41:16.547621 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:41:16.547689 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:41:16.547759 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:41:16.547823 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:41:16.547888 140408514037184 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:41:16.552495 140408514037184 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:41:16.564836 140408514037184 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:41:17.144834 140408514037184 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:41:17.209894 140408514037184 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:41:17.390430 140408514037184 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:41:17.471559 140408514037184 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:41:17.513114 140408514037184 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:41:17.714760 140408514037184 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:41:17.732131 140408514037184 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:41:18.842447 140408514037184 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:41:18.944149 140408514037184 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:41:19.277383 140408514037184 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:41:19.313704 140408514037184 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:41:20.176649 140408514037184 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:41:23.623388 140408514037184 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:41:23.624169 140408514037184 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:41:23.624586: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:41:23.630429 140408514037184 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:41:23.648863 140408514037184 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:41:23.660676 140408514037184 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 17 seconds
I0305 08:41:41.449584 140408514037184 tpu_estimator.py:510] Initialized TPU in 17 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:41:41.450654 140407564392192 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:41:41.451116 140407555999488 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:41:41.488750 140408514037184 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:41:41.489475 140408514037184 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.2782223, step = 35
I0305 08:41:52.854414 140408514037184 basic_session_run_hooks.py:249] loss = 2.2782223, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:41:52.856556 140408514037184 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:41:56.417701 140408514037184 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:41:56.418046 140408514037184 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:41:56.418273 140407564392192 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:41:56.418421 140407564392192 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:41:56.418610 140408514037184 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:41:56.418747 140408514037184 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:41:56.418826 140408514037184 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:41:56.418970 140407555999488 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:41:56.419066 140407555999488 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:41:56.419203 140408514037184 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:41:56.419310 140408514037184 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.2782223.
I0305 08:41:56.550596 140408514037184 estimator.py:359] Loss for final step: 2.2782223.
INFO:tensorflow:training_loop marked as finished
I0305 08:41:56.551258 140408514037184 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:41:56.823895 140408514037184 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:41:57.351413 140408514037184 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:41:57.702100 140408514037184 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:41:57Z
I0305 08:41:57.718269 140408514037184 evaluation.py:257] Starting evaluation at 2019-03-05T08:41:57Z
INFO:tensorflow:TPU job name worker
I0305 08:41:57.718703 140408514037184 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:41:57.805735 140408514037184 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:41:57.806581 140408514037184 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:41:57.875129 140408514037184 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:41:58.545049 140408514037184 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:41:58.574039 140408514037184 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:41:58.628896 140408514037184 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 18 seconds
I0305 08:42:16.686145 140408514037184 tpu_estimator.py:510] Initialized TPU in 18 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:42:16.687184 140407556548352 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:42:16.687885 140407548155648 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:42:16.739264 140408514037184 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:42:16.763319 140408514037184 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:42:16.763752 140408514037184 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:42:17.764262 140408514037184 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:42:17.764652 140408514037184 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:42:17.764776 140408514037184 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:42:17.765005 140407556548352 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:42:17.765294 140407556548352 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:42:17.765518 140408514037184 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:42:17.765706 140408514037184 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:42:17.765830 140408514037184 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:42:17.770729 140407548155648 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:42:17.770979 140407548155648 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:42:17.771215 140408514037184 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:42:17.771497 140408514037184 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:42:17
I0305 08:42:17.864552 140408514037184 evaluation.py:277] Finished evaluation at 2019-03-05-08:42:17
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.2424, global_step = 35, loss = 2.2669885
I0305 08:42:17.864996 140408514037184 estimator.py:1979] Saving dict for global step 35: accuracy = 0.2424, global_step = 35, loss = 2.2669885
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:42:19.181387 140408514037184 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:42:19.413353 140408514037184 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.2669885, 'global_step': 35, 'accuracy': 0.2424}

warmup 10, LR 0.45
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775282305979...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775315402862...
Removing gs://bert-pretrain-data/mnist_log/#1551775314148367...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775283394894...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775314715129...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775314897047...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775278.infer#1551775316340636...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775316004010...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775279976256...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775282100853...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775338395583...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775338.infer#1551775339341954...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:42:22.450998 139734131455424 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:42:22.646545 139734131455424 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f16468ab0d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f1649216810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:42:22.791630 139734131455424 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f16468ab0d0>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f1649216810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:42:22.792120 139734131455424 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:42:22.904254 139734131455424 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:42:22.907114: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:42:22.920320 139734131455424 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:42:22.920608 139734131455424 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:42:22.921003 139734131455424 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:42:22.921081 139734131455424 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:42:22.921144 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:42:22.921379 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:42:22.921449 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:42:22.921514 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:42:22.921576 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:42:22.921634 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:42:22.921694 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:42:22.921756 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:42:22.921816 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:42:22.921874 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:42:22.921933 139734131455424 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:42:22.926125 139734131455424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:42:22.938486 139734131455424 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:42:23.528398 139734131455424 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:42:23.593333 139734131455424 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:42:23.770725 139734131455424 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:42:23.852540 139734131455424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:42:23.894097 139734131455424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:42:24.093866 139734131455424 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:42:24.111335 139734131455424 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:42:25.198371 139734131455424 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:42:25.299536 139734131455424 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:42:25.643445 139734131455424 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:42:25.676107 139734131455424 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:42:26.525557 139734131455424 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:42:29.942655 139734131455424 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:42:29.943437 139734131455424 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:42:29.943818: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:42:29.949022 139734131455424 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:42:29.970271 139734131455424 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:42:29.992177 139734131455424 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 18 seconds
I0305 08:42:48.223685 139734131455424 tpu_estimator.py:510] Initialized TPU in 18 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:42:48.224819 139733179025152 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:42:48.225415 139733170632448 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:42:48.262559 139734131455424 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:42:48.263386 139734131455424 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.3030324, step = 35
I0305 08:42:59.593039 139734131455424 basic_session_run_hooks.py:249] loss = 2.3030324, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:42:59.595072 139734131455424 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:43:03.326837 139734131455424 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:43:03.327148 139734131455424 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:43:03.327368 139733179025152 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:43:03.327501 139733179025152 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:43:03.327665 139734131455424 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:43:03.327796 139734131455424 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:43:03.327861 139734131455424 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:43:03.327994 139733170632448 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:43:03.328094 139733170632448 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:43:03.328229 139734131455424 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:43:03.328330 139734131455424 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.3030324.
I0305 08:43:03.459997 139734131455424 estimator.py:359] Loss for final step: 2.3030324.
INFO:tensorflow:training_loop marked as finished
I0305 08:43:03.460899 139734131455424 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:43:03.731446 139734131455424 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:43:04.225383 139734131455424 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:43:04.586031 139734131455424 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:43:04Z
I0305 08:43:04.601592 139734131455424 evaluation.py:257] Starting evaluation at 2019-03-05T08:43:04Z
INFO:tensorflow:TPU job name worker
I0305 08:43:04.601933 139734131455424 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:43:04.685606 139734131455424 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:43:04.686398 139734131455424 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:43:04.757699 139734131455424 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:43:05.341253 139734131455424 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:43:05.369817 139734131455424 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:43:05.424015 139734131455424 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 19 seconds
I0305 08:43:24.524863 139734131455424 tpu_estimator.py:510] Initialized TPU in 19 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:43:24.526074 139733171181312 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:43:24.527019 139733162788608 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:43:24.579042 139734131455424 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:43:24.599069 139734131455424 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:43:24.599476 139734131455424 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:43:25.646193 139734131455424 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:43:25.646631 139734131455424 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:43:25.646737 139734131455424 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:43:25.647025 139733171181312 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:43:25.647420 139733171181312 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:43:25.647663 139734131455424 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:43:25.648040 139734131455424 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:43:25.648150 139734131455424 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:43:25.657674 139733162788608 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:43:25.657953 139733162788608 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:43:25.658195 139734131455424 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:43:25.658513 139734131455424 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:43:25
I0305 08:43:25.743638 139734131455424 evaluation.py:277] Finished evaluation at 2019-03-05-08:43:25
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3004186
I0305 08:43:25.744051 139734131455424 estimator.py:1979] Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3004186
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:43:27.089951 139734131455424 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:43:27.312558 139734131455424 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.3004186, 'global_step': 35, 'accuracy': 0.1135}

warmup 10, LR 0.50
Removing gs://bert-pretrain-data/mnist_log/#1551775381017205...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775346344521...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775348679040...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775349725658...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775382305062...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775344.infer#1551775383260185...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775381583223...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775381781024...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775382978997...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775348486126...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775406317159...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775406.infer#1551775407238147...
/ [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:43:30.410137 140018821195200 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:43:30.571532 140018821195200 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f588f5f6090>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f5891f61810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:43:30.766180 140018821195200 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f588f5f6090>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f5891f61810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:43:30.766686 140018821195200 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:43:30.868537 140018821195200 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:43:30.871460: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:43:30.883446 140018821195200 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:43:30.883721 140018821195200 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:43:30.884083 140018821195200 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:43:30.884152 140018821195200 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:43:30.884222 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:43:30.884430 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:43:30.884500 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:43:30.884565 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:43:30.884624 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:43:30.884716 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:43:30.884797 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:43:30.884856 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:43:30.884928 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:43:30.884988 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:43:30.885049 140018821195200 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:43:30.889333 140018821195200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:43:30.901689 140018821195200 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:43:31.519006 140018821195200 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:43:31.584482 140018821195200 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:43:31.763729 140018821195200 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:43:31.845201 140018821195200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:43:31.886564 140018821195200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:43:32.088258 140018821195200 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:43:32.112051 140018821195200 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:43:33.164815 140018821195200 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:43:33.267316 140018821195200 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:43:33.602472 140018821195200 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:43:33.631102 140018821195200 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:43:34.519834 140018821195200 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:43:38.315957 140018821195200 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:43:38.318627 140018821195200 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:43:38.319224: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:43:38.325485 140018821195200 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:43:38.343487 140018821195200 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:43:38.355609 140018821195200 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 18 seconds
I0305 08:43:56.845571 140018821195200 tpu_estimator.py:510] Initialized TPU in 18 seconds
INFO:tensorflow:Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:43:56.846681 140017737393920 tpu_estimator.py:463] Starting infeed thread controller.
I0305 08:43:56.847055 140017729001216 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:43:56.885134 140018821195200 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:43:56.885880 140018821195200 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.3023143, step = 35
I0305 08:44:07.601056 140018821195200 basic_session_run_hooks.py:249] loss = 2.3023143, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:44:07.603396 140018821195200 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:44:11.214296 140018821195200 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:44:11.214653 140018821195200 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:44:11.214871 140017737393920 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:44:11.215017 140017737393920 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:44:11.215209 140018821195200 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:44:11.215358 140018821195200 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:44:11.215440 140018821195200 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:44:11.215578 140017729001216 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:44:11.215677 140017729001216 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:44:11.215831 140018821195200 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:44:11.215936 140018821195200 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.3023143.
I0305 08:44:11.349838 140018821195200 estimator.py:359] Loss for final step: 2.3023143.
INFO:tensorflow:training_loop marked as finished
I0305 08:44:11.350502 140018821195200 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:44:11.639128 140018821195200 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:44:12.140064 140018821195200 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:44:12.510602 140018821195200 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:44:12Z
I0305 08:44:12.526285 140018821195200 evaluation.py:257] Starting evaluation at 2019-03-05T08:44:12Z
INFO:tensorflow:TPU job name worker
I0305 08:44:12.526607 140018821195200 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:44:12.610881 140018821195200 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:44:12.611674 140018821195200 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:44:12.676928 140018821195200 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:44:13.279206 140018821195200 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:44:13.302620 140018821195200 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:44:13.349802 140018821195200 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 18 seconds
I0305 08:44:31.903408 140018821195200 tpu_estimator.py:510] Initialized TPU in 18 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:44:31.904499 140017729550080 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:44:31.905790 140017721157376 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:44:31.956511 140018821195200 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:44:31.981803 140018821195200 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:44:31.982238 140018821195200 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:44:33.008737 140018821195200 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:44:33.009216 140018821195200 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:44:33.009336 140018821195200 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:44:33.009655 140017729550080 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:44:33.009964 140017729550080 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:44:33.010212 140018821195200 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:44:33.010472 140018821195200 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:44:33.010551 140018821195200 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:44:33.010742 140017721157376 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:44:33.010915 140017721157376 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:44:33.011085 140018821195200 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:44:33.011261 140018821195200 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:44:33
I0305 08:44:33.101243 140018821195200 evaluation.py:277] Finished evaluation at 2019-03-05-08:44:33
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3015387
I0305 08:44:33.101654 140018821195200 estimator.py:1979] Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3015387
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:44:34.365770 140018821195200 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:44:34.594816 140018821195200 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.3015387, 'global_step': 35, 'accuracy': 0.1135}

warmup 10, LR 0.55
Removing gs://bert-pretrain-data/mnist_log/#1551775448959547...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775412.infer#1551775451133257...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775450277496...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775414335684...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775416682636...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775416929313...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775449503644...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775418053200...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775449717351...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775450870212...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775473555071...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775473.infer#1551775474522535...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:44:37.706386 140472315110848 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:44:37.868499 140472315110848 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fc225b76290>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fc2284e1810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:44:38.005192 140472315110848 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fc225b76290>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7fc2284e1810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:44:38.005749 140472315110848 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:44:38.121490 140472315110848 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:44:38.124524: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:44:38.134964 140472315110848 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:44:38.135364 140472315110848 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:44:38.135741 140472315110848 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:44:38.135818 140472315110848 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:44:38.135890 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:44:38.136100 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:44:38.136177 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:44:38.136260 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:44:38.136328 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:44:38.136405 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:44:38.136487 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:44:38.136555 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:44:38.136622 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:44:38.136738 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:44:38.136831 140472315110848 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:44:38.141426 140472315110848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:44:38.154206 140472315110848 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:44:38.762398 140472315110848 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:44:38.828238 140472315110848 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:44:39.007190 140472315110848 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:44:39.090888 140472315110848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:44:39.133565 140472315110848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:44:39.337809 140472315110848 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:44:39.355315 140472315110848 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:44:40.479706 140472315110848 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:44:40.579492 140472315110848 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:44:40.913532 140472315110848 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:44:40.952678 140472315110848 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:44:41.916896 140472315110848 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:44:45.372450 140472315110848 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:44:45.373225 140472315110848 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:44:45.373602: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:44:45.378727 140472315110848 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:44:45.394267 140472315110848 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:44:45.405651 140472315110848 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 33 seconds
I0305 08:45:18.945898 140472315110848 tpu_estimator.py:510] Initialized TPU in 33 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:45:18.946947 140471435245312 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:45:18.947525 140471426852608 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Enqueue next (35) batch(es) of data to infeed.
I0305 08:45:18.995007 140472315110848 tpu_estimator.py:536] Enqueue next (35) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (35) batch(es) of data from outfeed.
I0305 08:45:18.995729 140472315110848 tpu_estimator.py:540] Dequeue next (35) batch(es) of data from outfeed.
INFO:tensorflow:loss = 2.304925, step = 35
I0305 08:45:30.642599 140472315110848 basic_session_run_hooks.py:249] loss = 2.304925, step = 35
INFO:tensorflow:Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:45:30.644555 140472315110848 basic_session_run_hooks.py:594] Saving checkpoints for 35 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Stop infeed thread controller
I0305 08:45:34.374763 140472315110848 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:45:34.375083 140472315110848 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:45:34.375319 140471435245312 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:45:34.375484 140471435245312 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:45:34.375722 140472315110848 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:45:34.375853 140472315110848 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:45:34.375916 140472315110848 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:45:34.376054 140471426852608 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:45:34.376141 140471426852608 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:45:34.376279 140472315110848 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:45:34.376384 140472315110848 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Loss for final step: 2.304925.
I0305 08:45:34.512234 140472315110848 estimator.py:359] Loss for final step: 2.304925.
INFO:tensorflow:training_loop marked as finished
I0305 08:45:34.513026 140472315110848 error_handling.py:93] training_loop marked as finished
INFO:tensorflow:Calling model_fn.
I0305 08:45:34.799153 140472315110848 estimator.py:1111] Calling model_fn.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:45:35.325139 140472315110848 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
INFO:tensorflow:Done calling model_fn.
I0305 08:45:35.678395 140472315110848 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2019-03-05T08:45:35Z
I0305 08:45:35.697038 140472315110848 evaluation.py:257] Starting evaluation at 2019-03-05T08:45:35Z
INFO:tensorflow:TPU job name worker
I0305 08:45:35.697376 140472315110848 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:45:35.783288 140472315110848 monitored_session.py:222] Graph was finalized.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
W0305 08:45:35.784111 140472315110848 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:45:35.852384 140472315110848 saver.py:1270] Restoring parameters from gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:Running local_init_op.
I0305 08:45:36.519710 140472315110848 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:45:36.543921 140472315110848 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Init TPU system
I0305 08:45:36.589272 140472315110848 tpu_estimator.py:504] Init TPU system
INFO:tensorflow:Initialized TPU in 86 seconds
I0305 08:47:02.913877 140472315110848 tpu_estimator.py:510] Initialized TPU in 86 seconds
INFO:tensorflow:Starting infeed thread controller.
I0305 08:47:02.915199 140471425828608 tpu_estimator.py:463] Starting infeed thread controller.
INFO:tensorflow:Starting outfeed thread controller.
I0305 08:47:02.915793 140471417435904 tpu_estimator.py:482] Starting outfeed thread controller.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:47:02.971837 140472315110848 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Enqueue next (10) batch(es) of data to infeed.
I0305 08:47:02.992181 140472315110848 tpu_estimator.py:536] Enqueue next (10) batch(es) of data to infeed.
INFO:tensorflow:Dequeue next (10) batch(es) of data from outfeed.
I0305 08:47:02.992794 140472315110848 tpu_estimator.py:540] Dequeue next (10) batch(es) of data from outfeed.
INFO:tensorflow:Evaluation [10/10]
I0305 08:47:04.010869 140472315110848 evaluation.py:169] Evaluation [10/10]
INFO:tensorflow:Stop infeed thread controller
I0305 08:47:04.011328 140472315110848 tpu_estimator.py:545] Stop infeed thread controller
INFO:tensorflow:Shutting down InfeedController thread.
I0305 08:47:04.011445 140472315110848 tpu_estimator.py:392] Shutting down InfeedController thread.
INFO:tensorflow:InfeedController received shutdown signal, stopping.
I0305 08:47:04.012367 140471425828608 tpu_estimator.py:387] InfeedController received shutdown signal, stopping.
INFO:tensorflow:Infeed thread finished, shutting down.
I0305 08:47:04.012656 140471425828608 tpu_estimator.py:479] Infeed thread finished, shutting down.
INFO:tensorflow:infeed marked as finished
I0305 08:47:04.012964 140472315110848 error_handling.py:93] infeed marked as finished
INFO:tensorflow:Stop output thread controller
I0305 08:47:04.013353 140472315110848 tpu_estimator.py:549] Stop output thread controller
INFO:tensorflow:Shutting down OutfeedController thread.
I0305 08:47:04.013845 140472315110848 tpu_estimator.py:392] Shutting down OutfeedController thread.
INFO:tensorflow:OutfeedController received shutdown signal, stopping.
I0305 08:47:04.016458 140471417435904 tpu_estimator.py:387] OutfeedController received shutdown signal, stopping.
INFO:tensorflow:Outfeed thread finished, shutting down.
I0305 08:47:04.016872 140471417435904 tpu_estimator.py:488] Outfeed thread finished, shutting down.
INFO:tensorflow:outfeed marked as finished
I0305 08:47:04.017117 140472315110848 error_handling.py:93] outfeed marked as finished
INFO:tensorflow:Shutdown TPU system.
I0305 08:47:04.017347 140472315110848 tpu_estimator.py:553] Shutdown TPU system.
INFO:tensorflow:Finished evaluation at 2019-03-05-08:47:04
I0305 08:47:04.100869 140472315110848 evaluation.py:277] Finished evaluation at 2019-03-05-08:47:04
INFO:tensorflow:Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3007655
I0305 08:47:04.101310 140472315110848 estimator.py:1979] Saving dict for global step 35: accuracy = 0.1135, global_step = 35, loss = 2.3007655
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
I0305 08:47:05.417278 140472315110848 estimator.py:2039] Saving 'checkpoint_path' summary for global step 35: gs://bert-pretrain-data/mnist_log/model.ckpt-35
INFO:tensorflow:evaluation_loop marked as finished
I0305 08:47:05.704632 140472315110848 error_handling.py:93] evaluation_loop marked as finished

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

++++++++++++++++++++++++ I'm using Momentum Optimizer ++++++++++++++++++++++++

Evaluation results:
	{'loss': 2.3007655, 'global_step': 35, 'accuracy': 0.1135}

warmup 10, LR 0.60
Removing gs://bert-pretrain-data/mnist_log/#1551775532049436...
Removing gs://bert-pretrain-data/mnist_log/checkpoint#1551775533410146...
Removing gs://bert-pretrain-data/mnist_log/events.out.tfevents.1551775479.infer#1551775534299010...
Removing gs://bert-pretrain-data/mnist_log/graph.pbtxt#1551775481734480...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.data-00000-of-00001#1551775483875485...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.index#1551775484093120...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-0.meta#1551775485144812...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.data-00000-of-00001#1551775532634126...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.index#1551775532865432...
Removing gs://bert-pretrain-data/mnist_log/model.ckpt-35.meta#1551775534046196...
Removing gs://bert-pretrain-data/mnist_log/eval/events.out.tfevents.1551775624.infer#1551775625621363...
Removing gs://bert-pretrain-data/mnist_log/eval/#1551775624654080...
/ [1/12 objects]   8% Done                                                      / [2/12 objects]  16% Done                                                      / [3/12 objects]  25% Done                                                      / [4/12 objects]  33% Done                                                      / [5/12 objects]  41% Done                                                      / [6/12 objects]  50% Done                                                      / [7/12 objects]  58% Done                                                      / [8/12 objects]  66% Done                                                      / [9/12 objects]  75% Done                                                      / [10/12 objects]  83% Done                                                     / [11/12 objects]  91% Done                                                     / [12/12 objects] 100% Done                                                     
Operation completed over 12 objects.                                             
W0305 08:47:08.797355 140164364236224 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
W0305 08:47:08.941978 140164364236224 __init__.py:44] file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/__init__.py", line 41, in autodetect
    from . import file_cache
  File "/usr/local/lib/python2.7/dist-packages/googleapiclient/discovery_cache/file_cache.py", line 41, in <module>
    'file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth')
ImportError: file_cache is unavailable when using oauth2client >= 4.0.0 or google-auth
INFO:tensorflow:Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7a7269f190>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7a7500a810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
I0305 08:47:09.147377 140164364236224 estimator.py:201] Using config: {'_save_checkpoints_secs': 600, '_session_config': allow_soft_placement: true
log_device_placement: true
cluster_def {
  job {
    name: "worker"
    tasks {
      value: "10.240.1.58:8470"
    }
  }
}
, '_keep_checkpoint_max': 5, '_task_type': 'worker', '_train_distribute': None, '_is_chief': True, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7f7a7269f190>, '_model_dir': 'gs://bert-pretrain-data/mnist_log/', '_protocol': None, '_save_checkpoints_steps': None, '_keep_checkpoint_every_n_hours': 10000, '_service': None, '_num_ps_replicas': 0, '_tpu_config': TPUConfig(iterations_per_loop=500, num_shards=8, num_cores_per_replica=None, per_host_input_for_training=2, tpu_job_name=None, initial_infeed_sleep_secs=None, input_partition_dims=None), '_tf_random_seed': None, '_save_summary_steps': 100, '_device_fn': None, '_cluster': <tensorflow.python.distribute.cluster_resolver.tpu_cluster_resolver.TPUClusterResolver object at 0x7f7a7500a810>, '_experimental_distribute': None, '_num_worker_replicas': 1, '_task_id': 0, '_log_step_count_steps': None, '_evaluation_master': u'grpc://10.240.1.58:8470', '_eval_distribute': None, '_global_id_in_cluster': 0, '_master': u'grpc://10.240.1.58:8470'}
INFO:tensorflow:_TPUContext: eval_on_tpu True
I0305 08:47:09.147914 140164364236224 tpu_context.py:202] _TPUContext: eval_on_tpu True
INFO:tensorflow:Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
I0305 08:47:09.266695 140164364236224 tpu_system_metadata.py:59] Querying Tensorflow master (grpc://10.240.1.58:8470) for TPU system metadata.
2019-03-05 08:47:09.269688: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Found TPU system:
I0305 08:47:09.282253 140164364236224 tpu_system_metadata.py:120] Found TPU system:
INFO:tensorflow:*** Num TPU Cores: 8
I0305 08:47:09.282567 140164364236224 tpu_system_metadata.py:121] *** Num TPU Cores: 8
INFO:tensorflow:*** Num TPU Workers: 1
I0305 08:47:09.282932 140164364236224 tpu_system_metadata.py:122] *** Num TPU Workers: 1
INFO:tensorflow:*** Num TPU Cores Per Worker: 8
I0305 08:47:09.283006 140164364236224 tpu_system_metadata.py:124] *** Num TPU Cores Per Worker: 8
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
I0305 08:47:09.283085 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:CPU:0, CPU, -1, 14987452172164420259)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
I0305 08:47:09.283358 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:XLA_CPU:0, XLA_CPU, 17179869184, 2965738866164998202)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
I0305 08:47:09.283443 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:0, TPU, 17179869184, 11105661514778409806)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
I0305 08:47:09.283530 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:1, TPU, 17179869184, 3298783253614790123)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
I0305 08:47:09.283600 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:2, TPU, 17179869184, 8415325357262250690)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
I0305 08:47:09.283667 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:3, TPU, 17179869184, 5251342378621148509)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
I0305 08:47:09.283741 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:4, TPU, 17179869184, 6558895738457661912)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
I0305 08:47:09.283807 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:5, TPU, 17179869184, 15550927621918903417)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
I0305 08:47:09.283873 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:6, TPU, 17179869184, 6190107545111228745)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
I0305 08:47:09.283936 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU:7, TPU, 17179869184, 10834028886904811257)
INFO:tensorflow:*** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
I0305 08:47:09.284003 140164364236224 tpu_system_metadata.py:126] *** Available Device: _DeviceAttributes(/job:worker/replica:0/task:0/device:TPU_SYSTEM:0, TPU_SYSTEM, 17179869184, 721448465348231439)
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
W0305 08:47:09.288559 140164364236224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/resource_variable_ops.py:435: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
INFO:tensorflow:Calling model_fn.
I0305 08:47:09.302203 140164364236224 estimator.py:1111] Calling model_fn.
WARNING:tensorflow:From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:47:09.941257 140164364236224 deprecation.py:323] From /usr/share/models/official/mnist/dataset.py:100: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
ERROR:tensorflow:Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
E0305 08:47:10.006830 140164364236224 tpu.py:330] Operation of type Placeholder (reshape_input) is not supported on the TPU. Execution will fail if this op is used in the graph. 
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
W0305 08:47:10.191739 140164364236224 deprecation.py:506] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/keras/layers/core.py:143: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
W0305 08:47:10.281162 140164364236224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/losses/losses_impl.py:209: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
W0305 08:47:10.323191 140164364236224 deprecation.py:323] From /usr/local/lib/python2.7/dist-packages/tensorflow/python/training/learning_rate_decay_v2.py:321: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
INFO:tensorflow:Create CheckpointSaverHook.
I0305 08:47:10.526104 140164364236224 basic_session_run_hooks.py:527] Create CheckpointSaverHook.
INFO:tensorflow:Done calling model_fn.
I0305 08:47:10.543400 140164364236224 estimator.py:1113] Done calling model_fn.
INFO:tensorflow:TPU job name worker
I0305 08:47:11.656903 140164364236224 tpu_estimator.py:447] TPU job name worker
INFO:tensorflow:Graph was finalized.
I0305 08:47:11.758326 140164364236224 monitored_session.py:222] Graph was finalized.
INFO:tensorflow:Running local_init_op.
I0305 08:47:12.082832 140164364236224 session_manager.py:491] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0305 08:47:12.110110 140164364236224 session_manager.py:493] Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
I0305 08:47:13.033092 140164364236224 basic_session_run_hooks.py:594] Saving checkpoints for 0 into gs://bert-pretrain-data/mnist_log/model.ckpt.
INFO:tensorflow:Initialized dataset iterators in 0 seconds
I0305 08:47:16.682095 140164364236224 util.py:51] Initialized dataset iterators in 0 seconds
INFO:tensorflow:Installing graceful shutdown hook.
I0305 08:47:16.682940 140164364236224 session_support.py:345] Installing graceful shutdown hook.
2019-03-05 08:47:16.683369: W tensorflow/core/distributed_runtime/rpc/grpc_session.cc:354] GrpcSession::ListDevices will initialize the session with an empty graph and other defaults because the session has not yet been created.
INFO:tensorflow:Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
I0305 08:47:16.688393 140164364236224 session_support.py:102] Creating heartbeat manager for ['/job:worker/replica:0/task:0/device:CPU:0']
INFO:tensorflow:Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

I0305 08:47:16.704566 140164364236224 session_support.py:130] Configuring worker heartbeat: shutdown_mode: WAIT_FOR_COORDINATOR

INFO:tensorflow:Init TPU system
I0305 08:47:16.716569 140164364236224 tpu_estimator.py:504] Init TPU system
